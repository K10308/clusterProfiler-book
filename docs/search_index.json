[
["index.html", "clusterProfiler: universal enrichment tool for functional and comparative study Preface", " clusterProfiler: universal enrichment tool for functional and comparative study Guangchuang Yu Preface hello "],
["chapter1.html", "Chapter 1 Introduction 1.1 Terminology", " Chapter 1 Introduction 1.1 Terminology 1.1.1 Gene sets and pathway Gene sets are simple lists of usually functional related genes without further specification of relationships between genes. Pathways can be interpreted as specific gene sets, typically representing a group of genes that work together in a biological process. 1.1.2 Gene Ontology (GO) Gene Ontology defines concepts/classes used to describe gene function, and relationships between these concepts. It classifies functions along three aspects: MF: Molecular Function molecular activities of gene products CC: Cellular Component where gene products are active BP: Biological Process pathways and larger processes made up of the activities of multiple gene products GO terms are organized in a directed acyclic graph, where edge between the terms represent parent-child relationship. 1.1.3 Kyoto Encyclopedia of Genes and Genomes (KEGG) KEGG is a collection of manually drawn pathway maps representing molecular interaction and reaction networks. These pathways cover a wide range of biochemical processes that can be divided in 7 broad categories: metabolism, genetic and environmental information processing, cellular processes, organismal systems, human diseases, and drug development. 1.1.4 Other gene sets GO and KEGG are most frequently used for the functional analysis. They are typically the first choice because their long-standing curation and availability for a wide range of species. Other gene sets including but not limited to Disease Ontology (DO), Disease Gene Network (DisGeNET), wikiPathways, Molecular Signatures Database (MSigDb). "],
["chapter2.html", "Chapter 2 Functional Enrichment Analysis Methods 2.1 Over Representation Analysis 2.2 Gene Set Enrichment Analysis 2.3 Leading edge analysis and core enriched genes", " Chapter 2 Functional Enrichment Analysis Methods 2.1 Over Representation Analysis Over Representation Analysis (ORA) (Boyle et al. 2004) is a widely used approach to determine whether known biological functions or processes are over-represented (= enriched) in an experimentally-derived gene list, e.g. a list of differentially expressed genes (DEGs). The p-value can be calculated by hypergeometric distribution. \\(p = 1 - \\displaystyle\\sum_{i = 0}^{k-1}\\frac{{M \\choose i}{{N-M} \\choose {n-i}}} {{N \\choose n}}\\) In this equation, N is the total number of genes in the background distribution, M is the number of genes within that distribution that are annotated (either directly or indirectly) to the gene set of interest, n is the size of the list of genes of interest and k is the number of genes within that list which are annotated to the gene set. The background distribution by default is all the genes that have annotation. P-values should be adjusted for multiple comparison. Example: Microarray study, in which 11,812 genes have been tested for differential expression between two sample conditions and 202 genes were found DE. Among the DE genes, 25 are annotated to a specific functional gene set, which contains in total 262 genes. This setup corresponds to a 2x2 contingency table: d &lt;- matrix(c(25, 237, 177, 11323), nrow = 2, dimnames = list(c(&quot;DE&quot;, &quot;Not DE&quot;), c(&quot;In GS&quot;, &quot;Not in GS&quot;))) d ## In GS Not in GS ## DE 25 177 ## Not DE 237 11323 whether the overlap of 25 genes are significantly over represented in the gene set can be assessed using hypergeometric distribution. This corresponding to a one-sided version of Fisher’s exact test. fisher.test(d, alternative = &quot;greater&quot;) ## ## Fisher&#39;s Exact Test for Count Data ## ## data: d ## p-value = 2.815e-12 ## alternative hypothesis: true odds ratio is greater than 1 ## 95 percent confidence interval: ## 4.502824 Inf ## sample estimates: ## odds ratio ## 6.744738 2.2 Gene Set Enrichment Analysis A common approach in analyzing gene expression profiles was identifying differential expressed genes that are deemed interesting. The enrichment analysis we demonstrated in Disease enrichment analysis vignette were based on these differential expressed genes. This approach will find genes where the difference is large, but it will not detect a situation where the difference is small, but evidenced in coordinated way in a set of related genes. Gene Set Enrichment Analysis (GSEA)(Subramanian et al. 2005) directly addresses this limitation. All genes can be used in GSEA; GSEA aggregates the per gene statistics across genes within a gene set, therefore making it possible to detect situations where all genes in a predefined set change in a small but coordinated way. Since it is likely that many relevant phenotypic differences are manifested by small but consistent changes in a set of genes. Genes are ranked based on their phenotypes. Given a priori defined set of gene S (e.g., genes shareing the same DO category), the goal of GSEA is to determine whether the members of S are randomly distributed throughout the ranked gene list (L) or primarily found at the top or bottom. There are three key elements of the GSEA method: Calculation of an Enrichment Score. The enrichment score (ES) represent the degree to which a set S is over-represented at the top or bottom of the ranked list L. The score is calculated by walking down the list L, increasing a running-sum statistic when we encounter a gene in S and decreasing when it is not. The magnitude of the increment depends on the gene statistics (e.g., correlation of the gene with phenotype). The ES is the maximum deviation from zero encountered in the random walk; it corresponds to a weighted Kolmogorov-Smirnov-like statistic(Subramanian et al. 2005). Esimation of Significance Level of ES. The p-value of the ES is calculated using permutation test. Specifically, we permute the gene labels of the gene list L and recompute the ES of the gene set for the permutated data, which generate a null distribution for the ES. The p-value of the observed ES is then calculated relative to this null distribution. Adjustment for Multiple Hypothesis Testing. When the entire gene sets were evaluated, DOSE adjust the estimated significance level to account for multiple hypothesis testing and also q-values were calculated for FDR control. We implemented GSEA algorithm proposed by Subramanian(Subramanian et al. 2005). Alexey Sergushichev implemented an algorithm for fast GSEA analysis in the fgsea(A. S.) package. In DOSE(Yu et al. 2015), user can use GSEA algorithm implemented in DOSE or fgsea by specifying the parameter by=&quot;DOSE&quot; or by=&quot;fgsea&quot;. By default, DOSE use fgsea since it is much more fast. 2.3 Leading edge analysis and core enriched genes Leading edge analysis reports Tags to indicate the percentage of genes contributing to the enrichment score, List to indicate where in the list the enrichment score is attained and Signal for enrichment signal strength. It would also be very interesting to get the core enriched genes that contribute to the enrichment. DOSE supports leading edge analysis and report core enriched genes in GSEA analysis. References "],
["chapter3.html", "Chapter 3 Universal enrichment analysis 3.1 Input data 3.2 WikiPathways analysis 3.3 Cell Marker 3.4 MSigDb analysis", " Chapter 3 Universal enrichment analysis clusterProfiler supports both hypergeometric test and gene set enrichment analyses of many ontology/pathway, but it’s still not enough for users may want to analyze their data with unsupported organisms, slim version of GO, novel functional annotation (e.g. GO via BlastGO or KEGG via KAAS), unsupported ontologies/pathways or customized annotations. clusterProfiler provides enricher function for hypergeometric test and GSEA function for gene set enrichment analysis that are designed to accept user defined annotation. They accept two additional parameters TERM2GENE and TERM2NAME. As indicated in the parameter names, TERM2GENE is a data.frame with first column of term ID and second column of corresponding mapped gene and TERM2NAME is a data.frame with first column of term ID and second column of corresponding term name. TERM2NAME is optional. 3.1 Input data For over representation analysis, all we need is a gene vector, that is a vector of gene IDs. These gene IDs can be obtained by differential expression analysis (e.g. with DESeq2 package). For gene set enrichment analysis, we need a ranked list of genes. DOSE provides an example dataset geneList which was derived from R package breastCancerMAINZ that contained 200 samples, including 29 samples in grade I, 136 samples in grade II and 35 samples in grade III. We computed the ratios of geometric means of grade III samples versus geometric means of grade I samples. Logarithm of these ratios (base 2) were stored in geneList dataset. The geneList contains three features: numeric vector: fold change or other type of numerical variable named vector: every number was named by the corresponding gene ID sorted vector: number should be sorted in decreasing order Suppose you are importing your own data from a csv file and the file contains two columns, one for gene ID (no duplicated allowed) and another one for fold change, you can prepare your own geneList via the following command: d &lt;- read.csv(your_csv_file) ## assume that 1st column is ID ## 2nd column is fold change ## feature 1: numeric vector geneList &lt;- d[,2] ## feature 2: named vector names(geneList) &lt;- as.character(d[,1]) ## feature 3: decreasing order geneList &lt;- sort(geneList, decreasing = TRUE) We can load the sample data into R via: data(geneList, package=&quot;DOSE&quot;) head(geneList) ## 4312 8318 10874 55143 55388 991 ## 4.572613 4.514594 4.418218 4.144075 3.876258 3.677857 Suppose we define fold change greater than 2 as DEGs: gene &lt;- names(geneList)[abs(geneList) &gt; 2] head(gene) ## [1] &quot;4312&quot; &quot;8318&quot; &quot;10874&quot; &quot;55143&quot; &quot;55388&quot; &quot;991&quot; 3.2 WikiPathways analysis WikiPathways is a continuously updated pathway database curated by a community of researchers and pathway enthusiasts. WikiPathways produces monthly releases of gmt files for supported organisms at data.wikipathways.org. Download the appropriate gmt file and then generate TERM2GENE and TERM2NAME to use enricher and GSEA functions. library(magrittr) library(clusterProfiler) data(geneList, package=&quot;DOSE&quot;) gene &lt;- names(geneList)[abs(geneList) &gt; 2] wpgmtfile &lt;- system.file(&quot;extdata/wikipathways-20180810-gmt-Homo_sapiens.gmt&quot;, package=&quot;clusterProfiler&quot;) wp2gene &lt;- read.gmt(wpgmtfile) wp2gene &lt;- wp2gene %&gt;% tidyr::separate(ont, c(&quot;name&quot;,&quot;version&quot;,&quot;wpid&quot;,&quot;org&quot;), &quot;%&quot;) wpid2gene &lt;- wp2gene %&gt;% dplyr::select(wpid, gene) #TERM2GENE wpid2name &lt;- wp2gene %&gt;% dplyr::select(wpid, name) #TERM2NAME ewp &lt;- enricher(gene, TERM2GENE = wpid2gene, TERM2NAME = wpid2name) head(ewp) ## ID ## WP2446 WP2446 ## WP2361 WP2361 ## WP179 WP179 ## WP3942 WP3942 ## WP4240 WP4240 ## WP2328 WP2328 ## Description ## WP2446 Retinoblastoma (RB) in Cancer ## WP2361 Gastric Cancer Network 1 ## WP179 Cell Cycle ## WP3942 PPAR signaling pathway ## WP4240 Regulation of sister chromatid separation at the metaphase-anaphase transition ## WP2328 Allograft Rejection ## GeneRatio BgRatio pvalue p.adjust ## WP2446 11/95 88/6249 6.801697e-08 1.054263e-05 ## WP2361 6/95 29/6249 3.772735e-06 2.923870e-04 ## WP179 10/95 122/6249 1.384549e-05 7.153503e-04 ## WP3942 7/95 67/6249 6.210513e-05 2.406574e-03 ## WP4240 4/95 16/6249 7.931988e-05 2.458916e-03 ## WP2328 7/95 90/6249 4.016758e-04 1.037663e-02 ## qvalue ## WP2446 9.450779e-06 ## WP2361 2.621058e-04 ## WP179 6.412648e-04 ## WP3942 2.157336e-03 ## WP4240 2.204258e-03 ## WP2328 9.301967e-03 ## geneID ## WP2446 8318/9133/7153/6241/890/983/81620/7272/1111/891/24137 ## WP2361 4605/7153/11065/22974/6286/6790 ## WP179 8318/991/9133/890/983/7272/1111/891/4174/9232 ## WP3942 4312/9415/9370/5105/2167/3158/5346 ## WP4240 991/1062/4085/9232 ## WP2328 10563/6373/4283/3002/10578/3117/730 ## Count ## WP2446 11 ## WP2361 6 ## WP179 10 ## WP3942 7 ## WP4240 4 ## WP2328 7 ewp2 &lt;- GSEA(geneList, TERM2GENE = wpid2gene, TERM2NAME = wpid2name, verbose=FALSE) head(ewp2) ## [1] ID Description setSize ## [4] enrichmentScore NES pvalue ## [7] p.adjust qvalues ## &lt;0 rows&gt; (or 0-length row.names) You may want to convert the gene IDs to gene symbols, which can be done by setReadable function. library(org.Hs.eg.db) ewp &lt;- setReadable(ewp, org.Hs.eg.db, keyType = &quot;ENTREZID&quot;) ewp2 &lt;- setReadable(ewp2, org.Hs.eg.db, keyType = &quot;ENTREZID&quot;) head(ewp) ## ID ## WP2446 WP2446 ## WP2361 WP2361 ## WP179 WP179 ## WP3942 WP3942 ## WP4240 WP4240 ## WP2328 WP2328 ## Description ## WP2446 Retinoblastoma (RB) in Cancer ## WP2361 Gastric Cancer Network 1 ## WP179 Cell Cycle ## WP3942 PPAR signaling pathway ## WP4240 Regulation of sister chromatid separation at the metaphase-anaphase transition ## WP2328 Allograft Rejection ## GeneRatio BgRatio pvalue p.adjust ## WP2446 11/95 88/6249 6.801697e-08 1.054263e-05 ## WP2361 6/95 29/6249 3.772735e-06 2.923870e-04 ## WP179 10/95 122/6249 1.384549e-05 7.153503e-04 ## WP3942 7/95 67/6249 6.210513e-05 2.406574e-03 ## WP4240 4/95 16/6249 7.931988e-05 2.458916e-03 ## WP2328 7/95 90/6249 4.016758e-04 1.037663e-02 ## qvalue ## WP2446 9.450779e-06 ## WP2361 2.621058e-04 ## WP179 6.412648e-04 ## WP3942 2.157336e-03 ## WP4240 2.204258e-03 ## WP2328 9.301967e-03 ## geneID ## WP2446 CDC45/CCNB2/TOP2A/RRM2/CCNA2/CDK1/CDT1/TTK/CHEK1/CCNB1/KIF4A ## WP2361 MYBL2/TOP2A/UBE2C/TPX2/S100P/AURKA ## WP179 CDC45/CDC20/CCNB2/CCNA2/CDK1/TTK/CHEK1/CCNB1/MCM5/PTTG1 ## WP3942 MMP1/FADS2/ADIPOQ/PCK1/FABP4/HMGCS2/PLIN1 ## WP4240 CDC20/CENPE/MAD2L1/PTTG1 ## WP2328 CXCL13/CXCL11/CXCL9/GZMB/GNLY/HLA-DQA1/C7 ## Count ## WP2446 11 ## WP2361 6 ## WP179 10 ## WP3942 7 ## WP4240 4 ## WP2328 7 head(ewp2) ## [1] ID Description setSize ## [4] enrichmentScore NES pvalue ## [7] p.adjust qvalues ## &lt;0 rows&gt; (or 0-length row.names) As an alternative to manually downloading gmt files, install the rWikiPathways package to gain scripting access to the latest gmt files using the downloadPathwayArchive function. 3.3 Cell Marker cell_markers &lt;- vroom::vroom(&#39;http://bio-bigdata.hrbmu.edu.cn/CellMarker/download/Human_cell_markers.txt&#39;) %&gt;% tidyr::unite(&quot;cellMarker&quot;, tissueType, cancerType, cellName, sep=&quot;, &quot;) %&gt;% dplyr::select(cellMarker, geneID) cell_markers ## # A tibble: 2,868 x 2 ## cellMarker geneID ## &lt;chr&gt; &lt;chr&gt; ## 1 Kidney, Normal, Proximal tubular cell 248 ## 2 Liver, Normal, Ito cell (hepatic stellat… 6855 ## 3 Endometrium, Normal, Trophoblast cell 634 ## 4 Germ, Normal, Primordial germ cell 54514 ## 5 Corneal epithelium, Normal, Epithelial c… 1316 ## 6 Placenta, Normal, Cytotrophoblast 2255 ## 7 Periosteum, Normal, Periosteum-derived p… 214, 5788, 928… ## 8 Amniotic membrane, Normal, Amnion epithe… 79923, 5460 ## 9 Primitive streak, Normal, Primitive stre… 3975, 83881 ## 10 Adipose tissue, Normal, Stromal vascular… 947 ## # … with 2,858 more rows y &lt;- enricher(gene, TERM2GENE=cell_markers, minGSSize=1) DT::datatable(as.data.frame(y)) 3.4 MSigDb analysis Molecular Signatures Database contains 8 major collections: H: hallmark gene sets C1: positional gene sets C2: curated gene sets C3: motif gene sets C4: computational gene sets C5: GO gene sets C6: oncogenic signatures C7: immunologic signatures Users can download GMT files from Broad Institute and use read.gmt to parse the file to be used in enricher() and GSEA(). There is an R package, msigdbr, that already packed the MSigDB gene sets in tidy data format that can be used directly with clusterProfiler. It supports several specices: library(msigdbr) msigdbr_show_species() ## [1] &quot;Bos taurus&quot; &quot;Caenorhabditis elegans&quot; ## [3] &quot;Canis lupus familiaris&quot; &quot;Danio rerio&quot; ## [5] &quot;Drosophila melanogaster&quot; &quot;Gallus gallus&quot; ## [7] &quot;Homo sapiens&quot; &quot;Mus musculus&quot; ## [9] &quot;Rattus norvegicus&quot; &quot;Saccharomyces cerevisiae&quot; ## [11] &quot;Sus scrofa&quot; We can retrieve all human gene sets: m_df &lt;- msigdbr(species = &quot;Homo sapiens&quot;) head(m_df, 2) %&gt;% as.data.frame ## gs_name gs_id gs_cat gs_subcat human_gene_symbol ## 1 AAACCAC_MIR140 M12609 C3 MIR ABCC4 ## 2 AAACCAC_MIR140 M12609 C3 MIR ACTN4 ## species_name entrez_gene gene_symbol sources ## 1 Homo sapiens 10257 ABCC4 &lt;NA&gt; ## 2 Homo sapiens 81 ACTN4 &lt;NA&gt; Or specific collection. Here we use C6, oncogenic gene sets as an example: m_t2g &lt;- msigdbr(species = &quot;Homo sapiens&quot;, category = &quot;C6&quot;) %&gt;% dplyr::select(gs_name, entrez_gene) head(m_t2g) ## # A tibble: 6 x 2 ## gs_name entrez_gene ## &lt;chr&gt; &lt;int&gt; ## 1 AKT_UP_MTOR_DN.V1_DN 25864 ## 2 AKT_UP_MTOR_DN.V1_DN 95 ## 3 AKT_UP_MTOR_DN.V1_DN 137872 ## 4 AKT_UP_MTOR_DN.V1_DN 134 ## 5 AKT_UP_MTOR_DN.V1_DN 55326 ## 6 AKT_UP_MTOR_DN.V1_DN 271 em &lt;- enricher(gene, TERM2GENE=m_t2g) em2 &lt;- GSEA(geneList, TERM2GENE = m_t2g) head(em) ## ID ## RPS14_DN.V1_DN RPS14_DN.V1_DN ## GCNP_SHH_UP_LATE.V1_UP GCNP_SHH_UP_LATE.V1_UP ## VEGF_A_UP.V1_DN VEGF_A_UP.V1_DN ## PRC2_EZH2_UP.V1_DN PRC2_EZH2_UP.V1_DN ## CSR_LATE_UP.V1_UP CSR_LATE_UP.V1_UP ## E2F1_UP.V1_UP E2F1_UP.V1_UP ## Description GeneRatio ## RPS14_DN.V1_DN RPS14_DN.V1_DN 22/186 ## GCNP_SHH_UP_LATE.V1_UP GCNP_SHH_UP_LATE.V1_UP 16/186 ## VEGF_A_UP.V1_DN VEGF_A_UP.V1_DN 15/186 ## PRC2_EZH2_UP.V1_DN PRC2_EZH2_UP.V1_DN 14/186 ## CSR_LATE_UP.V1_UP CSR_LATE_UP.V1_UP 12/186 ## E2F1_UP.V1_UP E2F1_UP.V1_UP 12/186 ## BgRatio pvalue p.adjust ## RPS14_DN.V1_DN 187/11250 4.072878e-13 6.923892e-11 ## GCNP_SHH_UP_LATE.V1_UP 183/11250 5.657195e-08 4.808615e-06 ## VEGF_A_UP.V1_DN 193/11250 6.903522e-07 3.911996e-05 ## PRC2_EZH2_UP.V1_DN 195/11250 4.197805e-06 1.784067e-04 ## CSR_LATE_UP.V1_UP 172/11250 2.766080e-05 9.404672e-04 ## E2F1_UP.V1_UP 189/11250 6.963494e-05 1.972990e-03 ## qvalue ## RPS14_DN.V1_DN 5.616284e-11 ## GCNP_SHH_UP_LATE.V1_UP 3.900487e-06 ## VEGF_A_UP.V1_DN 3.173198e-05 ## PRC2_EZH2_UP.V1_DN 1.447138e-04 ## CSR_LATE_UP.V1_UP 7.628557e-04 ## E2F1_UP.V1_UP 1.600382e-03 ## geneID ## RPS14_DN.V1_DN 10874/55388/991/9493/1062/4605/9133/23397/79733/9787/55872/83461/54821/51659/9319/9055/10112/4174/5105/2532/7021/79901 ## GCNP_SHH_UP_LATE.V1_UP 55388/7153/79733/6241/9787/51203/983/9212/1111/9319/9055/3833/6790/4174/3169/1580 ## VEGF_A_UP.V1_DN 8318/9493/1062/9133/10403/6241/9787/4085/332/3832/7272/891/23362/2167/10234 ## PRC2_EZH2_UP.V1_DN 8318/55388/4605/23397/9787/55355/10460/81620/2146/7272/9212/11182/3887/24137 ## CSR_LATE_UP.V1_UP 55143/2305/4605/6241/11065/55872/983/332/2146/51659/9319/1580 ## E2F1_UP.V1_UP 55388/7153/23397/79733/9787/2146/2842/9212/8208/1111/9055/3833 ## Count ## RPS14_DN.V1_DN 22 ## GCNP_SHH_UP_LATE.V1_UP 16 ## VEGF_A_UP.V1_DN 15 ## PRC2_EZH2_UP.V1_DN 14 ## CSR_LATE_UP.V1_UP 12 ## E2F1_UP.V1_UP 12 head(em2) ## ID Description setSize ## IL2_UP.V1_DN IL2_UP.V1_DN IL2_UP.V1_DN 183 ## RAF_UP.V1_DN RAF_UP.V1_DN RAF_UP.V1_DN 189 ## ATF2_S_UP.V1_DN ATF2_S_UP.V1_DN ATF2_S_UP.V1_DN 182 ## ATF2_UP.V1_DN ATF2_UP.V1_DN ATF2_UP.V1_DN 178 ## IL15_UP.V1_DN IL15_UP.V1_DN IL15_UP.V1_DN 182 ## LEF1_UP.V1_DN LEF1_UP.V1_DN LEF1_UP.V1_DN 188 ## enrichmentScore NES pvalue ## IL2_UP.V1_DN -0.4237496 -1.716666 0.001412429 ## RAF_UP.V1_DN -0.5521243 -2.247550 0.001414427 ## ATF2_S_UP.V1_DN -0.4456885 -1.806367 0.001416431 ## ATF2_UP.V1_DN -0.5029082 -2.033430 0.001416431 ## IL15_UP.V1_DN -0.4687839 -1.899973 0.001416431 ## LEF1_UP.V1_DN -0.4938672 -2.005243 0.001420455 ## p.adjust qvalues rank ## IL2_UP.V1_DN 0.0179863 0.009516559 2774 ## RAF_UP.V1_DN 0.0179863 0.009516559 2035 ## ATF2_S_UP.V1_DN 0.0179863 0.009516559 2531 ## ATF2_UP.V1_DN 0.0179863 0.009516559 2055 ## IL15_UP.V1_DN 0.0179863 0.009516559 2436 ## LEF1_UP.V1_DN 0.0179863 0.009516559 1705 ## leading_edge ## IL2_UP.V1_DN tags=39%, list=22%, signal=31% ## RAF_UP.V1_DN tags=43%, list=16%, signal=37% ## ATF2_S_UP.V1_DN tags=39%, list=20%, signal=32% ## ATF2_UP.V1_DN tags=38%, list=16%, signal=32% ## IL15_UP.V1_DN tags=40%, list=19%, signal=33% ## LEF1_UP.V1_DN tags=36%, list=14%, signal=32% ## core_enrichment ## IL2_UP.V1_DN 10858/5333/2977/79874/10014/7773/64798/26959/6588/579/777/5158/23361/9915/5087/64759/2535/6123/7010/51285/126353/80201/79841/1028/2322/4222/947/9187/225/9976/5592/54996/3202/55779/23148/5334/8605/57326/26115/54453/55766/64927/6591/55204/9940/57608/653483/9886/10279/55805/10628/901/9891/7102/27244/79921/4674/8292/5125/79843/6857/79940/23541/3357/50853/9863/79932/90362/55663/4250 ## RAF_UP.V1_DN 221037/1960/51340/55105/10265/22996/9687/5357/1952/12/4602/9231/596/51454/57419/595/4256/23022/8777/7837/7042/3397/57613/323/1831/6451/54843/7358/2353/8773/6938/8991/64699/57007/23389/10560/7227/3485/79068/10769/4254/26018/3480/2674/23327/857/116039/6542/2690/1955/1363/26353/7033/5376/89927/51363/8821/2239/6947/4886/214/3487/3667/5157/54847/54898/7031/6505/57535/10451/18/771/80129/5174/5507/56521/8839/8614/5241/10551/57758 ## ATF2_S_UP.V1_DN 53616/55667/51279/4642/7130/7139/2/710/80352/4608/11145/881/2252/3399/22846/10687/12/1397/1301/3554/2619/26011/78987/9284/1306/6586/9627/4054/54813/115207/55890/26249/4803/11075/3400/79789/8527/2353/10580/79987/80760/5493/90865/3485/3751/2202/2199/10610/1047/1294/23492/3908/5364/658/5350/2121/2331/4330/9737/4982/57088/8490/9358/6424/1307/3708/125/1311/56521/10351 ## ATF2_UP.V1_DN 9738/2252/8660/10687/5357/80201/12/22998/3554/2619/23556/8840/9284/399491/57419/5737/6586/9627/8863/10085/115207/55890/23015/629/3212/3400/50650/8527/2353/79987/80760/9668/1012/10614/5493/8553/23126/90865/3485/3751/2202/57212/2199/10610/3075/6387/22834/1909/10129/57161/5350/2121/2331/4330/2952/4982/57088/9358/6424/6038/51313/1311/56521/10351/5304/4239/79901 ## IL15_UP.V1_DN 64798/26959/6588/3784/777/113791/79981/64759/2535/957/6123/8038/51285/126353/55357/1470/2669/1028/4222/7450/225/1942/9976/29068/5592/54996/10272/6019/55779/80823/80215/5334/9639/57326/6403/26115/54453/57126/151011/57644/1831/51339/6591/55204/1393/1272/57608/79999/653483/9886/10279/55805/1047/10628/901/64123/27244/116039/79921/7041/54361/79843/6857/2239/6947/23541/55857/1811/3357/5104/56967/284266 ## LEF1_UP.V1_DN 22998/10325/23221/79170/9187/4300/51479/25956/7552/8644/11162/7168/1490/54463/65084/25837/80303/1809/3397/4208/11223/79762/6451/481/54795/51626/8991/5950/5627/64699/6414/10103/221078/9961/5874/56898/90865/57235/83989/5002/6653/56034/55314/85458/956/54502/4832/5783/1363/53832/54985/80221/84786/214/50853/51149/57088/5157/2947/79932/7031/6505/9338/25924/80736/3169/10551 We can test with other collections, for example, using C3 to test whether the genes are up/down-regulated by sharing specific motif. m_t2g &lt;- msigdbr(species = &quot;Homo sapiens&quot;, category = &quot;C3&quot;) %&gt;% dplyr::select(gs_name, entrez_gene) head(m_t2g) ## # A tibble: 6 x 2 ## gs_name entrez_gene ## &lt;chr&gt; &lt;int&gt; ## 1 AAACCAC_MIR140 10257 ## 2 AAACCAC_MIR140 81 ## 3 AAACCAC_MIR140 90 ## 4 AAACCAC_MIR140 8754 ## 5 AAACCAC_MIR140 11096 ## 6 AAACCAC_MIR140 177 em3 &lt;- GSEA(geneList, TERM2GENE = m_t2g) head(em3) ## ID ## GGATTA_PITX2_Q2 GGATTA_PITX2_Q2 ## WTGAAAT_UNKNOWN WTGAAAT_UNKNOWN ## TGACATY_UNKNOWN TGACATY_UNKNOWN ## TTTGCAC_MIR19A_MIR19B TTTGCAC_MIR19A_MIR19B ## CAGTATT_MIR200B_MIR200C_MIR429 CAGTATT_MIR200B_MIR200C_MIR429 ## WGTTNNNNNAAA_UNKNOWN WGTTNNNNNAAA_UNKNOWN ## Description ## GGATTA_PITX2_Q2 GGATTA_PITX2_Q2 ## WTGAAAT_UNKNOWN WTGAAAT_UNKNOWN ## TGACATY_UNKNOWN TGACATY_UNKNOWN ## TTTGCAC_MIR19A_MIR19B TTTGCAC_MIR19A_MIR19B ## CAGTATT_MIR200B_MIR200C_MIR429 CAGTATT_MIR200B_MIR200C_MIR429 ## WGTTNNNNNAAA_UNKNOWN WGTTNNNNNAAA_UNKNOWN ## setSize enrichmentScore ## GGATTA_PITX2_Q2 449 -0.3345811 ## WTGAAAT_UNKNOWN 458 -0.3214586 ## TGACATY_UNKNOWN 497 -0.3193965 ## TTTGCAC_MIR19A_MIR19B 397 -0.3659786 ## CAGTATT_MIR200B_MIR200C_MIR429 383 -0.3564722 ## WGTTNNNNNAAA_UNKNOWN 420 -0.3201831 ## NES pvalue ## GGATTA_PITX2_Q2 -1.486337 0.001209190 ## WTGAAAT_UNKNOWN -1.430554 0.001210654 ## TGACATY_UNKNOWN -1.424413 0.001213592 ## TTTGCAC_MIR19A_MIR19B -1.608477 0.001242236 ## CAGTATT_MIR200B_MIR200C_MIR429 -1.561285 0.001245330 ## WGTTNNNNNAAA_UNKNOWN -1.413069 0.001253133 ## p.adjust qvalues rank ## GGATTA_PITX2_Q2 0.02754988 0.01898976 2464 ## WTGAAAT_UNKNOWN 0.02754988 0.01898976 1523 ## TGACATY_UNKNOWN 0.02754988 0.01898976 2961 ## TTTGCAC_MIR19A_MIR19B 0.02754988 0.01898976 4078 ## CAGTATT_MIR200B_MIR200C_MIR429 0.02754988 0.01898976 3186 ## WGTTNNNNNAAA_UNKNOWN 0.02754988 0.01898976 2754 ## leading_edge ## GGATTA_PITX2_Q2 tags=26%, list=20%, signal=22% ## WTGAAAT_UNKNOWN tags=18%, list=12%, signal=17% ## TGACATY_UNKNOWN tags=30%, list=24%, signal=24% ## TTTGCAC_MIR19A_MIR19B tags=44%, list=33%, signal=30% ## CAGTATT_MIR200B_MIR200C_MIR429 tags=34%, list=25%, signal=26% ## WGTTNNNNNAAA_UNKNOWN tags=30%, list=22%, signal=24% ## core_enrichment ## GGATTA_PITX2_Q2 311/3199/4604/57556/8019/3321/57835/8929/6671/1760/10401/4430/9497/5530/6532/54894/23528/5228/5087/2295/6453/56171/3232/4921/3005/221037/56912/10265/10521/10497/23767/8322/37/23429/6561/4303/57082/845/94/51447/9922/6258/23243/2571/10253/4602/29119/55068/126393/7402/56675/5624/7716/7779/596/4300/57804/79923/1280/100506658/9627/3675/26037/2261/2804/65084/11030/3216/57326/140890/23255/5396/9854/1907/54843/57037/862/23452/55152/1848/8835/89795/57007/64221/5136/7227/10324/55273/6310/2202/56034/956/54502/51474/4254/6925/6097/744/443/23446/4306/4915/4487/25803/4081/4223/10472/388677/55107/347902/3708/10742/51313/4857/730/4036/3169 ## WTGAAAT_UNKNOWN 2823/80762/50486/4628/9736/324/80070/51585/9627/8082/11211/4885/64112/7482/5334/79645/4734/80059/4208/11075/55084/2012/6709/6003/55629/8829/1581/54843/2353/862/727/10516/10580/1848/55204/5166/89795/2845/79776/9886/761/116496/4488/11096/10468/23677/9201/3075/6925/4121/443/55184/57332/5205/10129/2819/57161/51306/55812/3249/54361/54970/5744/26960/10186/10472/388677/4330/53829/26137/9079/8404/36/3572/3479/1602/23090/81563/2167/8614/57758/4969 ## TGACATY_UNKNOWN 800/5168/55691/5789/11080/6400/55512/1112/9604/29760/4638/3218/27314/2065/4286/9459/4026/7026/4335/2263/53353/54329/7082/10446/5930/8567/51334/10174/8626/687/3321/83478/6588/5441/8929/7881/9846/23328/8924/220988/146057/55909/4661/29116/23405/94134/56171/63898/4131/4776/80000/627/9748/2908/11138/23767/10290/5295/1288/9445/10231/29/3373/2669/5191/4211/5813/25945/7716/596/4300/2078/3931/8633/9627/2872/3213/80021/2261/11194/3223/4212/8848/5837/6764/23037/57326/7106/590/7042/4208/55084/50650/80052/6450/323/481/8436/2353/10370/862/9120/727/79899/23452/1293/10580/60481/54838/55204/5166/2845/81603/6876/8522/1592/5577/3489/6310/2202/29951/27239/55821/9499/1501/57161/6571/4035/8821/5744/90627/4922/55800/4223/10472/23303/1264/54587/9590/9576/185/4675/576/1287/9358/3479/5348/776/771/79689 ## TTTGCAC_MIR19A_MIR19B 1605/659/10318/4299/6249/81609/57194/9686/10425/9839/23013/22936/989/51742/4154/55625/51460/51592/11127/3976/54980/9751/56937/6045/4204/27252/4862/27236/2115/5869/152006/57698/57018/23032/56145/10150/55054/4090/25852/10618/2060/7107/10771/7071/9044/10904/9752/6431/8473/83452/392/10395/6777/51230/22889/23236/55652/158471/6595/905/56146/4026/79665/5932/115/8325/546/10154/9655/23499/54521/26959/23612/3321/56929/54778/26060/56848/9098/107/10420/23001/29922/9759/29116/23405/94134/2295/6453/83660/51719/8654/11138/2186/23341/8038/860/2004/9256/6548/23621/23503/29/394/220594/831/92689/55082/54014/1901/23111/7552/27303/1490/51454/57419/66008/2318/6252/7248/4929/23041/9900/55727/91694/22863/1389/54796/3400/9649/23253/54453/7048/22862/22905/23365/79899/5412/60481/54838/89795/5793/23389/7227/6310/3625/26018/23492/2099/23116/744/775/90355/388/23414/11069/6857/26960/55638/10472/2152/2697/3131/7786/55107/9863/23261/3479/3708/10742/2018/4036/2066 ## CAGTATT_MIR200B_MIR200C_MIR429 31/23291/5179/57092/9969/9865/8473/9644/10395/6383/5569/1392/4008/9647/11041/8613/6405/4884/8491/9706/2263/6567/53353/64766/5310/546/5128/55145/54469/200576/8434/7003/687/3915/1456/3321/10499/23189/26060/55578/1998/51421/22864/10484/10140/23001/4661/253782/9807/83660/95681/1960/2908/51719/2186/22846/108/9710/80205/2104/9522/7320/23243/23258/4602/129642/2669/51439/7716/54014/23047/5099/2823/3340/1942/7552/1843/100506658/8204/10979/79618/23015/8848/4692/5334/57515/26249/6563/23122/6196/4077/2494/10370/3953/51339/79365/54838/89795/8076/5577/3751/6310/1009/29994/10769/1501/57509/3899/2273/23116/4908/27244/775/5783/65055/4035/23414/2737/5744/6857/55800/10186/3131/9828/6935/4982/219654/1602/3708/4857 ## WGTTNNNNNAAA_UNKNOWN 9459/64132/4026/7026/79665/29072/83604/5218/7020/64766/54329/2114/10124/79742/1105/51279/4601/1298/51747/5071/8929/10681/6671/79729/8843/8609/23528/10211/94134/10206/4131/79960/80000/221037/627/2252/10521/5295/7010/9710/51780/3221/23429/2104/26054/25876/2571/22902/23258/63971/29119/604/23221/55068/460/4222/5099/2078/4216/9315/27303/64388/3202/54819/58190/3223/4256/4929/4212/3216/140890/79641/23635/167/54796/6003/54453/9854/553/80267/22862/2353/23365/862/2638/1848/54838/8835/1592/3489/3778/51673/1657/477/9073/29951/4313/4337/10468/9369/79667/9499/6925/3480/4908/744/1462/51309/5101/4741/51363/25803/213/8800/10472/26137/9079/1634/4128/23090/4857/652/3169/7021/4969 "],
["chapter4.html", "Chapter 4 Disease analysis 4.1 enrichDO function 4.2 enrichNCG function 4.3 enrichDGN and enrichDGNv functions 4.4 gseDO fuction 4.5 gseNCG fuction 4.6 gseDGN fuction", " Chapter 4 Disease analysis DOSE(Yu et al. 2015) supports Disease Ontology (DO) Semantic and Enrichment analysis. The enrichDO function is very useful for identifying disease association of interesting genes, and function gseDO function is designed for gene set enrichment analysis of DO. In addition, DOSE also supports enrichment analysis of Network of Cancer Gene (NCG)(A. et al. 2016) and Disease Gene Network(Janet et al. 2015), please refer to the DOSE vignettes. 4.1 enrichDO function In the following example, we selected fold change above 1 as the differential genes and analyzing their disease association. library(DOSE) data(geneList) gene &lt;- names(geneList)[abs(geneList) &gt; 1.5] head(gene) ## [1] &quot;4312&quot; &quot;8318&quot; &quot;10874&quot; &quot;55143&quot; &quot;55388&quot; &quot;991&quot; x &lt;- enrichDO(gene = gene, ont = &quot;DO&quot;, pvalueCutoff = 0.05, pAdjustMethod = &quot;BH&quot;, universe = names(geneList), minGSSize = 5, maxGSSize = 500, qvalueCutoff = 0.05, readable = FALSE) head(x) ## ID Description ## DOID:170 DOID:170 endocrine gland cancer ## DOID:10283 DOID:10283 prostate cancer ## DOID:3459 DOID:3459 breast carcinoma ## DOID:3856 DOID:3856 male reproductive organ cancer ## DOID:824 DOID:824 periodontitis ## DOID:3905 DOID:3905 lung carcinoma ## GeneRatio BgRatio pvalue p.adjust ## DOID:170 48/331 472/6268 5.662129e-06 0.004784499 ## DOID:10283 40/331 394/6268 3.859157e-05 0.013921739 ## DOID:3459 37/331 357/6268 4.942629e-05 0.013921739 ## DOID:3856 40/331 404/6268 6.821467e-05 0.014410349 ## DOID:824 16/331 109/6268 1.699304e-04 0.018859464 ## DOID:3905 43/331 465/6268 1.749754e-04 0.018859464 ## qvalue ## DOID:170 0.003826407 ## DOID:10283 0.011133923 ## DOID:3459 0.011133923 ## DOID:3856 0.011524689 ## DOID:824 0.015082872 ## DOID:3905 0.015082872 ## geneID ## DOID:170 10874/7153/1381/6241/11065/10232/332/6286/2146/10112/891/9232/4171/993/5347/4318/3576/1515/4821/8836/3159/7980/5888/333/898/9768/4288/3551/2152/9590/185/7043/3357/2952/5327/3667/1634/1287/4582/7122/3479/4680/6424/80310/652/8839/9547/1524 ## DOID:10283 4312/6280/6279/597/3627/332/6286/2146/4321/4521/891/5347/4102/4318/701/3576/79852/10321/6352/4288/3551/2152/247/2952/3487/367/3667/4128/4582/563/3679/4117/7031/3479/6424/10451/80310/652/4036/10551 ## DOID:3459 4312/6280/6279/7153/4751/890/4085/332/6286/6790/891/9232/10855/4171/5347/4318/701/2633/3576/9636/898/8792/4288/2952/4982/4128/4582/7031/3479/771/4250/2066/3169/10647/5304/5241/10551 ## DOID:3856 4312/6280/6279/597/3627/332/6286/2146/4321/4521/891/5347/4102/4318/701/3576/79852/10321/6352/4288/3551/2152/247/2952/3487/367/3667/4128/4582/563/3679/4117/7031/3479/6424/10451/80310/652/4036/10551 ## DOID:824 4312/6279/820/7850/4321/3595/4318/4069/3576/1493/6352/8842/185/2952/5327/4982 ## DOID:3905 4312/6280/2305/9133/6279/7153/6278/6241/55165/11065/8140/10232/332/6286/3002/9212/4521/891/4171/9928/8061/4318/3576/1978/1894/7980/7083/898/6352/8842/4288/2152/2697/2952/3572/4582/7049/563/3479/1846/3117/2532/2922 ## Count ## DOID:170 48 ## DOID:10283 40 ## DOID:3459 37 ## DOID:3856 40 ## DOID:824 16 ## DOID:3905 43 The enrichDO function requires an entrezgene ID vector as input, mostly is the differential gene list of gene expression profile studies. If user needs to convert other gene ID type to entrezgene ID, we recommend using bitr function provided by clusterProfiler. The ont parameter can be “DO” or “DOLite”, DOLite(Du et al. 2009) was constructed to aggregate the redundant DO terms. The DOLite data is not updated, we recommend user use ont=&quot;DO&quot;. pvalueCutoff setting the cutoff value of p value and p value adjust; pAdjustMethod setting the p value correction methods, include the Bonferroni correction (“bonferroni”), Holm (“holm”), Hochberg (“hochberg”), Hommel (“hommel”), Benjamini &amp; Hochberg (“BH”) and Benjamini &amp; Yekutieli (“BY”) while qvalueCutoff is used to control q-values. The universe setting the background gene universe for testing. If user do not explicitly setting this parameter, enrichDO will set the universe to all human genes that have DO annotation. The minGSSize (and maxGSSize) indicates that only those DO terms that have more than minGSSize (and less than maxGSSize) genes annotated will be tested. The readable is a logical parameter, indicates whether the entrezgene IDs will mapping to gene symbols or not. We also implement setReadable function that helps the user to convert entrezgene IDs to gene symbols. x &lt;- setReadable(x, &#39;org.Hs.eg.db&#39;) head(x) ## ID Description ## DOID:170 DOID:170 endocrine gland cancer ## DOID:10283 DOID:10283 prostate cancer ## DOID:3459 DOID:3459 breast carcinoma ## DOID:3856 DOID:3856 male reproductive organ cancer ## DOID:824 DOID:824 periodontitis ## DOID:3905 DOID:3905 lung carcinoma ## GeneRatio BgRatio pvalue p.adjust ## DOID:170 48/331 472/6268 5.662129e-06 0.004784499 ## DOID:10283 40/331 394/6268 3.859157e-05 0.013921739 ## DOID:3459 37/331 357/6268 4.942629e-05 0.013921739 ## DOID:3856 40/331 404/6268 6.821467e-05 0.014410349 ## DOID:824 16/331 109/6268 1.699304e-04 0.018859464 ## DOID:3905 43/331 465/6268 1.749754e-04 0.018859464 ## qvalue ## DOID:170 0.003826407 ## DOID:10283 0.011133923 ## DOID:3459 0.011133923 ## DOID:3856 0.011524689 ## DOID:824 0.015082872 ## DOID:3905 0.015082872 ## geneID ## DOID:170 NMU/TOP2A/CRABP1/RRM2/UBE2C/MSLN/BIRC5/S100P/EZH2/KIF20A/CCNB1/PTTG1/MCM2/CDC25A/PLK1/MMP9/CXCL8/CTSV/NKX2-2/GGH/HMGA1/TFPI2/RAD51/APLP1/CCNE1/PCLAF/MKI67/IKBKB/F3/AKAP12/AGTR1/TGFB3/HTR2B/GSTT1/PLAT/IRS1/DCN/COL4A5/MUC1/CLDN5/IGF1/CEACAM6/SFRP4/PDGFD/BMP4/CCN5/CXCL14/CX3CR1 ## DOID:10283 MMP1/S100A9/S100A8/BCL2A1/CXCL10/BIRC5/S100P/EZH2/MMP12/NUDT1/CCNB1/PLK1/MAGEA3/MMP9/BUB1B/CXCL8/EPHX3/CRISP3/CCL5/MKI67/IKBKB/F3/ALOX15B/GSTT1/IGFBP4/AR/IRS1/MAOA/MUC1/AZGP1/ITGA7/MAK/TFF1/IGF1/SFRP4/VAV3/PDGFD/BMP4/LRP2/AGR2 ## DOID:3459 MMP1/S100A9/S100A8/TOP2A/NEK2/CCNA2/MAD2L1/BIRC5/S100P/AURKA/CCNB1/PTTG1/HPSE/MCM2/PLK1/MMP9/BUB1B/GBP1/CXCL8/ISG15/CCNE1/TNFRSF11A/MKI67/GSTT1/TNFRSF11B/MAOA/MUC1/TFF1/IGF1/CA12/SCGB2A2/ERBB4/FOXA1/SCGB1D2/PIP/PGR/AGR2 ## DOID:3856 MMP1/S100A9/S100A8/BCL2A1/CXCL10/BIRC5/S100P/EZH2/MMP12/NUDT1/CCNB1/PLK1/MAGEA3/MMP9/BUB1B/CXCL8/EPHX3/CRISP3/CCL5/MKI67/IKBKB/F3/ALOX15B/GSTT1/IGFBP4/AR/IRS1/MAOA/MUC1/AZGP1/ITGA7/MAK/TFF1/IGF1/SFRP4/VAV3/PDGFD/BMP4/LRP2/AGR2 ## DOID:824 MMP1/S100A8/CAMP/IL1R2/MMP12/IL12RB2/MMP9/LYZ/CXCL8/CTLA4/CCL5/PROM1/AGTR1/GSTT1/PLAT/TNFRSF11B ## DOID:3905 MMP1/S100A9/FOXM1/CCNB2/S100A8/TOP2A/S100A7/RRM2/CEP55/UBE2C/SLC7A5/MSLN/BIRC5/S100P/GZMB/AURKB/NUDT1/CCNB1/MCM2/KIF14/FOSL1/MMP9/CXCL8/EIF4EBP1/ECT2/TFPI2/TK1/CCNE1/CCL5/PROM1/MKI67/F3/GJA1/GSTT1/IL6ST/MUC1/TGFBR3/AZGP1/IGF1/DUSP4/HLA-DQA1/ACKR1/GRP ## Count ## DOID:170 48 ## DOID:10283 40 ## DOID:3459 37 ## DOID:3856 40 ## DOID:824 16 ## DOID:3905 43 4.2 enrichNCG function Network of Cancer Gene (NCG)(A. et al. 2016) is a manually curated repository of cancer genes. NCG release 5.0 (Aug. 2015) collects 1,571 cancer genes from 175 published studies. DOSE supports analyzing gene list and determine whether they are enriched in genes known to be mutated in a given cancer type. gene2 &lt;- names(geneList)[abs(geneList) &lt; 3] ncg &lt;- enrichNCG(gene2) head(ncg) ## ID ## soft_tissue_sarcomas soft_tissue_sarcomas ## bladder bladder ## glioma glioma ## Description GeneRatio BgRatio ## soft_tissue_sarcomas soft_tissue_sarcomas 28/1172 28/1571 ## bladder bladder 61/1172 67/1571 ## glioma glioma 68/1172 76/1571 ## pvalue p.adjust qvalue ## soft_tissue_sarcomas 0.0002517511 0.008056037 0.006360029 ## bladder 0.0005108168 0.008173069 0.006452423 ## glioma 0.0008511747 0.009079196 0.007167787 ## geneID ## soft_tissue_sarcomas 1029/999/6850/4914/4342/2185/55294/2041/4851/23512/2044/4058/5290/8726/4486/5297/5728/3815/2324/7403/5925/4763/1499/7157/5159/2045/3667/2066 ## bladder 9700/2175/9603/1029/8997/688/1026/896/677/6256/55294/8085/4851/3265/1999/3845/8243/10605/8295/4854/5290/2033/4780/23224/23217/2064/23385/55252/10735/4853/387/288/30849/9794/7403/287/463/472/4297/2065/2262/8289/9611/5925/2068/4763/7157/2186/1387/3910/2261/7248/23037/23345/7832/79633/10628/22906/388/4036/3169 ## glioma 4603/4609/1029/3418/8877/1019/7027/4613/1030/1956/1106/2264/3417/6597/4914/55359/896/894/2321/3954/5335/5781/8439/673/9444/4851/8087/2050/8493/3845/3482/667/56999/5290/2033/4233/577/5894/5156/80036/9407/3020/1021/5598/5728/8621/1828/63035/23592/8880/2260/54880/4916/2263/1639/90/546/8289/4763/7157/23152/5295/4602/595/2261/6938/4915/26137 ## Count ## soft_tissue_sarcomas 28 ## bladder 61 ## glioma 68 4.3 enrichDGN and enrichDGNv functions DisGeNET(Janet et al. 2015) is an integrative and comprehensive resources of gene-disease associations from several public data sources and the literature. It contains gene-disease associations and snp-gene-disease associations. The enrichment analysis of disease-gene associations is supported by the enrichDGN function and analysis of snp-gene-disease associations is supported by the enrichDGNv function. dgn &lt;- enrichDGN(gene) head(dgn) ## ID ## umls:C1134719 umls:C1134719 ## umls:C0032460 umls:C0032460 ## umls:C0206698 umls:C0206698 ## umls:C0007138 umls:C0007138 ## umls:C0031099 umls:C0031099 ## umls:C0005695 umls:C0005695 ## Description GeneRatio ## umls:C1134719 Invasive Ductal Breast Carcinoma 28/476 ## umls:C0032460 Polycystic Ovary Syndrome 38/476 ## umls:C0206698 Cholangiocarcinoma 36/476 ## umls:C0007138 Carcinoma, Transitional Cell 35/476 ## umls:C0031099 Periodontitis 28/476 ## umls:C0005695 Bladder Neoplasm 36/476 ## BgRatio pvalue p.adjust ## umls:C1134719 231/17381 4.312190e-11 1.225524e-07 ## umls:C0032460 434/17381 2.819624e-10 3.521620e-07 ## umls:C0206698 399/17381 3.717403e-10 3.521620e-07 ## umls:C0007138 389/17381 7.093837e-10 5.040171e-07 ## umls:C0031099 270/17381 1.634417e-09 9.290027e-07 ## umls:C0005695 442/17381 5.871618e-09 2.781190e-06 ## qvalue ## umls:C1134719 9.164539e-08 ## umls:C0032460 2.633487e-07 ## umls:C0206698 2.633487e-07 ## umls:C0007138 3.769068e-07 ## umls:C0031099 6.947133e-07 ## umls:C0005695 2.079789e-06 ## geneID ## umls:C1134719 9133/7153/6241/55165/11065/51203/22974/4751/5080/332/2568/3902/6790/891/24137/9232/10855/79801/4318/55635/5888/1493/9768/3070/4288/367/4582/5241 ## umls:C0032460 4312/6280/6279/7153/259266/6241/55165/55872/4085/6286/7272/366/891/4171/7941/1164/3161/4603/990/29127/4318/53335/3294/3070/2952/5327/367/3667/4582/563/27324/3479/114899/9370/2167/652/5346/5241 ## umls:C0206698 4312/2305/55872/4751/8140/10635/10232/5918/332/6286/2146/4521/891/10855/2921/7941/1164/4318/3576/1978/79852/8842/4485/214/65982/6863/1036/6935/4128/3572/4582/7031/7166/4680/80310/9 ## umls:C0007138 4312/991/6280/6241/55165/10460/6373/8140/890/10232/4085/332/6286/2146/4171/1033/6364/5347/4318/3576/8836/9700/898/4288/2952/367/8382/2947/3479/9338/23158/2167/2066/2625/9 ## umls:C0031099 4312/6279/3669/820/7850/332/4321/6364/3595/4318/3576/3898/8792/1493/4485/10472/185/6863/2205/2952/5327/4982/23261/2200/3572/2006/1308/2625 ## umls:C0005695 4312/10874/6280/3868/6279/597/7153/6241/9582/10460/4085/5080/332/2146/6790/10855/4171/5347/4318/3576/8836/9636/9700/898/4288/214/2952/367/2947/4582/3479/6424/9338/2066/1580/9 ## Count ## umls:C1134719 28 ## umls:C0032460 38 ## umls:C0206698 36 ## umls:C0007138 35 ## umls:C0031099 28 ## umls:C0005695 36 snp &lt;- c(&quot;rs1401296&quot;, &quot;rs9315050&quot;, &quot;rs5498&quot;, &quot;rs1524668&quot;, &quot;rs147377392&quot;, &quot;rs841&quot;, &quot;rs909253&quot;, &quot;rs7193343&quot;, &quot;rs3918232&quot;, &quot;rs3760396&quot;, &quot;rs2231137&quot;, &quot;rs10947803&quot;, &quot;rs17222919&quot;, &quot;rs386602276&quot;, &quot;rs11053646&quot;, &quot;rs1805192&quot;, &quot;rs139564723&quot;, &quot;rs2230806&quot;, &quot;rs20417&quot;, &quot;rs966221&quot;) dgnv &lt;- enrichDGNv(snp) head(dgnv) ## ID ## umls:C3272363 umls:C3272363 ## umls:C0948008 umls:C0948008 ## umls:C0038454 umls:C0038454 ## umls:C0027051 umls:C0027051 ## umls:C0010054 umls:C0010054 ## umls:C0010068 umls:C0010068 ## Description GeneRatio ## umls:C3272363 Ischemic Cerebrovascular Accident 20/20 ## umls:C0948008 Ischemic stroke 20/20 ## umls:C0038454 Cerebrovascular accident 7/20 ## umls:C0027051 Myocardial Infarction 6/20 ## umls:C0010054 Coronary Arteriosclerosis 6/20 ## umls:C0010068 Coronary heart disease 6/20 ## BgRatio pvalue p.adjust ## umls:C3272363 141/46589 1.014503e-51 1.379725e-49 ## umls:C0948008 148/46589 2.867870e-51 1.950151e-49 ## umls:C0038454 243/46589 7.045680e-12 3.194042e-10 ## umls:C0027051 163/46589 6.222154e-11 1.889883e-09 ## umls:C0010054 166/46589 6.948100e-11 1.889883e-09 ## umls:C0010068 314/46589 3.198889e-09 7.250815e-08 ## qvalue ## umls:C3272363 1.922217e-50 ## umls:C0948008 2.716929e-50 ## umls:C0038454 4.449903e-11 ## umls:C0027051 2.632964e-10 ## umls:C0010054 2.632964e-10 ## umls:C0010068 1.010175e-08 ## geneID ## umls:C3272363 rs1401296/rs9315050/rs5498/rs1524668/rs147377392/rs841/rs909253/rs7193343/rs3918232/rs3760396/rs2231137/rs10947803/rs17222919/rs386602276/rs11053646/rs1805192/rs139564723/rs2230806/rs20417/rs966221 ## umls:C0948008 rs1401296/rs9315050/rs5498/rs1524668/rs147377392/rs841/rs909253/rs7193343/rs3918232/rs3760396/rs2231137/rs10947803/rs17222919/rs386602276/rs11053646/rs1805192/rs139564723/rs2230806/rs20417/rs966221 ## umls:C0038454 rs1524668/rs147377392/rs2231137/rs10947803/rs386602276/rs2230806/rs20417 ## umls:C0027051 rs5498/rs147377392/rs909253/rs11053646/rs1805192/rs20417 ## umls:C0010054 rs5498/rs147377392/rs11053646/rs1805192/rs2230806/rs20417 ## umls:C0010068 rs5498/rs147377392/rs11053646/rs1805192/rs2230806/rs20417 ## Count ## umls:C3272363 20 ## umls:C0948008 20 ## umls:C0038454 7 ## umls:C0027051 6 ## umls:C0010054 6 ## umls:C0010068 6 4.4 gseDO fuction In the following example, in order to speedup the compilation of this document, only gene sets with size above 120 were tested and only 100 permutations were performed. library(DOSE) data(geneList) y &lt;- gseDO(geneList, nPerm = 100, minGSSize = 120, pvalueCutoff = 0.2, pAdjustMethod = &quot;BH&quot;, verbose = FALSE) head(y, 3) ## ID Description setSize ## DOID:5679 DOID:5679 retinal disease 299 ## DOID:654 DOID:654 overnutrition 298 ## DOID:8466 DOID:8466 retinal degeneration 216 ## enrichmentScore NES pvalue p.adjust ## DOID:5679 -0.3676313 -1.555515 0.01219512 0.08038914 ## DOID:654 -0.3490198 -1.477495 0.01219512 0.08038914 ## DOID:8466 -0.3467372 -1.465667 0.01219512 0.08038914 ## qvalues rank leading_edge ## DOID:5679 0.03449484 1768 tags=24%, list=14%, signal=21% ## DOID:654 0.03449484 1464 tags=21%, list=12%, signal=19% ## DOID:8466 0.03449484 1465 tags=21%, list=12%, signal=19% ## core_enrichment ## DOID:5679 2878/3791/23247/80184/6750/7450/596/9187/2034/482/948/1490/1280/5737/4314/4881/3426/187/629/6403/6785/2934/5176/7078/5950/727/10516/4311/2247/1295/358/10203/582/10218/57125/585/1675/6310/2202/4313/2944/4254/3075/2099/3480/4653/6387/1471/857/4016/1909/4053/6678/1296/4915/55812/1191/5654/10631/2697/2952/6935/2200/3479/2006/10451/9370/771/652/4693/5346/1524 ## DOID:654 2169/1490/7840/4887/4314/595/4018/6403/590/3087/866/66036/5919/5176/3953/5950/2638/2166/5243/5468/4023/3485/7350/3952/1149/585/1513/3489/79068/4671/477/4313/3625/9369/6720/7494/2099/3480/3991/6678/4915/5167/8228/165/2152/185/367/4982/3667/4128/9607/3572/150/563/1489/3479/9370/9122/5105/2167/5346/79689/5241 ## DOID:8466 948/5737/4314/4881/3426/629/6403/6785/2934/5176/7078/727/10516/1295/358/10203/582/10218/585/1675/2202/2944/3075/2099/4653/1471/857/4016/1909/4053/6678/1296/4915/1191/5654/2697/2952/6935/2200/2006/10451/771/652/1524 4.5 gseNCG fuction ncg &lt;- gseNCG(geneList, nPerm = 100, minGSSize = 120, pvalueCutoff = 0.2, pAdjustMethod = &quot;BH&quot;, verbose = FALSE) ncg &lt;- setReadable(ncg, &#39;org.Hs.eg.db&#39;) head(ncg, 3) ## ID Description setSize enrichmentScore ## breast breast breast 133 -0.4869070 ## lung lung lung 173 -0.3880662 ## lymphoma lymphoma lymphoma 188 0.2999589 ## NES pvalue p.adjust qvalues rank ## breast -1.893048 0.01369863 0.04166667 0.02192982 2930 ## lung -1.541319 0.01388889 0.04166667 0.02192982 2775 ## lymphoma 1.388834 0.03703704 0.07407407 0.03898635 2087 ## leading_edge ## breast tags=33%, list=23%, signal=26% ## lung tags=31%, list=22%, signal=25% ## lymphoma tags=21%, list=17%, signal=18% ## core_enrichment ## breast KMT2A/ERBB3/SETD2/ARID1A/GPS2/NCOR1/RB1/MAP2K4/NF1/TP53/PIK3R1/STK11/CDKN1B/PTGFR/APC/CCND1/TRAF5/MAP3K1/ESR1/TBX3/FOXA1/GATA3 ## lung SETD2/ATXN3L/LRP1B/BRD3/ARID1A/INHBA/RB1/ADCY1/LYRM9/NF1/CTNNB1/TP53/SATB2/STK11/CTIF/CTNNA3/KDR/COL11A1/FLT3/APC/ADGRL3/FGFR3/NCAM2/DIP2C/APLNR/SLIT2/EPHA3/RUNX1T1/ZMYND10/ZFHX4/GLI3/TNN/PLSCR4/DACH1/ERBB4 ## lymphoma DUSP2/EZH2/PRDM1/MYC/ZWILCH/IKZF3/PLCG2/IDH2/HIST1H1C/MAGEC3/CD79B/ETV6/HIST1H1E/HIST1H1B/IRF8/CD28/SLC29A2/DUSP9/TNFAIP3/DNMT3A/SYK/TNF/BCR/HIST1H1D/DSC3/UBE2A/PABPC1 4.6 gseDGN fuction dgn &lt;- gseDGN(geneList, nPerm = 100, minGSSize = 120, pvalueCutoff = 0.2, pAdjustMethod = &quot;BH&quot;, verbose = FALSE) dgn &lt;- setReadable(dgn, &#39;org.Hs.eg.db&#39;) head(dgn, 3) ## ID Description setSize ## umls:C0011581 umls:C0011581 Depressive disorder 464 ## umls:C0011570 umls:C0011570 Mental Depression 483 ## umls:C0151744 umls:C0151744 Myocardial Ischemia 418 ## enrichmentScore NES pvalue ## umls:C0011581 -0.2963136 -1.325750 0.01149425 ## umls:C0011570 -0.2874181 -1.296230 0.01162791 ## umls:C0151744 -0.3013524 -1.349414 0.01162791 ## p.adjust qvalues rank ## umls:C0011581 0.1143293 0.0724754 2587 ## umls:C0011570 0.1143293 0.0724754 2587 ## umls:C0151744 0.1143293 0.0724754 2309 ## leading_edge ## umls:C0011581 tags=29%, list=21%, signal=24% ## umls:C0011570 tags=25%, list=21%, signal=20% ## umls:C0151744 tags=26%, list=18%, signal=22% ## core_enrichment ## umls:C0011581 ATM/TRH/CYP2E1/IFNAR1/TTR/CALD1/BCL2L1/CRH/SUCLA2/CNR1/MTR/ARNTL/PER1/GDE1/SLC29A3/FOSB/TH/HTR7/SMPD1/ETS2/HDAC5/RGN/GRIA1/PTGS1/PDE4A/SNCA/ADAMTS2/EHD3/NR5A1/SORCS3/CRY1/ADRB2/FZD1/MYOM2/ADCY1/POU6F1/MAPK3/BICC1/SLC6A4/AHI1/TP53/RNF103/SLC12A2/BDNF/NR3C1/SRSF5/PCLO/GABRA6/WWC1/IL5/GLUL/ELK3/GAD1/RARA/GRM5/KDR/ASAH1/IMPACT/CHRM2/WFS1/TSPAN31/HP/PVALB/HTR1A/BCL2/GPM6A/CYP2A6/DUSP1/NLGN4Y/F2R/CD36/NGFR/NPY2R/DBH/BECN1/CCND1/OXTR/SGCE/SELP/NGF/LPAR1/NRP1/AVPR1B/IFT88/ARSD/FAAH/NEFL/FGF2/CD1C/ABCB1/SRPX/RAPGEF3/CRHBP/HSPA2/LEP/FTO/PER2/ALPK1/GSTM1/DIXDC1/XBP1/ESR1/IGF1R/NTF3/CACNA1C/NR3C2/SLC18A2/NTRK2/SPDEF/RAPGEF4/ALB/NPY1R/F3/AGTR1/TAC1/AR/UCN/FBN1/MAOA/CARTPT/TAT/ADRA2A/MUC1/TGFBR3/TPH1/IGF1/ABAT/MAOB/ADIPOQ/TBC1D9/ADH1B/CRY2/GATA3/TFAP2B ## umls:C0011570 ETS2/RGN/GRIA1/PTGS1/NLGN1/PDE4A/ADAMTS2/EHD3/NR5A1/SORCS3/A2M/KCNQ1/CRY1/ADRB2/FZD1/MYOM2/ADCY1/POU6F1/MAPK3/BICC1/SLC6A4/AHI1/TP53/DBP/SLC12A2/BDNF/NR3C1/SRSF5/PCLO/GABRA6/WWC1/IL5/GLUL/ELK3/GAD1/RARA/GRM5/ASAH1/IMPACT/CHRM2/WFS1/TSPAN31/ARGLU1/HP/PVALB/HTR1A/GPM6A/CYP2A6/DUSP1/NLGN4Y/F2R/CD36/DBH/BECN1/CCND1/PER3/OXTR/SGCE/CFB/CLASP2/LPAR1/NRP1/AVPR1B/ARSD/GC/FAAH/BHLHE41/FGF2/CD1C/ABCB1/PPARG/SRPX/RAPGEF3/CRHBP/CDH13/HSPA2/BHLHE40/PDE1A/LEP/FTO/PER2/ALPK1/GSTM1/DIXDC1/XBP1/TCF4/ESR1/IGF1R/NTF3/CACNA1C/NR3C2/SLC18A2/NTRK2/RAPGEF4/F3/AGTR1/TAC1/GSTT1/AR/UCN/FBN1/MAOA/CARTPT/TAT/ADRA2A/MUC1/TGFBR3/TPH1/IGF1/MAOB/ADIPOQ/TBC1D9/ADH1B/EMX2/MAPT/CRY2/GATA3/TFAP2B ## umls:C0151744 ADRB2/HSPB1/ABCC6/ADD1/PECAM1/MAPK3/GRK5/VEGFC/AMPD1/TLE5/F7/HSPB2/ENTPD1/ID3/PRKAA2/ATP2B1/SOD3/PRKAB1/AMH/STAT6/RGCC/RXRG/GDF10/SLC9A1/HGF/SERPINA3/MBL2/KDR/EGR1/HSPB6/HBB/STAT5A/EEF1A2/VWF/BCL2/CD34/DUSP1/PRKG1/CD36/CCN2/MMP3/BECN1/NPR1/CCND1/GATM/LPA/EDIL3/RTN1/APLNR/PYGM/SELP/FGF1/NEDD4/ID1/ALDH6A1/FOXO1/SULT1A1/SNAP23/FGF2/DUSP6/ABCB1/PPARG/PDK4/SHH/HSPA2/BHLHE40/LPL/THBD/COL5A2/UGCG/KL/ADH1C/GSTM2/THBS2/PER2/ATXN1/MMP2/TXNIP/KITLG/CFH/ESR1/CXCL12/CIRBP/EDNRA/GHR/SPARC/GPD1L/ENPP1/ALB/F13A1/MEOX2/F3/AGTR1/ZEB1/TNFRSF11B/UCN/DCN/LTC4S/IL6ST/EPHX2/THBS4/IGF1/FXYD1/SFRP4/ELN/RAMP2/ADIPOQ/ADH1B/HMGCS2 References "],
["chapter5.html", "Chapter 5 Gene Ontology Analysis 5.1 Supported organisms 5.2 GO classification 5.3 GO over-representation test 5.4 GO Gene Set Enrichment Analysis 5.5 GO Semantic Similarity Analysis", " Chapter 5 Gene Ontology Analysis 5.1 Supported organisms GO analyses (groupGO(), enrichGO() and gseGO()) support organisms that have an OrgDb object available. Bioconductor have already provide OrgDb for about 20 species. User can query OrgDb online by AnnotationHub or build their own by AnnotationForge. An example can be found in the vignette of GOSemSim. If user have GO annotation data (in data.frame format with first column of gene ID and second column of GO ID), they can use enricher() and gseGO() functions to perform over-representation test and gene set enrichment analysis. If genes are annotated by direction annotation, it should also annotated by its ancestor GO nodes (indirect annation). If user only has direct annotation, they can pass their annotation to buildGOmap function, which will infer indirection annotation and generate a data.frame that suitable for both enricher() and gseGO(). 5.2 GO classification In clusterProfiler, groupGO is designed for gene classification based on GO distribution at a specific level. Here we use dataset geneList provided by DOSE. Please refer to vignette of DOSE for more details. library(clusterProfiler) data(geneList, package=&quot;DOSE&quot;) gene &lt;- names(geneList)[abs(geneList) &gt; 2] gene.df &lt;- bitr(gene, fromType = &quot;ENTREZID&quot;, toType = c(&quot;ENSEMBL&quot;, &quot;SYMBOL&quot;), OrgDb = org.Hs.eg.db) head(gene.df) ## ENTREZID ENSEMBL SYMBOL ## 1 4312 ENSG00000196611 MMP1 ## 2 8318 ENSG00000093009 CDC45 ## 3 10874 ENSG00000109255 NMU ## 4 55143 ENSG00000134690 CDCA8 ## 5 55388 ENSG00000065328 MCM10 ## 6 991 ENSG00000117399 CDC20 ggo &lt;- groupGO(gene = gene, OrgDb = org.Hs.eg.db, ont = &quot;CC&quot;, level = 3, readable = TRUE) head(ggo) ## ID Description Count ## GO:0005886 GO:0005886 plasma membrane 52 ## GO:0005628 GO:0005628 prospore membrane 0 ## GO:0005789 GO:0005789 endoplasmic reticulum membrane 8 ## GO:0019867 GO:0019867 outer membrane 2 ## GO:0031090 GO:0031090 organelle membrane 13 ## GO:0034357 GO:0034357 photosynthetic membrane 0 ## GeneRatio ## GO:0005886 52/207 ## GO:0005628 0/207 ## GO:0005789 8/207 ## GO:0019867 2/207 ## GO:0031090 13/207 ## GO:0034357 0/207 ## geneID ## GO:0005886 S100A9/MELK/S100A8/MARCO/ASPM/CXCL10/LAMP3/CEP55/UGT8/UBE2C/SLC7A5/CXCL9/FADS2/MSLN/IL1R2/KIF18A/S100P/GZMB/TRAT1/GABRP/AQP9/GPR19/SLC2A6/KIF20A/LAG3/NUDT1/CACNA1D/VSTM4/CORIN/KCNK15/CA12/KCNE4/HLA-DQA1/ADH1B/PDZK1/C7/ACKR1/COL17A1/PSD3/EMCN/SLC44A4/LRP2/NLGN4X/MAPT/ERBB4/CX3CR1/LAMP5/ABCA8/STEAP4/PTPRT/TMC5/CYBRD1 ## GO:0005628 ## GO:0005789 FADS2/CDK1/CHODL/ITPR1/HLA-DQA1/CYP4F8/CYP4B1/FMO5 ## GO:0019867 MAOB/PGR ## GO:0031090 MARCO/LAMP3/DUSP2/DTL/NUDT1/MAOB/ITPR1/GASK1B/HLA-DQA1/LRP2/LAMP5/STEAP4/PGR ## GO:0034357 The input parameters of gene is a vector of gene IDs (can be any ID type that supported by corresponding OrgDb). If readable is setting to TRUE, the input gene IDs will be converted to gene symbols. 5.3 GO over-representation test Over-representation test(Boyle et al. 2004) were implemented in clusterProfiler. For calculation details and explanation of paramters, please refer to the vignette of DOSE. ego &lt;- enrichGO(gene = gene, universe = names(geneList), OrgDb = org.Hs.eg.db, ont = &quot;CC&quot;, pAdjustMethod = &quot;BH&quot;, pvalueCutoff = 0.01, qvalueCutoff = 0.05, readable = TRUE) head(ego) ## ID ## GO:0000779 GO:0000779 ## GO:0000776 GO:0000776 ## GO:0000775 GO:0000775 ## GO:0000793 GO:0000793 ## GO:0005819 GO:0005819 ## GO:0098687 GO:0098687 ## Description ## GO:0000779 condensed chromosome, centromeric region ## GO:0000776 kinetochore ## GO:0000775 chromosome, centromeric region ## GO:0000793 condensed chromosome ## GO:0005819 spindle ## GO:0098687 chromosomal region ## GeneRatio BgRatio pvalue p.adjust ## GO:0000779 14/197 85/11434 1.662431e-10 3.802012e-08 ## GO:0000776 15/197 104/11434 2.551686e-10 3.802012e-08 ## GO:0000775 17/197 147/11434 5.495085e-10 5.458451e-08 ## GO:0000793 17/197 154/11434 1.141189e-09 8.501857e-08 ## GO:0005819 21/197 256/11434 2.923725e-09 1.742540e-07 ## GO:0098687 21/197 265/11434 5.435150e-09 2.699458e-07 ## qvalue ## GO:0000779 3.572360e-08 ## GO:0000776 3.572360e-08 ## GO:0000775 5.128746e-08 ## GO:0000793 7.988322e-08 ## GO:0005819 1.637286e-07 ## GO:0098687 2.536403e-07 ## geneID ## GO:0000779 CENPE/NDC80/HJURP/SKA1/NEK2/CENPM/CENPN/ERCC6L/MAD2L1/CDT1/BIRC5/NCAPG/AURKB/CCNB1 ## GO:0000776 CENPE/NDC80/HJURP/SKA1/NEK2/CENPM/CENPN/ERCC6L/MAD2L1/KIF18A/CDT1/BIRC5/TTK/AURKB/CCNB1 ## GO:0000775 CDCA8/CENPE/NDC80/HJURP/SKA1/NEK2/CENPM/CENPN/ERCC6L/MAD2L1/KIF18A/CDT1/BIRC5/TTK/NCAPG/AURKB/CCNB1 ## GO:0000793 CENPE/NDC80/TOP2A/NCAPH/HJURP/SKA1/NEK2/CENPM/CENPN/ERCC6L/MAD2L1/CDT1/BIRC5/NCAPG/AURKB/CHEK1/CCNB1 ## GO:0005819 CDC20/KIF23/CENPE/ASPM/DLGAP5/SKA1/TPX2/TACC3/NEK2/CDK1/MAD2L1/KIF18A/KIF11/TTK/AURKB/PRC1/KIF18B/KIF20A/AURKA/CCNB1/KIF4A ## GO:0098687 CDCA8/CENPE/NDC80/HJURP/SKA1/NEK2/CENPM/CENPN/CDK1/ERCC6L/MAD2L1/KIF18A/CDT1/BIRC5/EZH2/TTK/NCAPG/AURKB/CHEK1/CCNB1/MCM5 ## Count ## GO:0000779 14 ## GO:0000776 15 ## GO:0000775 17 ## GO:0000793 17 ## GO:0005819 21 ## GO:0098687 21 As I mentioned before, any gene ID type that supported in OrgDb can be directly used in GO analyses. User need to specify the keyType parameter to specify the input gene ID type. ego2 &lt;- enrichGO(gene = gene.df$ENSEMBL, OrgDb = org.Hs.eg.db, keyType = &#39;ENSEMBL&#39;, ont = &quot;CC&quot;, pAdjustMethod = &quot;BH&quot;, pvalueCutoff = 0.01, qvalueCutoff = 0.05) Gene ID can be mapped to gene Symbol by using paramter readable=TRUE or setReadable function. ego2 &lt;- setReadable(ego2, OrgDb = org.Hs.eg.db) 5.3.1 drop specific GO terms or level enrichGO test the whole GO corpus and enriched result may contains very general terms. With dropGO function, user can remove specific GO terms or GO level from results obtained from both enrichGO and compareCluster. 5.3.2 test GO at sepcific level enrichGO doesn’t contain parameter to restrict the test at specific GO level. Instead, we provide a function gofilter to restrict the result at specific GO level. It works with results obtained from both enrichGO and compareCluster. 5.3.3 reduce redundancy of enriched GO terms GO is organized in parent-child structure, thus a parent term can be overlap with a large proportion with all its child terms. This can result in redundant findings. To solve this issue, clusterProfiler implement simplify method to reduce redundant GO terms from the outputs of enrichGO and gseGO. The function internally called GOSemSim (Yu et al. 2010) to calculate semantic similarity among GO terms and remove those highly similar terms by keeping one representative term. An example can be found in the blog post. 5.4 GO Gene Set Enrichment Analysis A common approach in analyzing gene expression profiles was identifying differential expressed genes that are deemed interesting. The enrichment analysis we demonstrated previous were based on these differential expressed genes. This approach will find genes where the difference is large, but it will not detect a situation where the difference is small, but evidenced in coordinated way in a set of related genes. Gene Set Enrichment Analysis (GSEA)(Subramanian et al. 2005) directly addresses this limitation. All genes can be used in GSEA; GSEA aggregates the per gene statistics across genes within a gene set, therefore making it possible to detect situations where all genes in a predefined set change in a small but coordinated way. Since it is likely that many relevant phenotypic differences are manifested by small but consistent changes in a set of genes. For algorithm details, please refer to the vignette of DOSE. ego3 &lt;- gseGO(geneList = geneList, OrgDb = org.Hs.eg.db, ont = &quot;CC&quot;, nPerm = 1000, minGSSize = 100, maxGSSize = 500, pvalueCutoff = 0.05, verbose = FALSE) GSEA use permutation test, user can set nPerm for number of permutations. Only gene Set size in [minGSSize, maxGSSize] will be tested. If you have issues in preparing your own geneList, please refer to the wiki page. 5.5 GO Semantic Similarity Analysis GO semantic similarity can be calculated by GOSemSim(Yu et al. 2010). We can use it to cluster genes/proteins into different clusters based on their functional similarity and can also use it to measure the similarities among GO terms to reduce the redundancy of GO enrichment results. 5.5.1 GO analysis for non-model organisms Both enrichGO and gseGO functions require an OrgDb object as background annotation. For organisms that don’t have OrgDb provided by Bioconductor, users can query one (if available) online via AnnotationHub. If there is no OrgDb available, users can obtain GO annotation from other sources, e.g. from biomaRt or Blast2GO. Then using enricher or GSEA function to analyze, similar to the examples using wikiPathways and MSigDB. Another solution is to create OrgDb by your own using AnnotationForge package. References "],
["chapter6.html", "Chapter 6 KEGG analysis 6.1 KEGG over-representation test 6.2 KEGG Gene Set Enrichment Analysis 6.3 KEGG Module over-representation test 6.4 KEGG Module Gene Set Enrichment Analysis", " Chapter 6 KEGG analysis The annotation package, KEGG.db, is not updated since 2012. It’s now pretty old and in clusterProfiler, enrichKEGG (for KEGG pathway) and enrichMKEGG (for KEGG module) supports downloading latest online version of KEGG data for enrichment analysis. Using KEGG.db is also supported by explicitly setting use_internal_data parameter to TRUE, but it’s not recommended. With this new feature, organism is not restricted to those supported in previous release, it can be any species that have KEGG annotation data available in KEGG database. User should pass abbreviation of academic name to the organism parameter. The full list of KEGG supported organisms can be accessed via http://www.genome.jp/kegg/catalog/org_list.html. KEGG Orthology (KO) Database is also supported by specifying organism = &quot;ko&quot;. clusterProfiler provides search_kegg_organism() function to help searching supported organisms. library(clusterProfiler) search_kegg_organism(&#39;ece&#39;, by=&#39;kegg_code&#39;) ## kegg_code scientific_name ## 366 ece Escherichia coli O157:H7 EDL933 (EHEC) ## common_name ## 366 &lt;NA&gt; ecoli &lt;- search_kegg_organism(&#39;Escherichia coli&#39;, by=&#39;scientific_name&#39;) dim(ecoli) ## [1] 65 3 head(ecoli) ## kegg_code scientific_name ## 361 eco Escherichia coli K-12 MG1655 ## 362 ecj Escherichia coli K-12 W3110 ## 363 ecd Escherichia coli K-12 DH10B ## 364 ebw Escherichia coli BW2952 ## 365 ecok Escherichia coli K-12 MDS42 ## 366 ece Escherichia coli O157:H7 EDL933 (EHEC) ## common_name ## 361 &lt;NA&gt; ## 362 &lt;NA&gt; ## 363 &lt;NA&gt; ## 364 &lt;NA&gt; ## 365 &lt;NA&gt; ## 366 &lt;NA&gt; 6.1 KEGG over-representation test data(geneList, package=&quot;DOSE&quot;) gene &lt;- names(geneList)[abs(geneList) &gt; 2] kk &lt;- enrichKEGG(gene = gene, organism = &#39;hsa&#39;, pvalueCutoff = 0.05) head(kk) ## ID Description ## hsa04110 hsa04110 Cell cycle ## hsa04114 hsa04114 Oocyte meiosis ## hsa04218 hsa04218 Cellular senescence ## hsa03320 hsa03320 PPAR signaling pathway ## hsa04914 hsa04914 Progesterone-mediated oocyte maturation ## hsa04115 hsa04115 p53 signaling pathway ## GeneRatio BgRatio pvalue p.adjust ## hsa04110 11/93 124/7856 1.979335e-07 3.820117e-05 ## hsa04114 10/93 125/7856 1.918748e-06 1.851592e-04 ## hsa04218 10/93 160/7856 1.752068e-05 1.127164e-03 ## hsa03320 7/93 74/7856 2.449069e-05 1.181676e-03 ## hsa04914 7/93 99/7856 1.594018e-04 6.152911e-03 ## hsa04115 5/93 72/7856 1.562676e-03 4.902654e-02 ## qvalue ## hsa04110 3.750319e-05 ## hsa04114 1.817761e-04 ## hsa04218 1.106569e-03 ## hsa03320 1.160086e-03 ## hsa04914 6.040491e-03 ## hsa04115 4.813078e-02 ## geneID ## hsa04110 8318/991/9133/890/983/4085/7272/1111/891/4174/9232 ## hsa04114 991/9133/983/4085/51806/6790/891/9232/3708/5241 ## hsa04218 2305/4605/9133/890/983/51806/1111/891/776/3708 ## hsa03320 4312/9415/9370/5105/2167/3158/5346 ## hsa04914 9133/890/983/4085/6790/891/5241 ## hsa04115 9133/6241/983/1111/891 ## Count ## hsa04110 11 ## hsa04114 10 ## hsa04218 10 ## hsa03320 7 ## hsa04914 7 ## hsa04115 5 Input ID type can be kegg, ncbi-geneid, ncbi-proteinid or uniprot, an example can be found in the post. 6.2 KEGG Gene Set Enrichment Analysis kk2 &lt;- gseKEGG(geneList = geneList, organism = &#39;hsa&#39;, nPerm = 1000, minGSSize = 120, pvalueCutoff = 0.05, verbose = FALSE) head(kk2) ## ID Description setSize ## hsa04151 hsa04151 PI3K-Akt signaling pathway 322 ## hsa04510 hsa04510 Focal adhesion 188 ## hsa04218 hsa04218 Cellular senescence 143 ## hsa03013 hsa03013 RNA transport 131 ## hsa05203 hsa05203 Viral carcinogenesis 164 ## hsa05152 hsa05152 Tuberculosis 162 ## enrichmentScore NES pvalue p.adjust ## hsa04151 -0.3482755 -1.502526 0.001308901 0.01962067 ## hsa04510 -0.4188582 -1.709298 0.001440922 0.01962067 ## hsa04218 0.4153718 1.784930 0.002958580 0.01962067 ## hsa03013 0.4116488 1.730304 0.003012048 0.01962067 ## hsa05203 0.3523856 1.538780 0.003095975 0.01962067 ## hsa05152 0.3745153 1.629560 0.003134796 0.01962067 ## qvalues rank leading_edge ## hsa04151 0.01308044 1997 tags=23%, list=16%, signal=20% ## hsa04510 0.01308044 2183 tags=27%, list=17%, signal=23% ## hsa04218 0.01308044 1155 tags=17%, list=9%, signal=16% ## hsa03013 0.01308044 3383 tags=40%, list=27%, signal=29% ## hsa05203 0.01308044 3112 tags=35%, list=25%, signal=26% ## hsa05152 0.01308044 2823 tags=34%, list=23%, signal=27% ## core_enrichment ## hsa04151 2252/7059/92579/5563/5295/6794/1288/7010/3910/3371/3082/1291/4602/3791/1027/90993/3441/3643/1129/2322/1975/7450/596/3685/1942/2149/1280/4804/3675/595/2261/7248/2246/4803/3912/1902/1278/1277/2846/2057/1293/2247/55970/5618/7058/10161/56034/3693/4254/3480/4908/5159/1292/3908/2690/3909/8817/9223/4915/3551/2791/63923/3913/9863/3667/1287/3679/7060/3479/80310/1311/5105/2066/1101 ## hsa04510 5228/7424/1499/4636/83660/7059/5295/1288/23396/3910/3371/3082/1291/394/3791/7450/596/3685/1280/3675/595/2318/3912/1793/1278/1277/1293/10398/55742/2317/7058/25759/56034/3693/3480/5159/857/1292/3908/3909/63923/3913/1287/3679/7060/3479/10451/80310/1311/1101 ## hsa04218 2305/4605/9133/890/983/51806/1111/891/993/3576/1978/898/9134/4609/1869/1029/22808/3804/1871/5499/91860/292/1019/11200/1875 ## hsa03013 10460/1978/55110/54913/9688/8894/11260/10799/9631/4116/5042/8761/6396/23165/8662/10248/55706/79833/9775/29107/23636/5905/9513/5901/10775/10557/4927/79902/1981/26986/11171/10762/8480/8891/11097/26019/10940/4686/9972/81929/10556/3646/9470/387082/1977/57122/8563/7514/79023/3837/9818/56000 ## hsa05203 991/890/983/1111/898/9134/6502/85236/1237/1029/8970/4067/2957/5902/55697/3066/578/1019/1234/8345/7534/5315/3018/468/6850/1030/4055/7186/1959/3135/5933/5610/1642/5594/9734/4792/5567/3134/23352/7185/10379/5366/4893/1232/2960/23513/9114/2958/10971/7533/9519/5568/836/1233/6714/3106/8379 ## hsa05152 820/51806/6772/64581/3126/3112/8767/3654/1054/1051/3458/1520/11151/1594/50617/54205/91860/8877/3329/637/3689/7096/2207/3929/4360/5603/929/533/3452/6850/7124/1509/3569/7097/1378/8772/64170/3119/843/2213/8625/3920/2215/3587/5594/3593/9103/3592/6300/9114/10333/3109/3108/1432/3552 6.3 KEGG Module over-representation test KEGG Module is a collection of manually defined function units. In some situation, KEGG Modules have a more straightforward interpretation. mkk &lt;- enrichMKEGG(gene = gene, organism = &#39;hsa&#39;) 6.4 KEGG Module Gene Set Enrichment Analysis mkk2 &lt;- gseMKEGG(geneList = geneList, species = &#39;hsa&#39;) "],
["chapter7.html", "Chapter 7 MSigDb analysis", " Chapter 7 MSigDb analysis The MSigDB is a collection of annotated gene sets, it include 8 major collections: H: hallmark gene sets C1: positional gene sets C2: curated gene sets C3: motif gene sets C4: computational gene sets C5: GO gene sets C6: oncogenic signatures C7: immunologic signatures Users can use enricher and GSEA function to analyze gene set collections downloaded from Molecular Signatures Database (MSigDb). clusterProfiler provides a function, read.gmt, to parse the gmt file into a TERM2GENE data.frame that is ready for both enricher and GSEA functions. data(geneList, package=&quot;DOSE&quot;) gene &lt;- names(geneList)[abs(geneList) &gt; 2] gmtfile &lt;- system.file(&quot;extdata&quot;, &quot;c5.cc.v5.0.entrez.gmt&quot;, package=&quot;clusterProfiler&quot;) c5 &lt;- read.gmt(gmtfile) egmt &lt;- enricher(gene, TERM2GENE=c5) head(egmt) ## ID ## SPINDLE SPINDLE ## MICROTUBULE_CYTOSKELETON MICROTUBULE_CYTOSKELETON ## CYTOSKELETAL_PART CYTOSKELETAL_PART ## SPINDLE_MICROTUBULE SPINDLE_MICROTUBULE ## MICROTUBULE MICROTUBULE ## CYTOSKELETON CYTOSKELETON ## Description GeneRatio ## SPINDLE SPINDLE 11/82 ## MICROTUBULE_CYTOSKELETON MICROTUBULE_CYTOSKELETON 16/82 ## CYTOSKELETAL_PART CYTOSKELETAL_PART 15/82 ## SPINDLE_MICROTUBULE SPINDLE_MICROTUBULE 5/82 ## MICROTUBULE MICROTUBULE 6/82 ## CYTOSKELETON CYTOSKELETON 16/82 ## BgRatio pvalue p.adjust ## SPINDLE 39/5270 7.667674e-12 5.214018e-10 ## MICROTUBULE_CYTOSKELETON 152/5270 8.449298e-10 2.872761e-08 ## CYTOSKELETAL_PART 235/5270 2.414879e-06 5.237096e-05 ## SPINDLE_MICROTUBULE 16/5270 3.080645e-06 5.237096e-05 ## MICROTUBULE 32/5270 7.740446e-06 1.052701e-04 ## CYTOSKELETON 367/5270 1.308357e-04 1.482805e-03 ## qvalue ## SPINDLE 4.197043e-10 ## MICROTUBULE_CYTOSKELETON 2.312439e-08 ## CYTOSKELETAL_PART 4.215619e-05 ## SPINDLE_MICROTUBULE 4.215619e-05 ## MICROTUBULE 8.473751e-05 ## CYTOSKELETON 1.193589e-03 ## geneID ## SPINDLE 991/9493/9787/22974/983/332/3832/7272/9055/6790/24137 ## MICROTUBULE_CYTOSKELETON 991/9493/9133/7153/9787/22974/4751/983/332/3832/7272/9055/6790/24137/4137/7802 ## CYTOSKELETAL_PART 991/9493/7153/9787/22974/4751/983/332/3832/7272/9055/6790/24137/4137/7802 ## SPINDLE_MICROTUBULE 983/332/3832/9055/24137 ## MICROTUBULE 983/332/3832/9055/24137/4137 ## CYTOSKELETON 991/9493/9133/7153/9787/22974/4751/983/332/3832/7272/9055/6790/24137/4137/7802 ## Count ## SPINDLE 11 ## MICROTUBULE_CYTOSKELETON 16 ## CYTOSKELETAL_PART 15 ## SPINDLE_MICROTUBULE 5 ## MICROTUBULE 6 ## CYTOSKELETON 16 egmt2 &lt;- GSEA(geneList, TERM2GENE=c5, verbose=FALSE) head(egmt2) ## ID ## EXTRACELLULAR_REGION EXTRACELLULAR_REGION ## EXTRACELLULAR_REGION_PART EXTRACELLULAR_REGION_PART ## EXTRACELLULAR_MATRIX EXTRACELLULAR_MATRIX ## PROTEINACEOUS_EXTRACELLULAR_MATRIX PROTEINACEOUS_EXTRACELLULAR_MATRIX ## CELL_PROJECTION CELL_PROJECTION ## EXTRACELLULAR_MATRIX_PART EXTRACELLULAR_MATRIX_PART ## Description ## EXTRACELLULAR_REGION EXTRACELLULAR_REGION ## EXTRACELLULAR_REGION_PART EXTRACELLULAR_REGION_PART ## EXTRACELLULAR_MATRIX EXTRACELLULAR_MATRIX ## PROTEINACEOUS_EXTRACELLULAR_MATRIX PROTEINACEOUS_EXTRACELLULAR_MATRIX ## CELL_PROJECTION CELL_PROJECTION ## EXTRACELLULAR_MATRIX_PART EXTRACELLULAR_MATRIX_PART ## setSize enrichmentScore ## EXTRACELLULAR_REGION 401 -0.3860230 ## EXTRACELLULAR_REGION_PART 310 -0.4101043 ## EXTRACELLULAR_MATRIX 95 -0.6229461 ## PROTEINACEOUS_EXTRACELLULAR_MATRIX 93 -0.6355317 ## CELL_PROJECTION 87 -0.4729701 ## EXTRACELLULAR_MATRIX_PART 54 -0.5908035 ## NES pvalue ## EXTRACELLULAR_REGION -1.676480 0.001236094 ## EXTRACELLULAR_REGION_PART -1.736670 0.001293661 ## EXTRACELLULAR_MATRIX -2.308091 0.001466276 ## PROTEINACEOUS_EXTRACELLULAR_MATRIX -2.345758 0.001474926 ## CELL_PROJECTION -1.722629 0.001501502 ## EXTRACELLULAR_MATRIX_PART -1.980259 0.001557632 ## p.adjust qvalues rank ## EXTRACELLULAR_REGION 0.03018985 0.023916 1797 ## EXTRACELLULAR_REGION_PART 0.03018985 0.023916 1897 ## EXTRACELLULAR_MATRIX 0.03018985 0.023916 1473 ## PROTEINACEOUS_EXTRACELLULAR_MATRIX 0.03018985 0.023916 1473 ## CELL_PROJECTION 0.03018985 0.023916 2280 ## EXTRACELLULAR_MATRIX_PART 0.03018985 0.023916 1794 ## leading_edge ## EXTRACELLULAR_REGION tags=29%, list=14%, signal=26% ## EXTRACELLULAR_REGION_PART tags=32%, list=15%, signal=28% ## EXTRACELLULAR_MATRIX tags=48%, list=12%, signal=43% ## PROTEINACEOUS_EXTRACELLULAR_MATRIX tags=49%, list=12%, signal=44% ## CELL_PROJECTION tags=28%, list=18%, signal=23% ## EXTRACELLULAR_MATRIX_PART tags=59%, list=14%, signal=51% ## core_enrichment ## EXTRACELLULAR_REGION 3910/51162/2878/2717/3373/4153/10406/1301/6750/7474/4925/7450/80781/1490/1306/3931/4314/6586/3964/10272/8425/8082/11005/4256/3483/7482/8910/23037/27122/7042/3912/4322/167/2817/9353/6037/1278/2934/5176/4060/283/30008/5549/5950/22795/727/10516/23452/1293/2247/1295/1012/6469/2192/1281/4023/54360/50509/11167/4319/1290/9365/3952/10879/11096/2202/4313/3625/2199/6444/6320/1294/3075/4653/5764/3991/3263/1462/1289/3908/4016/3909/4053/8817/7033/8292/5125/2162/5744/1842/5654/10631/2331/3730/2487/347/6863/5104/3913/27123/4982/1300/2200/9607/1287/7060/1489/9723/6424/1307/1311/4693/4148/1101/2922/10647 ## EXTRACELLULAR_REGION_PART 268/3567/57124/3910/2878/3373/4153/10406/1301/6750/7474/4925/80781/1490/1306/3931/4314/6586/3964/10272/8425/8082/4256/3483/7482/8910/27122/3912/4322/167/2817/1278/4060/283/30008/5549/5950/22795/727/10516/23452/1293/2247/1295/1012/6469/2192/1281/54360/50509/11167/4319/1290/9365/3952/10879/11096/2202/4313/2199/6444/1294/3075/4653/5764/3991/3263/1462/1289/3908/3909/4053/8817/8292/5125/5744/1842/5654/10631/2331/3730/347/6863/3913/27123/1300/2200/9607/1287/7060/9723/6424/1307/1311/4693/4148/1101/2922/10647 ## EXTRACELLULAR_MATRIX 1490/1306/8425/8082/4256/8910/3912/1278/4060/283/30008/5549/22795/10516/1293/1295/2192/1281/50509/4319/1290/11096/2202/2199/6444/1294/1462/1289/3908/3909/4053/8292/1842/10631/2331/3730/3913/1300/2200/1287/7060/1307/1311/4148/1101 ## PROTEINACEOUS_EXTRACELLULAR_MATRIX 1490/1306/8425/8082/4256/8910/3912/1278/4060/283/30008/5549/22795/10516/1293/1295/2192/1281/50509/4319/1290/11096/2202/2199/6444/1294/1462/1289/3908/3909/4053/8292/1842/10631/2331/3730/3913/1300/2200/1287/7060/1307/1311/4148/1101 ## CELL_PROJECTION 4763/57147/64064/80184/322/54997/7248/5311/7042/323/4747/4744/1012/11346/2191/4741/4646/9576/114327/51466/27124/4137/7802 ## EXTRACELLULAR_MATRIX_PART 3915/6443/55914/3910/1301/80781/1306/8082/8910/3912/1278/4060/283/30008/22795/1293/1295/1281/50509/1290/6444/1294/1289/3908/3909/8292/3913/1300/2200/1287/1307 "],
["chapter8.html", "Chapter 8 Reactome pathway analysis", " Chapter 8 Reactome pathway analysis ReactomePA(Yu and He 2016) uses Reactome as a source of pathway data. The function call of enrichPathway and gsePathway in ReactomePA is consistent with enrichKEGG and gseKEGG. References "],
["chapter9.html", "Chapter 9 MeSH Enrichment Analysis", " Chapter 9 MeSH Enrichment Analysis meshes supports enrichment analysis (over-representation analysis and gene set enrichment analysis) of gene list or whole expression profile using MeSH annotation. Data source from gendoo, gene2pubmed and RBBH are all supported. User can selecte interesting category to test. All 16 categories are supported. The analysis supports &gt;70 species listed in MeSHDb BiocView. For algorithm details, please refer to the vignettes of DOSE(Yu et al. 2015) package. library(meshes) data(geneList, package=&quot;DOSE&quot;) de &lt;- names(geneList)[1:100] x &lt;- enrichMeSH(de, MeSHDb = &quot;MeSH.Hsa.eg.db&quot;, database=&#39;gendoo&#39;, category = &#39;C&#39;) head(x) ## ID Description GeneRatio ## D043171 D043171 Chromosomal Instability 16/96 ## D000782 D000782 Aneuploidy 17/96 ## D042822 D042822 Genomic Instability 16/96 ## D012595 D012595 Scleroderma, Systemic 11/96 ## D009303 D009303 Nasopharyngeal Neoplasms 11/96 ## D019698 D019698 Hepatitis C, Chronic 11/96 ## BgRatio pvalue p.adjust qvalue ## D043171 198/16528 2.794765e-14 2.459394e-11 1.815127e-11 ## D000782 320/16528 3.866830e-12 1.701405e-09 1.255702e-09 ## D042822 312/16528 3.007419e-11 8.821761e-09 6.510798e-09 ## D012595 279/16528 6.449334e-07 1.418854e-04 1.047168e-04 ## D009303 314/16528 2.049315e-06 3.295389e-04 2.432123e-04 ## D019698 317/16528 2.246856e-06 3.295389e-04 2.432123e-04 ## geneID ## D043171 4312/991/2305/1062/4605/10403/7153/55355/4751/4085/81620/332/7272/9212/1111/6790 ## D000782 4312/55143/991/1062/7153/4751/79019/55839/890/983/4085/332/7272/9212/8208/1111/6790 ## D042822 55143/991/1062/4605/7153/1381/9787/4751/10635/890/4085/81620/332/9212/1111/6790 ## D012595 4312/6280/1062/4605/7153/3627/4283/6362/7850/3002/4321 ## D009303 4312/7153/3627/6241/983/4085/5918/332/3002/4321/6790 ## D019698 4312/3627/10563/6373/4283/983/6362/7850/332/3002/3620 ## Count ## D043171 16 ## D000782 17 ## D042822 16 ## D012595 11 ## D009303 11 ## D019698 11 In the over-representation analysis, we use data source from gendoo and C (Diseases) category. In the following example, we use data source from gene2pubmed and test category G (Phenomena and Processes) using GSEA. y &lt;- gseMeSH(geneList, MeSHDb = &quot;MeSH.Hsa.eg.db&quot;, database = &#39;gene2pubmed&#39;, category = &quot;G&quot;) head(y) ## ID Description setSize enrichmentScore ## D009043 D009043 Motor Activity 462 -0.3223426 ## D012038 D012038 Regeneration 425 -0.3214414 ## D009119 D009119 Muscle Contraction 437 -0.3248434 ## D006339 D006339 Heart Rate 336 -0.3640991 ## D049629 D049629 Waist-Hip Ratio 321 -0.3659337 ## D001846 D001846 Bone Development 322 -0.3722690 ## NES pvalue p.adjust qvalues rank ## D009043 -1.448248 0.001201923 0.03354713 0.02470833 2176 ## D012038 -1.435228 0.001209190 0.03354713 0.02470833 2132 ## D009119 -1.453427 0.001210654 0.03354713 0.02470833 2517 ## D006339 -1.592891 0.001272265 0.03354713 0.02470833 2405 ## D049629 -1.591404 0.001293661 0.03354713 0.02470833 2176 ## D001846 -1.619019 0.001295337 0.03354713 0.02470833 2100 ## leading_edge ## D009043 tags=23%, list=17%, signal=20% ## D012038 tags=27%, list=17%, signal=23% ## D009119 tags=27%, list=20%, signal=22% ## D006339 tags=29%, list=19%, signal=24% ## D049629 tags=27%, list=17%, signal=23% ## D001846 tags=27%, list=17%, signal=23% ## core_enrichment ## D009043 10550/9759/23405/1499/6453/8945/7157/25970/627/408/2908/22881/27445/11132/2752/9445/6548/2571/23621/3082/1291/2915/1543/7466/3240/3350/947/55304/181/3632/2169/27306/1621/80169/9627/196/8678/8863/23284/81627/4692/5799/11076/2259/3087/1278/283/1277/3953/4747/2247/6414/210/4744/5468/8835/89795/4023/8522/4319/3485/3952/79068/8864/4313/2944/2273/2099/3480/8528/4908/56892/3339/5138/57161/4741/4306/6571/79750/4915/5744/2487/58503/347/6863/2952/5327/367/4982/4128/4059/3572/150/7060/9358/7166/3479/9254/5348/4129/9370/3708/1311/5105/4137/1408/5241 ## D012038 5087/1499/7157/79960/627/2252/4088/825/9149/8038/4017/7010/2752/3248/3082/22921/3791/4005/182/7402/7474/596/947/9976/9315/8840/1490/54209/1280/4804/4314/324/6019/8425/595/10979/6843/4929/79026/2246/5029/4803/7042/4322/8829/7048/10216/79679/5176/55384/7078/5549/7216/727/10516/2247/6591/56944/210/5468/23345/6469/216/8076/26509/90865/11167/7075/7058/4313/3861/91851/2199/113146/6444/9201/1294/4254/4856/6720/3480/5764/6387/6833/5159/11117/857/1289/3908/4016/6678/7033/23030/7704/174/1191/2737/5744/11098/10631/9429/214/7043/2200/1634/4582/7031/3479/7373/2066/3169/2625 ## D009119 10174/2150/5562/3611/22859/4604/7070/4985/7139/3784/154/1760/3315/9732/72/5595/3092/6416/9759/270/6558/627/953/408/2908/7138/5563/6794/5564/3567/2104/845/3371/6548/831/182/3554/126393/7402/1129/7201/3350/5590/5592/7168/79923/2149/4628/23426/8082/5021/2318/23284/844/79026/4208/3790/2308/1907/253959/54795/4311/2247/10580/1848/2281/10398/5166/50507/1012/6876/10203/83700/11167/2317/3952/3778/1009/5733/10468/3693/6253/9499/7481/5159/3991/857/1289/1909/6678/7041/32/8639/5350/3551/1264/2697/185/55107/7043/3357/2205/253190/5327/25802/1634/3572/8490/3679/3479/5348/9370/9122/4629/652/7021/5241 ## D006339 4985/7139/8929/3784/10681/3375/154/1760/9781/5139/118/2702/6532/6416/2869/270/7157/627/2908/7138/5563/3643/1129/7779/947/1901/2034/4179/4804/64388/1621/4881/8863/5021/844/4212/11030/5797/6403/4803/84059/79789/5176/3953/5243/5468/1012/2868/5793/4023/7056/3952/5577/126/2946/3778/477/5733/4313/2944/9201/3075/9499/2273/2099/1471/857/775/5138/4306/4487/213/5350/5744/23245/2152/2697/2791/185/6863/2952/5327/80206/2200/9607/3572/150/8490/3479/2006/55259/9370/125/652/55351 ## D049629 8609/9563/23405/10206/7157/23314/4776/25970/627/2908/490/4057/268/3567/23429/283450/1543/3240/3174/81490/23047/55304/5099/54808/4179/2169/948/8082/4018/54465/4256/3087/5919/253461/26470/10903/1581/56172/3953/5950/5468/1012/8835/4023/594/4214/7350/3952/79068/51232/2202/6444/9369/2099/6833/3991/4016/2690/57161/79750/4915/5125/5167/8639/11188/10631/3551/2487/2697/6935/3487/367/4982/3667/4059/150/9358/1489/3479/6424/9370/4629/652/5346/7021/4239/5241 ## D001846 8945/7157/57798/79048/627/6500/8038/4057/860/2752/4882/3371/2915/5745/63971/54455/3791/819/57045/596/2034/54808/80781/1280/64388/2261/4054/11059/3483/9900/26234/4734/9452/4208/4322/253461/1278/7048/51280/10903/30008/7869/1277/3953/10516/10411/8835/79776/11167/2317/3485/3952/5274/54681/4488/10486/1009/2202/91851/2099/5764/23327/3339/8817/83716/6678/4915/633/658/54361/5744/165/5654/10631/3487/367/4982/3667/79971/1634/3479/114899/9370/652/8614/4969 User can use visualization methods implemented in enrichplot (i.e.barplot, dotplot, cnetplot, emapplot and gseaplot) to visualize these enrichment results. With these visualization methods, it’s much easier to interpret enriched results. dotplot(x) gseaplot(y, y[1,1], title=y[1,2]) References "],
["chapter10.html", "Chapter 10 Functional enrichment analysis of genomic coordinations", " Chapter 10 Functional enrichment analysis of genomic coordinations Functional analysis using NGS data (eg, RNA-Seq and ChIP-Seq) can be performed by linking coding and non-coding regions to coding genes via ChIPseeker(Yu, Wang, and He 2015) package, which can annotates genomic regions to their nearest genes, host genes, and flanking genes respectivly. In addtion, it provides a function, seq2gene, that simultaneously considering host genes, promoter region and flanking gene from intergenic region that may under control via cis-regulation. This function maps genomic regions to genes in a many-to-many manner and facilitate functional analysis. For more details, please refer to ChIPseeker(Yu, Wang, and He 2015). References "],
["chapter11.html", "Chapter 11 Biological theme comparison 11.1 Formula interface of compareCluster 11.2 Visualization of profile comparison", " Chapter 11 Biological theme comparison clusterProfiler was developed for biological theme comparison(Yu et al. 2012), and it provides a function, compareCluster, to automatically calculate enriched functional categories of each gene clusters. data(gcSample) lapply(gcSample, head) ## $X1 ## [1] &quot;4597&quot; &quot;7111&quot; &quot;5266&quot; &quot;2175&quot; &quot;755&quot; &quot;23046&quot; ## ## $X2 ## [1] &quot;23450&quot; &quot;5160&quot; &quot;7126&quot; &quot;26118&quot; &quot;8452&quot; &quot;3675&quot; ## ## $X3 ## [1] &quot;894&quot; &quot;7057&quot; &quot;22906&quot; &quot;3339&quot; &quot;10449&quot; &quot;6566&quot; ## ## $X4 ## [1] &quot;5573&quot; &quot;7453&quot; &quot;5245&quot; &quot;23450&quot; &quot;6500&quot; &quot;4926&quot; ## ## $X5 ## [1] &quot;5982&quot; &quot;7318&quot; &quot;6352&quot; &quot;2101&quot; &quot;8882&quot; &quot;7803&quot; ## ## $X6 ## [1] &quot;5337&quot; &quot;9295&quot; &quot;4035&quot; &quot;811&quot; &quot;23365&quot; &quot;4629&quot; ## ## $X7 ## [1] &quot;2621&quot; &quot;2665&quot; &quot;5690&quot; &quot;3608&quot; &quot;3550&quot; &quot;533&quot; ## ## $X8 ## [1] &quot;2665&quot; &quot;4735&quot; &quot;1327&quot; &quot;3192&quot; &quot;5573&quot; &quot;9528&quot; The input for geneCluster parameter should be a named list of gene IDs. To speed up the compilation of this document, we set use_internal_data = TRUE. ck &lt;- compareCluster(geneCluster = gcSample, fun = &quot;enrichKEGG&quot;) head(as.data.frame(ck)) ## Cluster ID Description ## 1 X2 hsa04110 Cell cycle ## 2 X2 hsa05169 Epstein-Barr virus infection ## 3 X2 hsa05340 Primary immunodeficiency ## 4 X3 hsa04512 ECM-receptor interaction ## 5 X3 hsa04060 Cytokine-cytokine receptor interaction ## 6 X3 hsa04151 PI3K-Akt signaling pathway ## GeneRatio BgRatio pvalue p.adjust qvalue ## 1 18/377 124/7856 2.307387e-05 0.006668348 0.006266377 ## 2 23/377 201/7856 8.833345e-05 0.012764183 0.011994752 ## 3 8/377 37/7856 2.956604e-04 0.028481954 0.026765048 ## 4 9/182 86/7856 1.562255e-04 0.039525054 0.036671883 ## 5 17/182 294/7856 4.486588e-04 0.044324307 0.041124695 ## 6 19/182 354/7856 5.255847e-04 0.044324307 0.041124695 ## geneID ## 1 991/1869/890/1871/701/990/10926/9088/8317/9700/9134/1029/2810/699/11200/23594/8555/4173 ## 2 4067/3383/7128/1869/890/1871/578/864/637/9641/6891/355/9134/5971/916/956/6850/7187/3551/919/4734/958/6772 ## 3 100/6891/3932/973/916/925/958/64421 ## 4 7057/3339/1299/3695/1101/3679/3910/3696/3693 ## 5 2919/4982/3977/6375/8200/608/8792/3568/2057/1438/8718/655/652/10220/50615/51561/7042 ## 6 894/7057/6794/2247/1299/3695/2252/2066/1101/8817/1021/5105/3679/3082/2057/3910/3551/3696/3693 ## Count ## 1 18 ## 2 23 ## 3 8 ## 4 9 ## 5 17 ## 6 19 11.1 Formula interface of compareCluster compareCluster also supports passing a formula (the code to support formula has been contributed by Giovanni Dall’Olio) of type \\(Entrez \\sim group\\) or \\(Entrez \\sim group + othergroup\\). mydf &lt;- data.frame(Entrez=names(geneList), FC=geneList) mydf &lt;- mydf[abs(mydf$FC) &gt; 1,] mydf$group &lt;- &quot;upregulated&quot; mydf$group[mydf$FC &lt; 0] &lt;- &quot;downregulated&quot; mydf$othergroup &lt;- &quot;A&quot; mydf$othergroup[abs(mydf$FC) &gt; 2] &lt;- &quot;B&quot; formula_res &lt;- compareCluster(Entrez~group+othergroup, data=mydf, fun=&quot;enrichKEGG&quot;) head(as.data.frame(formula_res)) ## Cluster group othergroup ID ## 1 downregulated.A downregulated A hsa04974 ## 2 downregulated.A downregulated A hsa04510 ## 3 downregulated.A downregulated A hsa04151 ## 4 downregulated.A downregulated A hsa04512 ## 5 downregulated.A downregulated A hsa05414 ## 6 downregulated.A downregulated A hsa04010 ## Description GeneRatio BgRatio ## 1 Protein digestion and absorption 15/301 90/7856 ## 2 Focal adhesion 20/301 199/7856 ## 3 PI3K-Akt signaling pathway 28/301 354/7856 ## 4 ECM-receptor interaction 11/301 86/7856 ## 5 Dilated cardiomyopathy (DCM) 11/301 91/7856 ## 6 MAPK signaling pathway 23/301 295/7856 ## pvalue p.adjust qvalue ## 1 1.352987e-06 0.0003531296 0.0003289895 ## 2 7.126863e-05 0.0093005568 0.0086647656 ## 3 1.998489e-04 0.0173868578 0.0161982825 ## 4 4.095273e-04 0.0267216576 0.0248949502 ## 5 6.684394e-04 0.0348925392 0.0325072658 ## 6 9.083874e-04 0.0395148504 0.0368135932 ## geneID ## 1 1281/50509/1290/477/1294/1360/1289/1292/23428/1359/1300/1287/6505/2006/7373 ## 2 55742/2317/7058/25759/56034/3693/3480/5159/857/1292/3908/3909/63923/3913/1287/3679/7060/3479/10451/80310 ## 3 55970/5618/7058/10161/56034/3693/4254/3480/4908/5159/1292/3908/2690/3909/8817/9223/4915/3551/2791/63923/3913/9863/3667/1287/3679/7060/3479/80310 ## 4 7058/3693/3339/1292/3908/3909/63923/3913/1287/3679/7060 ## 5 55799/27092/6444/3693/775/3908/5350/7043/3679/3479/9254 ## 6 55799/3306/2317/4214/55970/56034/27092/4254/3480/4908/3305/5159/775/8817/4915/3551/7786/7043/57551/3479/9254/1846/80310 ## Count ## 1 15 ## 2 20 ## 3 28 ## 4 11 ## 5 11 ## 6 23 11.2 Visualization of profile comparison We can visualize the result using dotplot method. dotplot(ck) dotplot(formula_res) dotplot(formula_res, x=~group) + ggplot2::facet_grid(~othergroup) By default, only top 5 (most significant) categories of each cluster was plotted. User can changes the parameter showCategory to specify how many categories of each cluster to be plotted, and if showCategory was set to NULL, the whole result will be plotted. The plot function accepts a parameter by for setting the scale of dot sizes. The default parameter by is setting to “geneRatio”, which corresponding to the “GeneRatio” column of the output. If it was setting to count, the comparison will be based on gene counts, while if setting to rowPercentage, the dot sizes will be normalized by count/(sum of each row) To provide the full information, we also provide number of identified genes in each category (numbers in parentheses) when by is setting to rowPercentage and number of gene clusters in each cluster label (numbers in parentheses) when by is setting to geneRatio, as shown in Figure 3. If the dot sizes were based on count, the row numbers will not shown. The p-values indicate that which categories are more likely to have biological meanings. The dots in the plot are color-coded based on their corresponding p-values. Color gradient ranging from red to blue correspond to in order of increasing p-values. That is, red indicate low p-values (high enrichment), and blue indicate high p-values (low enrichment). P-values and adjusted p-values were filtered out by the threshold giving by parameter pvalueCutoff, and FDR can be estimated by qvalue. User can refer to the example in Yu (2012)(Yu et al. 2012); we analyzed the publicly available expression dataset of breast tumour tissues from 200 patients (GSE11121, Gene Expression Omnibus)(Schmidt et al. 2008). We identified 8 gene clusters from differentially expressed genes, and using compareCluster to compare these gene clusters by their enriched biological process. The comparison function was designed as a framework for comparing gene clusters of any kind of ontology associations, not only groupGO, enrichGO, enrichKEGG and enricher provided in this package, but also other biological and biomedical ontologies, for instance, enrichDO from DOSE(Yu et al. 2015), enrichMeSH from meshes and enrichPathway from ReactomePA work fine with compareCluster for comparing biological themes in disease and reactome pathway perspective. More details can be found in the vignettes of DOSE(Yu et al. 2015) and ReactomePA. References "],
["chapter12.html", "Chapter 12 Visualization of Functional Enrichment Result 12.1 Bar Plot 12.2 Dot plot 12.3 Gene-Concept Network 12.4 Heatmap-like functional classification 12.5 Enrichment Map 12.6 UpSet Plot 12.7 ridgeline plot for expression distribution of GSEA result 12.8 running score and preranked list of GSEA result 12.9 pubmed trend of enriched terms 12.10 goplot 12.11 browseKEGG 12.12 pathview from pathview package", " Chapter 12 Visualization of Functional Enrichment Result The enrichplot package implements several visualization methods to help interpreting enrichment results. It supports visualizing enrichment results obtained from DOSE (Yu et al. 2015), clusterProfiler (???), ReactomePA (Yu and He 2016) and meshes. Both over representation analysis (ORA) and gene set enrichment analysis (GSEA) are supported. Many of these visualization methods were first implemented in DOSE and rewrote from scratch using ggplot2. If you want to use old methods1, you can use the doseplot package. 12.1 Bar Plot Bar plot is the most widely used method to visualize enriched terms. It depicts the enrichment scores (e.g. p values) and gene count or ratio as bar height and color. library(DOSE) data(geneList) de &lt;- names(geneList)[abs(geneList) &gt; 2] edo &lt;- enrichDGN(de) library(enrichplot) barplot(edo, showCategory=20) 12.2 Dot plot Dot plot is similar to bar plot with the capability to encode another score as dot size. edo2 &lt;- gseNCG(geneList, nPerm=10000) p1 &lt;- dotplot(edo, showCategory=30) + ggtitle(&quot;dotplot for ORA&quot;) p2 &lt;- dotplot(edo2, showCategory=30) + ggtitle(&quot;dotplot for GSEA&quot;) plot_grid(p1, p2, ncol=2) 12.3 Gene-Concept Network Both the barplot and dotplot only displayed most significant enriched terms, while users may want to know which genes are involved in these significant terms. In order to consider the potentially biological complexities in which a gene may belong to multiple annotation categories and provide information of numeric changes if available, we developed cnetplot function to extract the complex association. The cnetplot depicts the linkages of genes and biological concepts (e.g. GO terms or KEGG pathways) as a network. GSEA result is also supported with only core enriched genes displayed. ## convert gene ID to Symbol edox &lt;- setReadable(edo, &#39;org.Hs.eg.db&#39;, &#39;ENTREZID&#39;) cnetplot(edox, foldChange=geneList) ## categorySize can be scaled by &#39;pvalue&#39; or &#39;geneNum&#39; cnetplot(edox, categorySize=&quot;pvalue&quot;, foldChange=geneList) cnetplot(edox, foldChange=geneList, circular = TRUE, colorEdge = TRUE) 12.4 Heatmap-like functional classification The heatplot is similar to cnetplot, while displaying the relationships as a heatmap. The gene-concept network may become too complicated if user want to show a large number significant terms. The heatplot can simplify the result and more easy to identify expression patterns. heatplot(edox) heatplot(edox, foldChange=geneList) 12.5 Enrichment Map Enrichment map organizes enriched terms into a network with edges connecting overlapping gene sets. In this way, mutually overlapping gene sets are tend to cluster together, making it easy to identify functional module. The emapplot function supports results obtained from hypergeometric test and gene set enrichment analysis. emapplot(edo) 12.6 UpSet Plot The upsetplot is an alternative to cnetplot for visualizing the complex association between genes and gene sets. It emphasizes the gene overlapping among different gene sets. upsetplot(edo) 12.7 ridgeline plot for expression distribution of GSEA result The ridgeplot will visualize expression distributions of core enriched genes for GSEA enriched categories. It helps users to interpret up/down-regulated pathways. ridgeplot(edo2) 12.8 running score and preranked list of GSEA result Running score and preranked list are traditional methods for visualizing GSEA result. The enrichplot package supports both of them to visualize the distribution of the gene set and the enrichment score. gseaplot(edo2, geneSetID = 1, by = &quot;runningScore&quot;, title = edo2$Description[1]) gseaplot(edo2, geneSetID = 1, by = &quot;preranked&quot;, title = edo2$Description[1]) gseaplot(edo2, geneSetID = 1, title = edo2$Description[1]) Another method to plot GSEA result is the gseaplot2 function: gseaplot2(edo2, geneSetID = 1, title = edo2$Description[1]) The gseaplot2 also supports multile gene sets to be displayed on the same figure: gseaplot2(edo2, geneSetID = 1:3) User can also displaying the pvalue table on the plot via pvalue_table parameter: gseaplot2(edo2, geneSetID = 1:3, pvalue_table = TRUE, color = c(&quot;#E495A5&quot;, &quot;#86B875&quot;, &quot;#7DB0DD&quot;), ES_geom = &quot;dot&quot;) User can specify subplots to only display a subset of plots: gseaplot2(edo2, geneSetID = 1:3, subplots = 1) gseaplot2(edo2, geneSetID = 1:3, subplots = 1:2) The gsearank function plot the ranked list of genes belong to the specific gene set. gsearank(edo2, 1, title = edo2[1, &quot;Description&quot;]) Multiple gene sets can be aligned using cowplot: library(ggplot2) library(cowplot) pp &lt;- lapply(1:3, function(i) { anno &lt;- edo2[i, c(&quot;NES&quot;, &quot;pvalue&quot;, &quot;p.adjust&quot;)] lab &lt;- paste0(names(anno), &quot;=&quot;, round(anno, 3), collapse=&quot;\\n&quot;) gsearank(edo2, i, edo2[i, 2]) + xlab(NULL) +ylab(NULL) + annotate(&quot;text&quot;, 0, edo2[i, &quot;enrichmentScore&quot;] * .9, label = lab, hjust=0, vjust=0) }) plot_grid(plotlist=pp, ncol=1) 12.9 pubmed trend of enriched terms One of the problem of enrichment analysis is to find pathways for further investigation. Here, we provide pmcplot function to plot the number/proportion of publications trend based on the query result from PubMed Central. Of course, users can use pmcplot in other scenarios. All text that can be queried on PMC is valid as input of pmcplot. terms &lt;- edo$Description[1:3] p &lt;- pmcplot(terms, 2010:2017) p2 &lt;- pmcplot(terms, 2010:2017, proportion=FALSE) plot_grid(p, p2, ncol=2) 12.10 goplot goplot can accept output of enrichGO and visualized the enriched GO induced graph. goplot(ego) 12.11 browseKEGG To view the KEGG pathway, user can use browseKEGG function, which will open web browser and highlight enriched genes. browseKEGG(kk, &#39;hsa04110&#39;) 12.12 pathview from pathview package clusterProfiler users can also use pathview from the pathview(Luo and Brouwer 2013) to visualize KEGG pathway. The following example illustrate how to visualize “hsa04110” pathway, which was enriched in our previous analysis. library(&quot;pathview&quot;) hsa04110 &lt;- pathview(gene.data = geneList, pathway.id = &quot;hsa04110&quot;, species = &quot;hsa&quot;, limit = list(gene=max(abs(geneList)), cpd=1)) For further information, please refer to the vignette of pathview(Luo and Brouwer 2013). References "],
["chapter13.html", "Chapter 13 dplyr verbs for clusterProfiler 13.1 filter 13.2 arrange 13.3 select 13.4 mutate 13.5 summarise", " Chapter 13 dplyr verbs for clusterProfiler clusterProfiler.dplyr package. library(DOSE) data(geneList) de = names(geneList)[1:100] x = enrichDO(de) 13.1 filter library(clusterProfiler.dplyr) filter(x, p.adjust &lt; .05, qvalue &lt; 0.2) ## # ## # over-representation test ## # ## #...@organism Homo sapiens ## #...@ontology DO ## #...@keytype ENTREZID ## #...@gene chr [1:100] &quot;4312&quot; &quot;8318&quot; &quot;10874&quot; &quot;55143&quot; &quot;55388&quot; ... ## #...pvalues adjusted by &#39;BH&#39; with cutoff &lt;0.05 ## #...28 enriched terms found ## &#39;data.frame&#39;: 28 obs. of 9 variables: ## $ ID : chr &quot;DOID:0060071&quot; &quot;DOID:5295&quot; &quot;DOID:8719&quot; &quot;DOID:3007&quot; ... ## $ Description: chr &quot;pre-malignant neoplasm&quot; &quot;intestinal disease&quot; &quot;in situ carcinoma&quot; &quot;breast ductal carcinoma&quot; ... ## $ GeneRatio : chr &quot;5/77&quot; &quot;9/77&quot; &quot;4/77&quot; &quot;4/77&quot; ... ## $ BgRatio : chr &quot;22/8007&quot; &quot;157/8007&quot; &quot;18/8007&quot; &quot;29/8007&quot; ... ## $ pvalue : num 1.67e-06 1.76e-05 2.18e-05 1.56e-04 2.08e-04 ... ## $ p.adjust : num 0.00064 0.00279 0.00279 0.0136 0.0136 ... ## $ qvalue : num 0.000461 0.002008 0.002008 0.009796 0.009796 ... ## $ geneID : chr &quot;6280/6278/10232/332/4321&quot; &quot;4312/6279/3627/10563/4283/890/366/4902/3620&quot; &quot;6280/6278/10232/332&quot; &quot;6280/6279/4751/6286&quot; ... ## $ Count : int 5 9 4 4 13 6 13 5 5 6 ... ## #...Citation ## Guangchuang Yu, Li-Gen Wang, Guang-Rong Yan, Qing-Yu He. DOSE: an ## R/Bioconductor package for Disease Ontology Semantic and Enrichment ## analysis. Bioinformatics 2015, 31(4):608-609 13.2 arrange mutate(x, geneRatio = parse_ratio(GeneRatio)) %&gt;% arrange(desc(geneRatio)) ## # ## # over-representation test ## # ## #...@organism Homo sapiens ## #...@ontology DO ## #...@keytype ENTREZID ## #...@gene chr [1:100] &quot;4312&quot; &quot;8318&quot; &quot;10874&quot; &quot;55143&quot; &quot;55388&quot; ... ## #...pvalues adjusted by &#39;BH&#39; with cutoff &lt;0.05 ## #...28 enriched terms found ## &#39;data.frame&#39;: 28 obs. of 10 variables: ## $ ID : chr &quot;DOID:3908&quot; &quot;DOID:120&quot; &quot;DOID:2394&quot; &quot;DOID:3459&quot; ... ## $ Description: chr &quot;non-small cell lung carcinoma&quot; &quot;female reproductive organ cancer&quot; &quot;ovarian cancer&quot; &quot;breast carcinoma&quot; ... ## $ GeneRatio : chr &quot;13/77&quot; &quot;13/77&quot; &quot;10/77&quot; &quot;10/77&quot; ... ## $ BgRatio : chr &quot;431/8007&quot; &quot;455/8007&quot; &quot;312/8007&quot; &quot;383/8007&quot; ... ## $ pvalue : num 2.08e-04 3.52e-04 7.54e-04 3.48e-03 1.76e-05 ... ## $ p.adjust : num 0.0136 0.01928 0.02625 0.04756 0.00279 ... ## $ qvalue : num 0.0098 0.01389 0.0189 0.03424 0.00201 ... ## $ geneID : chr &quot;6280/2305/9133/6279/7153/6278/6241/11065/10232/332/6286/3002/9212&quot; &quot;4312/6279/7153/3627/820/983/10232/6362/332/6286/9212/4321/6790&quot; &quot;4312/820/983/10232/6362/332/6286/9212/4321/6790&quot; &quot;4312/6280/6279/7153/4751/890/4085/332/6286/6790&quot; ... ## $ Count : int 13 13 10 10 9 7 7 6 6 6 ... ## $ geneRatio : num 0.169 0.169 0.13 0.13 0.117 ... ## #...Citation ## Guangchuang Yu, Li-Gen Wang, Guang-Rong Yan, Qing-Yu He. DOSE: an ## R/Bioconductor package for Disease Ontology Semantic and Enrichment ## analysis. Bioinformatics 2015, 31(4):608-609 13.3 select select(x, -geneID) %&gt;% head ## ID Description ## DOID:0060071 DOID:0060071 pre-malignant neoplasm ## DOID:5295 DOID:5295 intestinal disease ## DOID:8719 DOID:8719 in situ carcinoma ## DOID:3007 DOID:3007 breast ductal carcinoma ## DOID:3908 DOID:3908 non-small cell lung carcinoma ## DOID:0050589 DOID:0050589 inflammatory bowel disease ## GeneRatio BgRatio pvalue p.adjust ## DOID:0060071 5/77 22/8007 1.671524e-06 0.0006401937 ## DOID:5295 9/77 157/8007 1.759049e-05 0.0027885022 ## DOID:8719 4/77 18/8007 2.184205e-05 0.0027885022 ## DOID:3007 4/77 29/8007 1.564603e-04 0.0136037018 ## DOID:3908 13/77 431/8007 2.075001e-04 0.0136037018 ## DOID:0050589 6/77 90/8007 2.131128e-04 0.0136037018 ## qvalue Count ## DOID:0060071 0.0004609887 5 ## DOID:5295 0.0020079362 9 ## DOID:8719 0.0020079362 4 ## DOID:3007 0.0097957122 4 ## DOID:3908 0.0097957122 13 ## DOID:0050589 0.0097957122 6 13.4 mutate y &lt;- mutate(x, richFactor = Count / as.numeric(sub(&quot;/\\\\d+&quot;, &quot;&quot;, BgRatio))) y ## # ## # over-representation test ## # ## #...@organism Homo sapiens ## #...@ontology DO ## #...@keytype ENTREZID ## #...@gene chr [1:100] &quot;4312&quot; &quot;8318&quot; &quot;10874&quot; &quot;55143&quot; &quot;55388&quot; ... ## #...pvalues adjusted by &#39;BH&#39; with cutoff &lt;0.05 ## #...28 enriched terms found ## &#39;data.frame&#39;: 28 obs. of 10 variables: ## $ ID : chr &quot;DOID:0060071&quot; &quot;DOID:5295&quot; &quot;DOID:8719&quot; &quot;DOID:3007&quot; ... ## $ Description: chr &quot;pre-malignant neoplasm&quot; &quot;intestinal disease&quot; &quot;in situ carcinoma&quot; &quot;breast ductal carcinoma&quot; ... ## $ GeneRatio : chr &quot;5/77&quot; &quot;9/77&quot; &quot;4/77&quot; &quot;4/77&quot; ... ## $ BgRatio : chr &quot;22/8007&quot; &quot;157/8007&quot; &quot;18/8007&quot; &quot;29/8007&quot; ... ## $ pvalue : num 1.67e-06 1.76e-05 2.18e-05 1.56e-04 2.08e-04 ... ## $ p.adjust : num 0.00064 0.00279 0.00279 0.0136 0.0136 ... ## $ qvalue : num 0.000461 0.002008 0.002008 0.009796 0.009796 ... ## $ geneID : chr &quot;6280/6278/10232/332/4321&quot; &quot;4312/6279/3627/10563/4283/890/366/4902/3620&quot; &quot;6280/6278/10232/332&quot; &quot;6280/6279/4751/6286&quot; ... ## $ Count : int 5 9 4 4 13 6 13 5 5 6 ... ## $ richFactor : num 0.2273 0.0573 0.2222 0.1379 0.0302 ... ## #...Citation ## Guangchuang Yu, Li-Gen Wang, Guang-Rong Yan, Qing-Yu He. DOSE: an ## R/Bioconductor package for Disease Ontology Semantic and Enrichment ## analysis. Bioinformatics 2015, 31(4):608-609 library(ggplot2) library(forcats) library(enrichplot) ggplot(y, showCategory = 20, aes(richFactor, fct_reorder(Description, richFactor))) + geom_segment(aes(xend=0, yend = Description)) + geom_point(aes(color=p.adjust, size = Count)) + scale_color_viridis_c() + scale_size_continuous(range=c(2, 10)) + theme_minimal() + xlab(&quot;rich factor&quot;) + ylab(NULL) + ggtitle(&quot;Enriched Disease Ontology&quot;) 13.5 summarise pi=seq(0, 1, length.out=11) mutate(x, pp = cut(pvalue, pi)) %&gt;% group_by(pp) %&gt;% summarise(cnt = n()) %&gt;% ggplot(aes(pp, cnt)) + geom_col() + theme_minimal() + xlab(&quot;p value intervals&quot;) + ylab(&quot;Frequency&quot;) + ggtitle(&quot;p value distribution&quot;) "],
["chapter14.html", "Chapter 14 Useful utilities 14.1 bitr: Biological Id TranslatoR 14.2 setReadable: translating gene IDs to human readable symbols", " Chapter 14 Useful utilities 14.1 bitr: Biological Id TranslatoR clusterProfiler provides bitr and bitr_kegg for converting ID types. Both bitr and bitr_kegg support many species including model and many non-model organisms. x &lt;- c(&quot;GPX3&quot;, &quot;GLRX&quot;, &quot;LBP&quot;, &quot;CRYAB&quot;, &quot;DEFB1&quot;, &quot;HCLS1&quot;, &quot;SOD2&quot;, &quot;HSPA2&quot;, &quot;ORM1&quot;, &quot;IGFBP1&quot;, &quot;PTHLH&quot;, &quot;GPC3&quot;, &quot;IGFBP3&quot;,&quot;TOB1&quot;, &quot;MITF&quot;, &quot;NDRG1&quot;, &quot;NR1H4&quot;, &quot;FGFR3&quot;, &quot;PVR&quot;, &quot;IL6&quot;, &quot;PTPRM&quot;, &quot;ERBB2&quot;, &quot;NID2&quot;, &quot;LAMB1&quot;, &quot;COMP&quot;, &quot;PLS3&quot;, &quot;MCAM&quot;, &quot;SPP1&quot;, &quot;LAMC1&quot;, &quot;COL4A2&quot;, &quot;COL4A1&quot;, &quot;MYOC&quot;, &quot;ANXA4&quot;, &quot;TFPI2&quot;, &quot;CST6&quot;, &quot;SLPI&quot;, &quot;TIMP2&quot;, &quot;CPM&quot;, &quot;GGT1&quot;, &quot;NNMT&quot;, &quot;MAL&quot;, &quot;EEF1A2&quot;, &quot;HGD&quot;, &quot;TCN2&quot;, &quot;CDA&quot;, &quot;PCCA&quot;, &quot;CRYM&quot;, &quot;PDXK&quot;, &quot;STC1&quot;, &quot;WARS&quot;, &quot;HMOX1&quot;, &quot;FXYD2&quot;, &quot;RBP4&quot;, &quot;SLC6A12&quot;, &quot;KDELR3&quot;, &quot;ITM2B&quot;) eg = bitr(x, fromType=&quot;SYMBOL&quot;, toType=&quot;ENTREZID&quot;, OrgDb=&quot;org.Hs.eg.db&quot;) head(eg) ## SYMBOL ENTREZID ## 1 GPX3 2878 ## 2 GLRX 2745 ## 3 LBP 3929 ## 4 CRYAB 1410 ## 5 DEFB1 1672 ## 6 HCLS1 3059 User should provides an annotation package, both fromType and toType can accept any types that supported. User can use keytypes to list all supporting types. library(org.Hs.eg.db) keytypes(org.Hs.eg.db) ## [1] &quot;ACCNUM&quot; &quot;ALIAS&quot; &quot;ENSEMBL&quot; ## [4] &quot;ENSEMBLPROT&quot; &quot;ENSEMBLTRANS&quot; &quot;ENTREZID&quot; ## [7] &quot;ENZYME&quot; &quot;EVIDENCE&quot; &quot;EVIDENCEALL&quot; ## [10] &quot;GENENAME&quot; &quot;GO&quot; &quot;GOALL&quot; ## [13] &quot;IPI&quot; &quot;MAP&quot; &quot;OMIM&quot; ## [16] &quot;ONTOLOGY&quot; &quot;ONTOLOGYALL&quot; &quot;PATH&quot; ## [19] &quot;PFAM&quot; &quot;PMID&quot; &quot;PROSITE&quot; ## [22] &quot;REFSEQ&quot; &quot;SYMBOL&quot; &quot;UCSCKG&quot; ## [25] &quot;UNIGENE&quot; &quot;UNIPROT&quot; We can translate from one type to other types. ids &lt;- bitr(x, fromType=&quot;SYMBOL&quot;, toType=c(&quot;UNIPROT&quot;, &quot;ENSEMBL&quot;), OrgDb=&quot;org.Hs.eg.db&quot;) head(ids) ## SYMBOL UNIPROT ENSEMBL ## 1 GPX3 P22352 ENSG00000211445 ## 2 GLRX A0A024RAM2 ENSG00000173221 ## 3 GLRX P35754 ENSG00000173221 ## 4 LBP P18428 ENSG00000129988 ## 5 LBP Q8TCF0 ENSG00000129988 ## 6 CRYAB P02511 ENSG00000109846 For GO analysis, user don’t need to convert ID, all ID type provided by OrgDb can be used in groupGO, enrichGO and gseGO by specifying keyType parameter. 14.1.1 bitr_kegg: converting biological IDs using KEGG API data(gcSample) hg &lt;- gcSample[[1]] head(hg) ## [1] &quot;4597&quot; &quot;7111&quot; &quot;5266&quot; &quot;2175&quot; &quot;755&quot; &quot;23046&quot; eg2np &lt;- bitr_kegg(hg, fromType=&#39;kegg&#39;, toType=&#39;ncbi-proteinid&#39;, organism=&#39;hsa&#39;) head(eg2np) ## kegg ncbi-proteinid ## 1 10001 NP_005457 ## 2 10209 NP_005792 ## 3 10232 NP_037536 ## 4 10324 NP_006054 ## 5 10411 NP_001092002 ## 6 10614 NP_006451 The ID type (both fromType &amp; toType) should be one of ‘kegg’, ‘ncbi-geneid’, ‘ncbi-proteinid’ or ‘uniprot’. The ‘kegg’ is the primary ID used in KEGG database. The data source of KEGG was from NCBI. A rule of thumb for the ‘kegg’ ID is entrezgene ID for eukaryote species and Locus ID for prokaryotes. Many prokaryote species don’t have entrezgene ID available. For example we can check the gene information of ece:Z5100 in http://www.genome.jp/dbget-bin/www_bget?ece:Z5100, which have NCBI-ProteinID and UnitProt links in the Other DBs Entry, but not NCBI-GeneID. If we try to convert Z5100 to ncbi-geneid, bitr_kegg will throw error of ncbi-geneid is not supported. bitr_kegg(&quot;Z5100&quot;, fromType=&quot;kegg&quot;, toType=&#39;ncbi-geneid&#39;, organism=&#39;ece&#39;) ## Error in KEGG_convert(fromType, toType, organism) : ## ncbi-geneid is not supported for ece ... We can of course convert it to ncbi-proteinid and uniprot: bitr_kegg(&quot;Z5100&quot;, fromType=&quot;kegg&quot;, toType=&#39;ncbi-proteinid&#39;, organism=&#39;ece&#39;) ## kegg ncbi-proteinid ## 1 Z5100 AAG58814 bitr_kegg(&quot;Z5100&quot;, fromType=&quot;kegg&quot;, toType=&#39;uniprot&#39;, organism=&#39;ece&#39;) ## kegg uniprot ## 1 Z5100 A0A3G4X4E3 14.2 setReadable: translating gene IDs to human readable symbols Some of the functions, especially those internally supported for DO, GO, and Reactome Pathway, support a parameter, readable. If readable = TRUE, all the gene IDs will be translated to gene symbols. The readable parameter is not available for enrichment analysis of KEGG or using user’s own annotation. KEGG analysis using enrichKEGG and gseKEGG, internally query annotation information from KEEGG database and thus support all species if it is available in the KEGG database. However, KEGG database doesn’t provide gene ID to symbol mapping information. For analysis using user’s own annotation data, we even don’t know what species is in analyzed. Translating gene IDs to gene symbols is partly supported using the setReadable function if and only if there is an OrgDb available. library(org.Hs.eg.db) library(clusterProfiler) data(geneList, package=&quot;DOSE&quot;) de &lt;- names(geneList)[1:100] x &lt;- enrichKEGG(de) ## The geneID column is ENTREZID head(x, 3) ## ID Description GeneRatio BgRatio ## hsa04110 hsa04110 Cell cycle 8/48 124/7856 ## hsa04218 hsa04218 Cellular senescence 7/48 160/7856 ## hsa04114 hsa04114 Oocyte meiosis 6/48 125/7856 ## pvalue p.adjust qvalue ## hsa04110 6.830542e-07 7.650207e-05 7.118144e-05 ## hsa04218 4.651672e-05 2.604936e-03 2.423766e-03 ## hsa04114 1.021826e-04 3.814817e-03 3.549501e-03 ## geneID Count ## hsa04110 8318/991/9133/890/983/4085/7272/1111 8 ## hsa04218 2305/4605/9133/890/983/51806/1111 7 ## hsa04114 991/9133/983/4085/51806/6790 6 y &lt;- setReadable(x, OrgDb = org.Hs.eg.db, keyType=&quot;ENTREZID&quot;) ## The geneID column is translated to symbol head(y, 3) ## ID Description GeneRatio BgRatio ## hsa04110 hsa04110 Cell cycle 8/48 124/7856 ## hsa04218 hsa04218 Cellular senescence 7/48 160/7856 ## hsa04114 hsa04114 Oocyte meiosis 6/48 125/7856 ## pvalue p.adjust qvalue ## hsa04110 6.830542e-07 7.650207e-05 7.118144e-05 ## hsa04218 4.651672e-05 2.604936e-03 2.423766e-03 ## hsa04114 1.021826e-04 3.814817e-03 3.549501e-03 ## geneID ## hsa04110 CDC45/CDC20/CCNB2/CCNA2/CDK1/MAD2L1/TTK/CHEK1 ## hsa04218 FOXM1/MYBL2/CCNB2/CCNA2/CDK1/CALML5/CHEK1 ## hsa04114 CDC20/CCNB2/CDK1/MAD2L1/CALML5/AURKA ## Count ## hsa04110 8 ## hsa04218 7 ## hsa04114 6 For those functions that internally support readable parameter, user can also use setReadable for translating gene IDs. "],
["references.html", "References", " References "]
]
