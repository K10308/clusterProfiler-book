[
["index.html", "clusterProfiler: universal enrichment tool for functional and comparative study Preface", " clusterProfiler: universal enrichment tool for functional and comparative study Guangchuang Yu Preface hello "],
["chapter1.html", "Chapter 1 Over-representation analysis", " Chapter 1 Over-representation analysis Over-representation test(Boyle et al. 2004) is a widely used approach to identify biological themes. DOSE implements hypergeometric model to assess whether the number of selected genes associated with disease is larger than expected. To determine whether any terms annotate a specified list of genes at frequency greater than that would be expected by chance, DOSE calculates a p-value using the hypergeometric distribution: \\(p = 1 - \\displaystyle\\sum_{i = 0}^{k-1}\\frac{{M \\choose i}{{N-M} \\choose {n-i}}} {{N \\choose n}}\\) In this equation, N is the total number of genes in the background distribution, M is the number of genes within that distribution that are annotated (either directly or indirectly) to the node of interest, n is the size of the list of genes of interest and k is the number of genes within that list which are annotated to the node. The background distribution by default is all the genes that have annotation. User can set the background via universe parameter. P-values were adjusted for multiple comparison, and q-values were also calculated for FDR control. References "],
["chapter2.html", "Chapter 2 Gene Set Enrichment Analysis 2.1 Leading edge analysis and core enriched genes", " Chapter 2 Gene Set Enrichment Analysis A common approach in analyzing gene expression profiles was identifying differential expressed genes that are deemed interesting. The enrichment analysis we demonstrated in Disease enrichment analysis vignette were based on these differential expressed genes. This approach will find genes where the difference is large, but it will not detect a situation where the difference is small, but evidenced in coordinated way in a set of related genes. Gene Set Enrichment Analysis (GSEA)(Subramanian et al. 2005) directly addresses this limitation. All genes can be used in GSEA; GSEA aggregates the per gene statistics across genes within a gene set, therefore making it possible to detect situations where all genes in a predefined set change in a small but coordinated way. Since it is likely that many relevant phenotypic differences are manifested by small but consistent changes in a set of genes. Genes are ranked based on their phenotypes. Given a priori defined set of gens S (e.g., genes shareing the same DO category), the goal of GSEA is to determine whether the members of S are randomly distributed throughout the ranked gene list (L) or primarily found at the top or bottom. There are three key elements of the GSEA method: Calculation of an Enrichment Score. The enrichment score (ES) represent the degree to which a set S is over-represented at the top or bottom of the ranked list L. The score is calculated by walking down the list L, increasing a running-sum statistic when we encounter a gene in S and decreasing when it is not. The magnitude of the increment depends on the gene statistics (e.g., correlation of the gene with phenotype). The ES is the maximum deviation from zero encountered in the random walk; it corresponds to a weighted Kolmogorov-Smirnov-like statistic(Subramanian et al. 2005). Esimation of Significance Level of ES. The p-value of the ES is calculated using permutation test. Specifically, we permute the gene labels of the gene list L and recompute the ES of the gene set for the permutated data, which generate a null distribution for the ES. The p-value of the observed ES is then calculated relative to this null distribution. Adjustment for Multiple Hypothesis Testing. When the entire gene sets were evaluated, DOSE adjust the estimated significance level to account for multiple hypothesis testing and also q-values were calculated for FDR control. We implemented GSEA algorithm proposed by Subramanian(Subramanian et al. 2005). Alexey Sergushichev implemented an algorithm for fast GSEA analysis in the fgsea(S., n.d.) package. In DOSE(Yu et al. 2015), user can use GSEA algorithm implemented in DOSE or fgsea by specifying the parameter by=\"DOSE\" or by=\"fgsea\". By default, DOSE use fgsea since it is much more fast. 2.1 Leading edge analysis and core enriched genes Leading edge analysis reports Tags to indicate the percentage of genes contributing to the enrichment score, List to indicate where in the list the enrichment score is attained and Signal for enrichment signal strength. It would also be very interesting to get the core enriched genes that contribute to the enrichment. DOSE supports leading edge analysis and report core enriched genes in GSEA analysis. References "],
["chapter3.html", "Chapter 3 Universal enrichment analysis 3.1 The geneList dataset 3.2 WikiPathways analysis", " Chapter 3 Universal enrichment analysis clusterProfiler supports both hypergeometric test and gene set enrichment analyses of many ontology/pathway, but it’s still not enough for users may want to analyze their data with unsupported organisms, slim version of GO, novel functional annotation (e.g. GO via BlastGO or KEGG via KAAS), unsupported ontologies/pathways or customized annotations. clusterProfiler provides enricher function for hypergeometric test and GSEA function for gene set enrichment analysis that are designed to accept user defined annotation. They accept two additional parameters TERM2GENE and TERM2NAME. As indicated in the parameter names, TERM2GENE is a data.frame with first column of term ID and second column of corresponding mapped gene and TERM2NAME is a data.frame with first column of term ID and second column of corresponding term name. TERM2NAME is optional. An example of using enricher and GSEA to analyze DisGeNet annotation is presented in the post, use clusterProfiler as an universal enrichment analysis tool. 3.1 The geneList dataset DOSE provides an example dataset geneList which was derived from R package breastCancerMAINZ that contained 200 samples, including 29 samples in grade I, 136 samples in grade II and 35 samples in grade III. We computed the ratios of geometric means of grade III samples versus geometric means of grade I samples. Logarithm of these ratios (base 2) were stored in geneList dataset. 3.2 WikiPathways analysis In contrast to KEGG, WikiPathways is a continuously updated pathway database curated by a community of researchers and pathway enthusiasts. WikiPathways produces monthly releases of gmt files for supported organisms at data.wikipathways.org. Download the appropriate gmt file and then generate TERM2GENE and TERM2NAME to use enricher and GSEA functions. library(magrittr) data(geneList, package=&quot;DOSE&quot;) gene &lt;- names(geneList)[abs(geneList) &gt; 2] wpgmtfile &lt;- system.file(&quot;extdata&quot;, &quot;wikipathways-20180810-gmt-Homo_sapiens.gmt&quot;, package=&quot;clusterProfiler&quot;) wp2gene &lt;- read.gmt(wpgmtfile) wp2gene &lt;- wp2gene %&gt;% tidyr::separate(ont, c(&quot;name&quot;,&quot;version&quot;,&quot;wpid&quot;,&quot;org&quot;), &quot;%&quot;) wpid2gene &lt;- wp2gene %&gt;% dplyr::select(wpid, gene) #TERM2GENE wpid2name &lt;- wp2gene %&gt;% dplyr::select(wpid, name) #TERM2NAME ewp &lt;- enricher(gene, TERM2GENE = wpid2gene, TERM2NAME = wpid2name) ewp &lt;- setReadable(ewp, org.Hs.eg.db, keytype = &quot;ENTREZID&quot;) head(ewp) ## ID ## WP2446 WP2446 ## WP2361 WP2361 ## WP179 WP179 ## WP3942 WP3942 ## WP4240 WP4240 ## WP2328 WP2328 ## Description ## WP2446 Retinoblastoma (RB) in Cancer ## WP2361 Gastric Cancer Network 1 ## WP179 Cell Cycle ## WP3942 PPAR signaling pathway ## WP4240 Regulation of sister chromatid separation at the metaphase-anaphase transition ## WP2328 Allograft Rejection ## GeneRatio BgRatio pvalue p.adjust ## WP2446 11/95 88/6249 6.801697e-08 1.054263e-05 ## WP2361 6/95 29/6249 3.772735e-06 2.923870e-04 ## WP179 10/95 122/6249 1.384549e-05 7.153503e-04 ## WP3942 7/95 67/6249 6.210513e-05 2.406574e-03 ## WP4240 4/95 16/6249 7.931988e-05 2.458916e-03 ## WP2328 7/95 90/6249 4.016758e-04 1.037663e-02 ## qvalue ## WP2446 9.450779e-06 ## WP2361 2.621058e-04 ## WP179 6.412648e-04 ## WP3942 2.157336e-03 ## WP4240 2.204258e-03 ## WP2328 9.301967e-03 ## geneID ## WP2446 CDC45/CCNB2/TOP2A/RRM2/CCNA2/CDK1/CDT1/TTK/CHEK1/CCNB1/KIF4A ## WP2361 MYBL2/TOP2A/UBE2C/TPX2/S100P/AURKA ## WP179 CDC45/CDC20/CCNB2/CCNA2/CDK1/TTK/CHEK1/CCNB1/MCM5/PTTG1 ## WP3942 MMP1/FADS2/ADIPOQ/PCK1/FABP4/HMGCS2/PLIN1 ## WP4240 CDC20/CENPE/MAD2L1/PTTG1 ## WP2328 CXCL13/CXCL11/CXCL9/GZMB/GNLY/HLA-DQA1/C7 ## Count ## WP2446 11 ## WP2361 6 ## WP179 10 ## WP3942 7 ## WP4240 4 ## WP2328 7 ewp2 &lt;- GSEA(geneList, TERM2GENE = wpid2gene, TERM2NAME = wpid2name, verbose=FALSE) ewp2 &lt;- setReadable(ewp2, org.Hs.eg.db, keytype = &quot;ENTREZID&quot;) head(ewp2) ## ID ## WP3932 WP3932 ## WP306 WP306 ## WP236 WP236 ## WP474 WP474 ## WP2911 WP2911 ## WP4240 WP4240 ## Description ## WP3932 Focal Adhesion-PI3K-Akt-mTOR-signaling pathway ## WP306 Focal Adhesion ## WP236 Adipogenesis ## WP474 Endochondral Ossification ## WP2911 miRNA targets in ECM and membrane receptors ## WP4240 Regulation of sister chromatid separation at the metaphase-anaphase transition ## setSize enrichmentScore NES pvalue ## WP3932 281 -0.3903410 -1.658138 0.001290323 ## WP306 188 -0.4230017 -1.712361 0.001388889 ## WP236 125 -0.4387536 -1.683644 0.001434720 ## WP474 59 -0.5111776 -1.755128 0.001479290 ## WP2911 21 -0.6953475 -1.912399 0.001642036 ## WP4240 14 0.8420478 2.236678 0.002369668 ## p.adjust qvalues rank ## WP3932 0.03579905 0.02945953 1994 ## WP306 0.03579905 0.02945953 2221 ## WP236 0.03579905 0.02945953 2301 ## WP474 0.03579905 0.02945953 2142 ## WP2911 0.03579905 0.02945953 2629 ## WP4240 0.03579905 0.02945953 360 ## leading_edge ## WP3932 tags=26%, list=16%, signal=22% ## WP306 tags=28%, list=18%, signal=23% ## WP236 tags=34%, list=18%, signal=28% ## WP474 tags=47%, list=17%, signal=40% ## WP2911 tags=76%, list=21%, signal=60% ## WP4240 tags=50%, list=3%, signal=49% ## core_enrichment ## WP3932 THBS3/CAB39/IRS2/PRKAA2/PIK3R1/STK11/COL4A6/TEK/LAMA4/TNC/HGF/KDR/COL11A1/CDKN1B/CREB3L1/INSR/CHRM2/EIF4B/VWF/ITGAV/EPAS1/EFNA1/F2R/COL2A1/NGFR/ITGA3/FGFR3/TSC1/FGF1/NGF/FGF14/LAMB1/LPAR1/FOXO1/COL1A2/COL1A1/CAB39L/LPAR4/EPOR/FGF2/COL3A1/COL5A3/COL5A2/GNG12/PRLR/THBS2/LPAR6/PDGFC/ITGB5/KITLG/SREBF1/IGF1R/PDGFRB/LIPE/COL5A1/COL6A2/LAMA2/GHR/LAMA3/FGF18/IKBKB/GNG11/TNN/LAMB2/IRS1/ITGA7/THBS4/IGF1/PDGFD/COMP/CHAD/FOXA1 ## WP306 MAPK3/PGF/VEGFC/CTNNB1/MYL5/TLN2/THBS3/PIK3R1/COL4A6/PIP5K1C/LAMA4/TNC/HGF/ARHGAP5/KDR/VWF/BCL2/ITGAV/COL2A1/ITGA3/CCND1/FLNC/LAMB1/DOCK1/COL1A2/PTK6/COL1A1/MYL9/PARVA/COL5A3/COL5A2/FLNB/THBS2/SHC2/PDGFC/ITGB5/IGF1R/PDGFRB/CAV1/COL6A2/LAMA2/LAMA3/TNN/LAMB2/ITGA7/THBS4/IGF1/VAV3/PDGFD/COMP/CHAD ## WP236 FZD1/RB1/KLF7/CTNNB1/NR3C1/SMAD3/IRS2/ID3/STAT6/NCOA1/RXRG/GDF10/RARA/STAT5A/EPAS1/AHR/NRIP1/NDN/MEF2C/FOXO1/PPARG/SPOCK1/LPL/CYP26A1/UCP1/WNT5B/LEP/CFD/PRLR/SREBF1/LIPE/FRZB/IRS1/IL6ST/IGF1/SFRP4/ADIPOQ/PCK1/BMP4/PLIN1/GATA3 ## WP474 DDR2/CAB39/RUNX2/PTH1R/CDKN1C/COL2A1/FGFR3/MGP/TGFB2/MEF2C/MMP13/IFT88/TIMP3/FGF2/ADAMTS5/SCIN/IGF1R/GHR/FGF18/ENPP1/GLI3/PTHLH/FRZB/PLAT/COL10A1/CST5/IGF1 ## WP2911 ITGA1/THBS1/LAMC1/LAMA4/COL6A1/COL1A2/COL6A3/COL3A1/COL5A3/COL5A2/THBS2/ITGB5/COL5A1/COL6A2/LAMB2 ## WP4240 CDC20/CENPE/MAD2L1/PTTG1/BUB1B/ESPL1/BUB1 As an alternative to manually downloading gmt files, install the rWikiPathways package to gain scripting access to the latest gmt files using the downloadPathwayArchive function. "],
["chapter4.html", "Chapter 4 Disease analysis 4.1 enrichDO function 4.2 enrichNCG function 4.3 enrichDGN and enrichDGNv functions 4.4 gseDO fuction 4.5 gseNCG fuction 4.6 gseDGN fuction", " Chapter 4 Disease analysis DOSE(Yu et al. 2015) supports Disease Ontology (DO) Semantic and Enrichment analysis. The enrichDO function is very useful for identifying disease association of interesting genes, and function gseDO function is designed for gene set enrichment analysis of DO. In addition, DOSE also supports enrichment analysis of Network of Cancer Gene (NCG)(A. et al. 2016) and Disease Gene Network(Janet et al. 2015), please refer to the DOSE vignettes. 4.1 enrichDO function In the following example, we selected fold change above 1 as the differential genes and analyzing their disease association. library(DOSE) data(geneList) gene &lt;- names(geneList)[abs(geneList) &gt; 1.5] head(gene) ## [1] &quot;4312&quot; &quot;8318&quot; &quot;10874&quot; &quot;55143&quot; &quot;55388&quot; &quot;991&quot; x &lt;- enrichDO(gene = gene, ont = &quot;DO&quot;, pvalueCutoff = 0.05, pAdjustMethod = &quot;BH&quot;, universe = names(geneList), minGSSize = 5, maxGSSize = 500, qvalueCutoff = 0.05, readable = FALSE) head(x) ## ID Description ## DOID:170 DOID:170 endocrine gland cancer ## DOID:10283 DOID:10283 prostate cancer ## DOID:3459 DOID:3459 breast carcinoma ## DOID:3856 DOID:3856 male reproductive organ cancer ## DOID:824 DOID:824 periodontitis ## DOID:3905 DOID:3905 lung carcinoma ## GeneRatio BgRatio pvalue p.adjust ## DOID:170 48/331 472/6268 5.662129e-06 0.004784499 ## DOID:10283 40/331 394/6268 3.859157e-05 0.013921739 ## DOID:3459 37/331 357/6268 4.942629e-05 0.013921739 ## DOID:3856 40/331 404/6268 6.821467e-05 0.014410349 ## DOID:824 16/331 109/6268 1.699304e-04 0.018859464 ## DOID:3905 43/331 465/6268 1.749754e-04 0.018859464 ## qvalue ## DOID:170 0.003826407 ## DOID:10283 0.011133923 ## DOID:3459 0.011133923 ## DOID:3856 0.011524689 ## DOID:824 0.015082872 ## DOID:3905 0.015082872 ## geneID ## DOID:170 10874/7153/1381/6241/11065/10232/332/6286/2146/10112/891/9232/4171/993/5347/4318/3576/1515/4821/8836/3159/7980/5888/333/898/9768/4288/3551/2152/9590/185/7043/3357/2952/5327/3667/1634/1287/4582/7122/3479/4680/6424/80310/652/8839/9547/1524 ## DOID:10283 4312/6280/6279/597/3627/332/6286/2146/4321/4521/891/5347/4102/4318/701/3576/79852/10321/6352/4288/3551/2152/247/2952/3487/367/3667/4128/4582/563/3679/4117/7031/3479/6424/10451/80310/652/4036/10551 ## DOID:3459 4312/6280/6279/7153/4751/890/4085/332/6286/6790/891/9232/10855/4171/5347/4318/701/2633/3576/9636/898/8792/4288/2952/4982/4128/4582/7031/3479/771/4250/2066/3169/10647/5304/5241/10551 ## DOID:3856 4312/6280/6279/597/3627/332/6286/2146/4321/4521/891/5347/4102/4318/701/3576/79852/10321/6352/4288/3551/2152/247/2952/3487/367/3667/4128/4582/563/3679/4117/7031/3479/6424/10451/80310/652/4036/10551 ## DOID:824 4312/6279/820/7850/4321/3595/4318/4069/3576/1493/6352/8842/185/2952/5327/4982 ## DOID:3905 4312/6280/2305/9133/6279/7153/6278/6241/55165/11065/8140/10232/332/6286/3002/9212/4521/891/4171/9928/8061/4318/3576/1978/1894/7980/7083/898/6352/8842/4288/2152/2697/2952/3572/4582/7049/563/3479/1846/3117/2532/2922 ## Count ## DOID:170 48 ## DOID:10283 40 ## DOID:3459 37 ## DOID:3856 40 ## DOID:824 16 ## DOID:3905 43 The enrichDO function requires an entrezgene ID vector as input, mostly is the differential gene list of gene expression profile studies. If user needs to convert other gene ID type to entrezgene ID, we recommend using bitr function provided by clusterProfiler. The ont parameter can be “DO” or “DOLite”, DOLite(Du et al. 2009) was constructed to aggregate the redundant DO terms. The DOLite data is not updated, we recommend user use ont=\"DO\". pvalueCutoff setting the cutoff value of p value and p value adjust; pAdjustMethod setting the p value correction methods, include the Bonferroni correction (“bonferroni”), Holm (“holm”), Hochberg (“hochberg”), Hommel (“hommel”), Benjamini &amp; Hochberg (“BH”) and Benjamini &amp; Yekutieli (“BY”) while qvalueCutoff is used to control q-values. The universe setting the background gene universe for testing. If user do not explicitly setting this parameter, enrichDO will set the universe to all human genes that have DO annotation. The minGSSize (and maxGSSize) indicates that only those DO terms that have more than minGSSize (and less than maxGSSize) genes annotated will be tested. The readable is a logical parameter, indicates whether the entrezgene IDs will mapping to gene symbols or not. We also implement setReadable function that helps the user to convert entrezgene IDs to gene symbols. x &lt;- setReadable(x, &#39;org.Hs.eg.db&#39;) head(x) ## ID Description ## DOID:170 DOID:170 endocrine gland cancer ## DOID:10283 DOID:10283 prostate cancer ## DOID:3459 DOID:3459 breast carcinoma ## DOID:3856 DOID:3856 male reproductive organ cancer ## DOID:824 DOID:824 periodontitis ## DOID:3905 DOID:3905 lung carcinoma ## GeneRatio BgRatio pvalue p.adjust ## DOID:170 48/331 472/6268 5.662129e-06 0.004784499 ## DOID:10283 40/331 394/6268 3.859157e-05 0.013921739 ## DOID:3459 37/331 357/6268 4.942629e-05 0.013921739 ## DOID:3856 40/331 404/6268 6.821467e-05 0.014410349 ## DOID:824 16/331 109/6268 1.699304e-04 0.018859464 ## DOID:3905 43/331 465/6268 1.749754e-04 0.018859464 ## qvalue ## DOID:170 0.003826407 ## DOID:10283 0.011133923 ## DOID:3459 0.011133923 ## DOID:3856 0.011524689 ## DOID:824 0.015082872 ## DOID:3905 0.015082872 ## geneID ## DOID:170 NMU/TOP2A/CRABP1/RRM2/UBE2C/MSLN/BIRC5/S100P/EZH2/KIF20A/CCNB1/PTTG1/MCM2/CDC25A/PLK1/MMP9/CXCL8/CTSV/NKX2-2/GGH/HMGA1/TFPI2/RAD51/APLP1/CCNE1/PCLAF/MKI67/IKBKB/F3/AKAP12/AGTR1/TGFB3/HTR2B/GSTT1/PLAT/IRS1/DCN/COL4A5/MUC1/CLDN5/IGF1/CEACAM6/SFRP4/PDGFD/BMP4/WISP2/CXCL14/CX3CR1 ## DOID:10283 MMP1/S100A9/S100A8/BCL2A1/CXCL10/BIRC5/S100P/EZH2/MMP12/NUDT1/CCNB1/PLK1/MAGEA3/MMP9/BUB1B/CXCL8/EPHX3/CRISP3/CCL5/MKI67/IKBKB/F3/ALOX15B/GSTT1/IGFBP4/AR/IRS1/MAOA/MUC1/AZGP1/ITGA7/MAK/TFF1/IGF1/SFRP4/VAV3/PDGFD/BMP4/LRP2/AGR2 ## DOID:3459 MMP1/S100A9/S100A8/TOP2A/NEK2/CCNA2/MAD2L1/BIRC5/S100P/AURKA/CCNB1/PTTG1/HPSE/MCM2/PLK1/MMP9/BUB1B/GBP1/CXCL8/ISG15/CCNE1/TNFRSF11A/MKI67/GSTT1/TNFRSF11B/MAOA/MUC1/TFF1/IGF1/CA12/SCGB2A2/ERBB4/FOXA1/SCGB1D2/PIP/PGR/AGR2 ## DOID:3856 MMP1/S100A9/S100A8/BCL2A1/CXCL10/BIRC5/S100P/EZH2/MMP12/NUDT1/CCNB1/PLK1/MAGEA3/MMP9/BUB1B/CXCL8/EPHX3/CRISP3/CCL5/MKI67/IKBKB/F3/ALOX15B/GSTT1/IGFBP4/AR/IRS1/MAOA/MUC1/AZGP1/ITGA7/MAK/TFF1/IGF1/SFRP4/VAV3/PDGFD/BMP4/LRP2/AGR2 ## DOID:824 MMP1/S100A8/CAMP/IL1R2/MMP12/IL12RB2/MMP9/LYZ/CXCL8/CTLA4/CCL5/PROM1/AGTR1/GSTT1/PLAT/TNFRSF11B ## DOID:3905 MMP1/S100A9/FOXM1/CCNB2/S100A8/TOP2A/S100A7/RRM2/CEP55/UBE2C/SLC7A5/MSLN/BIRC5/S100P/GZMB/AURKB/NUDT1/CCNB1/MCM2/KIF14/FOSL1/MMP9/CXCL8/EIF4EBP1/ECT2/TFPI2/TK1/CCNE1/CCL5/PROM1/MKI67/F3/GJA1/GSTT1/IL6ST/MUC1/TGFBR3/AZGP1/IGF1/DUSP4/HLA-DQA1/ACKR1/GRP ## Count ## DOID:170 48 ## DOID:10283 40 ## DOID:3459 37 ## DOID:3856 40 ## DOID:824 16 ## DOID:3905 43 4.2 enrichNCG function Network of Cancer Gene (NCG)(A. et al. 2016) is a manually curated repository of cancer genes. NCG release 5.0 (Aug. 2015) collects 1,571 cancer genes from 175 published studies. DOSE supports analyzing gene list and determine whether they are enriched in genes known to be mutated in a given cancer type. gene2 &lt;- names(geneList)[abs(geneList) &lt; 3] ncg &lt;- enrichNCG(gene2) head(ncg) ## ID ## soft_tissue_sarcomas soft_tissue_sarcomas ## bladder bladder ## glioma glioma ## Description GeneRatio BgRatio ## soft_tissue_sarcomas soft_tissue_sarcomas 28/1172 28/1571 ## bladder bladder 61/1172 67/1571 ## glioma glioma 68/1172 76/1571 ## pvalue p.adjust qvalue ## soft_tissue_sarcomas 0.0002517511 0.008056037 0.006360029 ## bladder 0.0005108168 0.008173069 0.006452423 ## glioma 0.0008511747 0.009079196 0.007167787 ## geneID ## soft_tissue_sarcomas 1029/999/6850/4914/4342/2185/55294/2041/4851/23512/2044/4058/5290/8726/4486/5297/5728/3815/2324/7403/5925/4763/1499/7157/5159/2045/3667/2066 ## bladder 9700/2175/9603/1029/8997/688/1026/896/677/6256/55294/8085/4851/3265/1999/3845/8243/10605/8295/4854/5290/2033/4780/23224/23217/2064/23385/55252/10735/4853/387/288/30849/9794/7403/287/463/472/4297/2065/2262/8289/9611/5925/2068/4763/7157/2186/1387/3910/2261/7248/23037/23345/7832/79633/10628/22906/388/4036/3169 ## glioma 4603/4609/1029/3418/8877/1019/7027/4613/1030/1956/1106/2264/3417/6597/4914/55359/896/894/2321/3954/5335/5781/8439/673/9444/4851/8087/2050/8493/3845/3482/667/56999/5290/2033/4233/577/5894/5156/80036/9407/3020/1021/5598/5728/8621/1828/63035/23592/8880/2260/54880/4916/2263/1639/90/546/8289/4763/7157/23152/5295/4602/595/2261/6938/4915/26137 ## Count ## soft_tissue_sarcomas 28 ## bladder 61 ## glioma 68 4.3 enrichDGN and enrichDGNv functions DisGeNET(Janet et al. 2015) is an integrative and comprehensive resources of gene-disease associations from several public data sources and the literature. It contains gene-disease associations and snp-gene-disease associations. The enrichment analysis of disease-gene associations is supported by the enrichDGN function and analysis of snp-gene-disease associations is supported by the enrichDGNv function. dgn &lt;- enrichDGN(gene) head(dgn) ## ID ## umls:C1134719 umls:C1134719 ## umls:C0032460 umls:C0032460 ## umls:C0206698 umls:C0206698 ## umls:C0007138 umls:C0007138 ## umls:C0031099 umls:C0031099 ## umls:C0005695 umls:C0005695 ## Description GeneRatio ## umls:C1134719 Invasive Ductal Breast Carcinoma 28/476 ## umls:C0032460 Polycystic Ovary Syndrome 38/476 ## umls:C0206698 Cholangiocarcinoma 36/476 ## umls:C0007138 Carcinoma, Transitional Cell 35/476 ## umls:C0031099 Periodontitis 28/476 ## umls:C0005695 Bladder Neoplasm 36/476 ## BgRatio pvalue p.adjust ## umls:C1134719 231/17381 4.312190e-11 1.225524e-07 ## umls:C0032460 434/17381 2.819624e-10 3.521620e-07 ## umls:C0206698 399/17381 3.717403e-10 3.521620e-07 ## umls:C0007138 389/17381 7.093837e-10 5.040171e-07 ## umls:C0031099 270/17381 1.634417e-09 9.290027e-07 ## umls:C0005695 442/17381 5.871618e-09 2.781190e-06 ## qvalue ## umls:C1134719 9.164539e-08 ## umls:C0032460 2.633487e-07 ## umls:C0206698 2.633487e-07 ## umls:C0007138 3.769068e-07 ## umls:C0031099 6.947133e-07 ## umls:C0005695 2.079789e-06 ## geneID ## umls:C1134719 9133/7153/6241/55165/11065/51203/22974/4751/5080/332/2568/3902/6790/891/24137/9232/10855/79801/4318/55635/5888/1493/9768/3070/4288/367/4582/5241 ## umls:C0032460 4312/6280/6279/7153/259266/6241/55165/55872/4085/6286/7272/366/891/4171/7941/1164/3161/4603/990/29127/4318/53335/3294/3070/2952/5327/367/3667/4582/563/27324/3479/114899/9370/2167/652/5346/5241 ## umls:C0206698 4312/2305/55872/4751/8140/10635/10232/5918/332/6286/2146/4521/891/10855/2921/7941/1164/4318/3576/1978/79852/8842/4485/214/65982/6863/1036/6935/4128/3572/4582/7031/7166/4680/80310/9 ## umls:C0007138 4312/991/6280/6241/55165/10460/6373/8140/890/10232/4085/332/6286/2146/4171/1033/6364/5347/4318/3576/8836/9700/898/4288/2952/367/8382/2947/3479/9338/23158/2167/2066/2625/9 ## umls:C0031099 4312/6279/3669/820/7850/332/4321/6364/3595/4318/3576/3898/8792/1493/4485/10472/185/6863/2205/2952/5327/4982/23261/2200/3572/2006/1308/2625 ## umls:C0005695 4312/10874/6280/3868/6279/597/7153/6241/9582/10460/4085/5080/332/2146/6790/10855/4171/5347/4318/3576/8836/9636/9700/898/4288/214/2952/367/2947/4582/3479/6424/9338/2066/1580/9 ## Count ## umls:C1134719 28 ## umls:C0032460 38 ## umls:C0206698 36 ## umls:C0007138 35 ## umls:C0031099 28 ## umls:C0005695 36 snp &lt;- c(&quot;rs1401296&quot;, &quot;rs9315050&quot;, &quot;rs5498&quot;, &quot;rs1524668&quot;, &quot;rs147377392&quot;, &quot;rs841&quot;, &quot;rs909253&quot;, &quot;rs7193343&quot;, &quot;rs3918232&quot;, &quot;rs3760396&quot;, &quot;rs2231137&quot;, &quot;rs10947803&quot;, &quot;rs17222919&quot;, &quot;rs386602276&quot;, &quot;rs11053646&quot;, &quot;rs1805192&quot;, &quot;rs139564723&quot;, &quot;rs2230806&quot;, &quot;rs20417&quot;, &quot;rs966221&quot;) dgnv &lt;- enrichDGNv(snp) head(dgnv) ## ID ## umls:C3272363 umls:C3272363 ## umls:C0948008 umls:C0948008 ## umls:C0038454 umls:C0038454 ## umls:C0027051 umls:C0027051 ## umls:C0010054 umls:C0010054 ## umls:C0010068 umls:C0010068 ## Description GeneRatio ## umls:C3272363 Ischemic Cerebrovascular Accident 20/20 ## umls:C0948008 Ischemic stroke 20/20 ## umls:C0038454 Cerebrovascular accident 7/20 ## umls:C0027051 Myocardial Infarction 6/20 ## umls:C0010054 Coronary Arteriosclerosis 6/20 ## umls:C0010068 Coronary heart disease 6/20 ## BgRatio pvalue p.adjust ## umls:C3272363 141/46589 1.014503e-51 1.379725e-49 ## umls:C0948008 148/46589 2.867870e-51 1.950151e-49 ## umls:C0038454 243/46589 7.045680e-12 3.194042e-10 ## umls:C0027051 163/46589 6.222154e-11 1.889883e-09 ## umls:C0010054 166/46589 6.948100e-11 1.889883e-09 ## umls:C0010068 314/46589 3.198889e-09 7.250815e-08 ## qvalue ## umls:C3272363 1.922217e-50 ## umls:C0948008 2.716929e-50 ## umls:C0038454 4.449903e-11 ## umls:C0027051 2.632964e-10 ## umls:C0010054 2.632964e-10 ## umls:C0010068 1.010175e-08 ## geneID ## umls:C3272363 rs1401296/rs9315050/rs5498/rs1524668/rs147377392/rs841/rs909253/rs7193343/rs3918232/rs3760396/rs2231137/rs10947803/rs17222919/rs386602276/rs11053646/rs1805192/rs139564723/rs2230806/rs20417/rs966221 ## umls:C0948008 rs1401296/rs9315050/rs5498/rs1524668/rs147377392/rs841/rs909253/rs7193343/rs3918232/rs3760396/rs2231137/rs10947803/rs17222919/rs386602276/rs11053646/rs1805192/rs139564723/rs2230806/rs20417/rs966221 ## umls:C0038454 rs1524668/rs147377392/rs2231137/rs10947803/rs386602276/rs2230806/rs20417 ## umls:C0027051 rs5498/rs147377392/rs909253/rs11053646/rs1805192/rs20417 ## umls:C0010054 rs5498/rs147377392/rs11053646/rs1805192/rs2230806/rs20417 ## umls:C0010068 rs5498/rs147377392/rs11053646/rs1805192/rs2230806/rs20417 ## Count ## umls:C3272363 20 ## umls:C0948008 20 ## umls:C0038454 7 ## umls:C0027051 6 ## umls:C0010054 6 ## umls:C0010068 6 4.4 gseDO fuction In the following example, in order to speedup the compilation of this document, only gene sets with size above 120 were tested and only 100 permutations were performed. library(DOSE) data(geneList) y &lt;- gseDO(geneList, nPerm = 100, minGSSize = 120, pvalueCutoff = 0.2, pAdjustMethod = &quot;BH&quot;, verbose = FALSE) head(y, 3) ## ID ## DOID:5614 DOID:5614 ## DOID:9970 DOID:9970 ## DOID:0060037 DOID:0060037 ## Description ## DOID:5614 eye disease ## DOID:9970 obesity ## DOID:0060037 developmental disorder of mental health ## setSize enrichmentScore NES pvalue ## DOID:5614 450 -0.3125247 -1.392568 0.01265823 ## DOID:9970 289 -0.3316172 -1.406271 0.01315789 ## DOID:0060037 315 -0.3407349 -1.444643 0.01351351 ## p.adjust qvalues rank ## DOID:5614 0.08224201 0.04080395 1768 ## DOID:9970 0.08224201 0.04080395 1447 ## DOID:0060037 0.08224201 0.04080395 2313 ## leading_edge ## DOID:5614 tags=22%, list=14%, signal=19% ## DOID:9970 tags=20%, list=12%, signal=18% ## DOID:0060037 tags=24%, list=19%, signal=20% ## core_enrichment ## DOID:5614 3082/5914/2878/4153/3791/23247/1543/80184/6750/1958/2098/7450/596/9187/2034/482/948/1490/1280/3931/5737/4314/4881/2261/3426/187/629/6403/7042/6785/7507/2934/5176/4060/1277/7078/5950/2057/727/10516/4311/2247/1295/358/10203/2192/582/10218/57125/3485/585/1675/6310/2202/4313/2944/4254/3075/1501/2099/3480/4653/6387/3305/1471/857/4016/1909/4053/6678/1296/7033/4915/55812/1191/5654/10631/2152/2697/7043/2952/6935/2200/3572/7177/7031/3479/2006/10451/9370/771/3117/125/652/4693/5346/1524 ## DOID:9970 1490/7840/4887/4314/595/4018/6403/590/3087/866/66036/5919/5176/3953/5950/2638/2166/5243/5468/4023/3485/7350/3952/1149/585/1513/3489/79068/4671/4313/3625/9369/6720/7494/2099/3480/3991/6678/4915/5167/8228/165/367/4982/3667/4128/9607/3572/150/563/3479/9370/9122/5105/2167/5346/79689/5241 ## DOID:0060037 154/1760/9732/7337/5175/6532/4763/54806/9759/6326/1499/7157/221037/627/2908/3399/2571/3082/23503/3791/51265/27347/55650/596/3067/51185/7552/22829/23426/324/5021/4885/7248/8910/8604/3397/4208/3400/26470/553/3953/6812/64221/80208/5172/9037/3952/477/93664/3625/2944/6925/6594/7102/3908/2550/4915/4922/26960/1746/2697/6863/3913/2891/367/4128/150/7166/6505/5348/18/4129/9370/57502/4137/79083 4.5 gseNCG fuction ncg &lt;- gseNCG(geneList, nPerm = 100, minGSSize = 120, pvalueCutoff = 0.2, pAdjustMethod = &quot;BH&quot;, verbose = FALSE) ncg &lt;- setReadable(ncg, &#39;org.Hs.eg.db&#39;) head(ncg, 3) ## ID Description setSize enrichmentScore ## breast breast breast 133 -0.4869070 ## lung lung lung 173 -0.3880662 ## lymphoma lymphoma lymphoma 188 0.2999589 ## NES pvalue p.adjust qvalues rank ## breast -1.860746 0.01369863 0.04109589 0.02883922 2930 ## lung -1.515200 0.01369863 0.04109589 0.02883922 2775 ## lymphoma 1.347308 0.07142857 0.14285714 0.10025063 2087 ## leading_edge ## breast tags=33%, list=23%, signal=26% ## lung tags=31%, list=22%, signal=25% ## lymphoma tags=21%, list=17%, signal=18% ## core_enrichment ## breast KMT2A/ERBB3/SETD2/ARID1A/GPS2/NCOR1/RB1/MAP2K4/NF1/TP53/PIK3R1/STK11/CDKN1B/PTGFR/APC/CCND1/TRAF5/MAP3K1/ESR1/TBX3/FOXA1/GATA3 ## lung SETD2/ATXN3L/LRP1B/BRD3/ARID1A/INHBA/RB1/ADCY1/LYRM9/NF1/CTNNB1/TP53/SATB2/STK11/CTIF/CTNNA3/KDR/COL11A1/FLT3/APC/ADGRL3/FGFR3/NCAM2/DIP2C/APLNR/SLIT2/EPHA3/RUNX1T1/ZMYND10/ZFHX4/GLI3/TNN/PLSCR4/DACH1/ERBB4 ## lymphoma DUSP2/EZH2/PRDM1/MYC/ZWILCH/IKZF3/PLCG2/IDH2/HIST1H1C/MAGEC3/CD79B/ETV6/HIST1H1E/HIST1H1B/IRF8/CD28/SLC29A2/DUSP9/TNFAIP3/DNMT3A/SYK/TNF/BCR/HIST1H1D/DSC3/UBE2A/PABPC1 4.6 gseDGN fuction dgn &lt;- gseDGN(geneList, nPerm = 100, minGSSize = 120, pvalueCutoff = 0.2, pAdjustMethod = &quot;BH&quot;, verbose = FALSE) dgn &lt;- setReadable(dgn, &#39;org.Hs.eg.db&#39;) head(dgn, 3) ## ID Description setSize ## umls:C0029456 umls:C0029456 Osteoporosis 375 ## umls:C0151744 umls:C0151744 Myocardial Ischemia 418 ## umls:C0011570 umls:C0011570 Mental Depression 483 ## enrichmentScore NES pvalue p.adjust ## umls:C0029456 -0.3439046 -1.484552 0.01234568 0.127551 ## umls:C0151744 -0.3013524 -1.295949 0.01234568 0.127551 ## umls:C0011570 -0.2874181 -1.247231 0.01250000 0.127551 ## qvalues rank ## umls:C0029456 0.08413892 1766 ## umls:C0151744 0.08413892 2309 ## umls:C0011570 0.08413892 2587 ## leading_edge ## umls:C0029456 tags=23%, list=14%, signal=20% ## umls:C0151744 tags=26%, list=18%, signal=22% ## umls:C0011570 tags=25%, list=21%, signal=20% ## core_enrichment ## umls:C0029456 HGF/PTH1R/CYP1A1/JAG1/ROR2/FLT3/CUL9/EEF1A2/THSD4/BCL2/ITGAV/WIF1/GREM2/COL15A1/HPGDS/VGLL3/SLIT3/NRIP1/TMEM135/MGP/PLCL1/OSBPL1A/PIBF1/SELP/SPRY1/MMP13/ID4/SPP2/COL1A2/AOX1/ARHGEF3/GSN/TSC22D3/ATP1B1/NR5A2/ANKH/COL1A1/LEPR/THSD7A/GC/FGF2/PPARG/NOX4/ZNF266/GHRH/BHLHE40/SLC19A2/THBD/FLNB/KL/LEP/HSD17B4/CTSK/FTO/MMP2/ESR1/IGF1R/PTN/IRAK3/HSPA1L/CST3/GHR/SPARC/KDM4B/LRP1/INPP4B/BMPR1B/PTHLH/DPT/FRZB/GSTT1/AR/TNFRSF11B/IRS1/WLS/GSTM3/TGFBR3/TPH1/IGF1/SFRP4/CORIN/BMP4/CHAD/FOXA1/PGR ## umls:C0151744 ADRB2/HSPB1/ABCC6/ADD1/PECAM1/MAPK3/GRK5/VEGFC/AMPD1/AES/F7/HSPB2/ENTPD1/ID3/PRKAA2/ATP2B1/SOD3/PRKAB1/AMH/STAT6/RGCC/RXRG/GDF10/SLC9A1/HGF/SERPINA3/MBL2/KDR/EGR1/HSPB6/HBB/STAT5A/EEF1A2/VWF/BCL2/CD34/DUSP1/PRKG1/CD36/CTGF/MMP3/BECN1/NPR1/CCND1/GATM/LPA/EDIL3/RTN1/APLNR/PYGM/SELP/FGF1/NEDD4/ID1/ALDH6A1/FOXO1/SULT1A1/SNAP23/FGF2/DUSP6/ABCB1/PPARG/PDK4/SHH/HSPA2/BHLHE40/LPL/THBD/COL5A2/UGCG/KL/ADH1C/GSTM2/THBS2/PER2/ATXN1/MMP2/TXNIP/KITLG/CFH/ESR1/CXCL12/CIRBP/EDNRA/GHR/SPARC/GPD1L/ENPP1/ALB/F13A1/MEOX2/F3/AGTR1/ZEB1/TNFRSF11B/UCN/DCN/LTC4S/IL6ST/EPHX2/THBS4/IGF1/FXYD1/SFRP4/ELN/RAMP2/ADIPOQ/ADH1B/HMGCS2 ## umls:C0011570 ETS2/RGN/GRIA1/PTGS1/NLGN1/PDE4A/ADAMTS2/EHD3/NR5A1/SORCS3/A2M/KCNQ1/CRY1/ADRB2/FZD1/MYOM2/ADCY1/POU6F1/MAPK3/BICC1/SLC6A4/AHI1/TP53/DBP/SLC12A2/BDNF/NR3C1/SRSF5/PCLO/GABRA6/WWC1/IL5/GLUL/ELK3/GAD1/RARA/GRM5/ASAH1/IMPACT/CHRM2/WFS1/TSPAN31/ARGLU1/HP/PVALB/HTR1A/GPM6A/CYP2A6/DUSP1/NLGN4Y/F2R/CD36/DBH/BECN1/CCND1/PER3/OXTR/SGCE/CFB/CLASP2/LPAR1/NRP1/AVPR1B/ARSD/GC/FAAH/BHLHE41/FGF2/CD1C/ABCB1/PPARG/SRPX/RAPGEF3/CRHBP/CDH13/HSPA2/BHLHE40/PDE1A/LEP/FTO/PER2/ALPK1/GSTM1/DIXDC1/XBP1/TCF4/ESR1/IGF1R/NTF3/CACNA1C/NR3C2/SLC18A2/NTRK2/RAPGEF4/F3/AGTR1/TAC1/GSTT1/AR/UCN/FBN1/MAOA/CARTPT/TAT/ADRA2A/MUC1/TGFBR3/TPH1/IGF1/MAOB/ADIPOQ/TBC1D9/ADH1B/EMX2/MAPT/CRY2/GATA3/TFAP2B References "],
["chapter5.html", "Chapter 5 GO Analysis 5.1 Supported organisms 5.2 GO classification 5.3 GO over-representation test 5.4 GO Gene Set Enrichment Analysis 5.5 GO Semantic Similarity Analysis", " Chapter 5 GO Analysis 5.1 Supported organisms GO analyses (groupGO(), enrichGO() and gseGO()) support organisms that have an OrgDb object available. Bioconductor have already provide OrgDb for about 20 species. User can query OrgDb online by AnnotationHub or build their own by AnnotationForge. An example can be found in the vignette of GOSemSim. If user have GO annotation data (in data.frame format with first column of gene ID and second column of GO ID), they can use enricher() and gseGO() functions to perform over-representation test and gene set enrichment analysis. If genes are annotated by direction annotation, it should also annotated by its ancestor GO nodes (indirect annation). If user only has direct annotation, they can pass their annotation to buildGOmap function, which will infer indirection annotation and generate a data.frame that suitable for both enricher() and gseGO(). 5.2 GO classification In clusterProfiler, groupGO is designed for gene classification based on GO distribution at a specific level. Here we use dataset geneList provided by DOSE. Please refer to vignette of DOSE for more details. library(clusterProfiler) data(geneList, package=&quot;DOSE&quot;) gene &lt;- names(geneList)[abs(geneList) &gt; 2] gene.df &lt;- bitr(gene, fromType = &quot;ENTREZID&quot;, toType = c(&quot;ENSEMBL&quot;, &quot;SYMBOL&quot;), OrgDb = org.Hs.eg.db) head(gene.df) ## ENTREZID ENSEMBL SYMBOL ## 1 4312 ENSG00000196611 MMP1 ## 2 8318 ENSG00000093009 CDC45 ## 3 10874 ENSG00000109255 NMU ## 4 55143 ENSG00000134690 CDCA8 ## 5 55388 ENSG00000065328 MCM10 ## 6 991 ENSG00000117399 CDC20 ggo &lt;- groupGO(gene = gene, OrgDb = org.Hs.eg.db, ont = &quot;CC&quot;, level = 3, readable = TRUE) head(ggo) ## [1] ID Description Count GeneRatio ## [5] geneID ## &lt;0 rows&gt; (or 0-length row.names) The input parameters of gene is a vector of gene IDs (can be any ID type that supported by corresponding OrgDb). If readable is setting to TRUE, the input gene IDs will be converted to gene symbols. 5.3 GO over-representation test Over-representation test(Boyle et al. 2004) were implemented in clusterProfiler. For calculation details and explanation of paramters, please refer to the vignette of DOSE. ego &lt;- enrichGO(gene = gene, universe = names(geneList), OrgDb = org.Hs.eg.db, ont = &quot;CC&quot;, pAdjustMethod = &quot;BH&quot;, pvalueCutoff = 0.01, qvalueCutoff = 0.05, readable = TRUE) head(ego) ## ID ## GO:0005819 GO:0005819 ## GO:0005876 GO:0005876 ## GO:0000779 GO:0000779 ## GO:0072686 GO:0072686 ## GO:0000775 GO:0000775 ## GO:0000776 GO:0000776 ## Description ## GO:0005819 spindle ## GO:0005876 spindle microtubule ## GO:0000779 condensed chromosome, centromeric region ## GO:0072686 mitotic spindle ## GO:0000775 chromosome, centromeric region ## GO:0000776 kinetochore ## GeneRatio BgRatio pvalue p.adjust ## GO:0005819 25/202 262/11812 2.569986e-12 8.146855e-10 ## GO:0005876 12/202 45/11812 7.912518e-12 1.254134e-09 ## GO:0000779 15/202 91/11812 3.254384e-11 3.438799e-09 ## GO:0072686 14/202 84/11812 1.292642e-10 9.903693e-09 ## GO:0000775 18/202 156/11812 1.562097e-10 9.903693e-09 ## GO:0000776 15/202 106/11812 3.073022e-10 1.623580e-08 ## qvalue ## GO:0005819 7.520590e-10 ## GO:0005876 1.157726e-09 ## GO:0000779 3.174452e-09 ## GO:0072686 9.142376e-09 ## GO:0000775 9.142376e-09 ## GO:0000776 1.498772e-08 ## geneID ## GO:0005819 CDCA8/CDC20/KIF23/CENPE/ASPM/DLGAP5/SKA1/NUSAP1/TPX2/TACC3/NEK2/CDK1/MAD2L1/KIF18A/BIRC5/KIF11/TTK/AURKB/PRC1/KIFC1/KIF18B/KIF20A/AURKA/CCNB1/KIF4A ## GO:0005876 CENPE/SKA1/NUSAP1/CDK1/KIF18A/BIRC5/KIF11/AURKB/PRC1/KIF18B/AURKA/KIF4A ## GO:0000779 CENPE/NDC80/HJURP/SKA1/NEK2/CENPM/CENPN/ERCC6L/MAD2L1/CDT1/BIRC5/NCAPG/AURKB/AURKA/CCNB1 ## GO:0072686 KIF23/CENPE/ASPM/NUSAP1/TPX2/TACC3/CDK1/MAD2L1/KIF18A/KIF11/AURKB/KIFC1/KIF18B/AURKA ## GO:0000775 CDCA8/CENPE/NDC80/HJURP/SKA1/NEK2/CENPM/CENPN/ERCC6L/MAD2L1/KIF18A/CDT1/BIRC5/TTK/NCAPG/AURKB/AURKA/CCNB1 ## GO:0000776 CENPE/NDC80/HJURP/SKA1/NEK2/CENPM/CENPN/ERCC6L/MAD2L1/KIF18A/CDT1/BIRC5/TTK/AURKB/CCNB1 ## Count ## GO:0005819 25 ## GO:0005876 12 ## GO:0000779 15 ## GO:0072686 14 ## GO:0000775 18 ## GO:0000776 15 As I mentioned before, any gene ID type that supported in OrgDb can be directly used in GO analyses. User need to specify the keyType parameter to specify the input gene ID type. ego2 &lt;- enrichGO(gene = gene.df$ENSEMBL, OrgDb = org.Hs.eg.db, keyType = &#39;ENSEMBL&#39;, ont = &quot;CC&quot;, pAdjustMethod = &quot;BH&quot;, pvalueCutoff = 0.01, qvalueCutoff = 0.05) Gene ID can be mapped to gene Symbol by using paramter readable=TRUE or setReadable function. ego2 &lt;- setReadable(ego2, OrgDb = org.Hs.eg.db) 5.3.1 drop specific GO terms or level enrichGO test the whole GO corpus and enriched result may contains very general terms. With dropGO function, user can remove specific GO terms or GO level from results obtained from both enrichGO and compareCluster. 5.3.2 test GO at sepcific level enrichGO doesn’t contain parameter to restrict the test at specific GO level. Instead, we provide a function gofilter to restrict the result at specific GO level. It works with results obtained from both enrichGO and compareCluster. 5.3.3 reduce redundancy of enriched GO terms According to issue #28, I implement a simplify method to remove redundant GO terms obtained from enrichGO. An example can be found in the blog post. It internally call GOSemSim to calculate similarities among GO terms and remove those highly similar terms by keeping one representative term. The simplify method also works with both outputs from enrichGO and compareCluster. 5.4 GO Gene Set Enrichment Analysis A common approach in analyzing gene expression profiles was identifying differential expressed genes that are deemed interesting. The enrichment analysis we demonstrated previous were based on these differential expressed genes. This approach will find genes where the difference is large, but it will not detect a situation where the difference is small, but evidenced in coordinated way in a set of related genes. Gene Set Enrichment Analysis (GSEA)(Subramanian et al. 2005) directly addresses this limitation. All genes can be used in GSEA; GSEA aggregates the per gene statistics across genes within a gene set, therefore making it possible to detect situations where all genes in a predefined set change in a small but coordinated way. Since it is likely that many relevant phenotypic differences are manifested by small but consistent changes in a set of genes. For algorithm details, please refer to the vignette of DOSE. ego3 &lt;- gseGO(geneList = geneList, OrgDb = org.Hs.eg.db, ont = &quot;CC&quot;, nPerm = 1000, minGSSize = 100, maxGSSize = 500, pvalueCutoff = 0.05, verbose = FALSE) GSEA use permutation test, user can set nPerm for number of permutations. Only gene Set size in [minGSSize, maxGSSize] will be tested. If you have issues in preparing your own geneList, please refer to the wiki page. 5.5 GO Semantic Similarity Analysis GO semantic similarity can be calculated by GOSemSim(Yu et al. 2010). We can use it to cluster genes/proteins into different clusters based on their functional similarity and can also use it to measure the similarities among GO terms to reduce the redundancy of GO enrichment results. References "],
["chapter6.html", "Chapter 6 KEGG analysis 6.1 KEGG over-representation test 6.2 KEGG Gene Set Enrichment Analysis 6.3 KEGG Module over-representation test 6.4 KEGG Module Gene Set Enrichment Analysis", " Chapter 6 KEGG analysis The annotation package, KEGG.db, is not updated since 2012. It’s now pretty old and in clusterProfiler, enrichKEGG (for KEGG pathway) and enrichMKEGG (for KEGG module) supports downloading latest online version of KEGG data for enrichment analysis. Using KEGG.db is also supported by explicitly setting use_internal_data parameter to TRUE, but it’s not recommended. With this new feature, organism is not restricted to those supported in previous release, it can be any species that have KEGG annotation data available in KEGG database. User should pass abbreviation of academic name to the organism parameter. The full list of KEGG supported organisms can be accessed via http://www.genome.jp/kegg/catalog/org_list.html. clusterProfiler provides search_kegg_organism() function to help searching supported organisms. library(clusterProfiler) search_kegg_organism(&#39;ece&#39;, by=&#39;kegg_code&#39;) ## kegg_code scientific_name ## 366 ece Escherichia coli O157:H7 EDL933 (EHEC) ## common_name ## 366 &lt;NA&gt; ecoli &lt;- search_kegg_organism(&#39;Escherichia coli&#39;, by=&#39;scientific_name&#39;) dim(ecoli) ## [1] 65 3 head(ecoli) ## kegg_code scientific_name ## 361 eco Escherichia coli K-12 MG1655 ## 362 ecj Escherichia coli K-12 W3110 ## 363 ecd Escherichia coli K-12 DH10B ## 364 ebw Escherichia coli BW2952 ## 365 ecok Escherichia coli K-12 MDS42 ## 366 ece Escherichia coli O157:H7 EDL933 (EHEC) ## common_name ## 361 &lt;NA&gt; ## 362 &lt;NA&gt; ## 363 &lt;NA&gt; ## 364 &lt;NA&gt; ## 365 &lt;NA&gt; ## 366 &lt;NA&gt; 6.1 KEGG over-representation test data(geneList, package=&quot;DOSE&quot;) gene &lt;- names(geneList)[abs(geneList) &gt; 2] kk &lt;- enrichKEGG(gene = gene, organism = &#39;hsa&#39;, pvalueCutoff = 0.05) head(kk) ## ID Description ## hsa04110 hsa04110 Cell cycle ## hsa04114 hsa04114 Oocyte meiosis ## hsa04218 hsa04218 Cellular senescence ## hsa03320 hsa03320 PPAR signaling pathway ## hsa04914 hsa04914 Progesterone-mediated oocyte maturation ## GeneRatio BgRatio pvalue p.adjust ## hsa04110 11/90 124/7466 2.329645e-07 4.496215e-05 ## hsa04114 10/90 125/7466 2.224743e-06 2.146877e-04 ## hsa04218 10/90 160/7466 2.021192e-05 1.300300e-03 ## hsa03320 7/90 74/7466 2.731046e-05 1.317730e-03 ## hsa04914 7/90 99/7466 1.770785e-04 6.835231e-03 ## qvalue ## hsa04110 4.414065e-05 ## hsa04114 2.107652e-04 ## hsa04218 1.276543e-03 ## hsa03320 1.293654e-03 ## hsa04914 6.710344e-03 ## geneID ## hsa04110 8318/991/9133/890/983/4085/7272/1111/891/4174/9232 ## hsa04114 991/9133/983/4085/51806/6790/891/9232/3708/5241 ## hsa04218 2305/4605/9133/890/983/51806/1111/891/776/3708 ## hsa03320 4312/9415/9370/5105/2167/3158/5346 ## hsa04914 9133/890/983/4085/6790/891/5241 ## Count ## hsa04110 11 ## hsa04114 10 ## hsa04218 10 ## hsa03320 7 ## hsa04914 7 Input ID type can be kegg, ncbi-geneid, ncbi-proteinid or uniprot, an example can be found in the post. 6.2 KEGG Gene Set Enrichment Analysis kk2 &lt;- gseKEGG(geneList = geneList, organism = &#39;hsa&#39;, nPerm = 1000, minGSSize = 120, pvalueCutoff = 0.05, verbose = FALSE) head(kk2) ## ID Description setSize ## hsa04510 hsa04510 Focal adhesion 188 ## hsa04151 hsa04151 PI3K-Akt signaling pathway 322 ## hsa04062 hsa04062 Chemokine signaling pathway 166 ## hsa04218 hsa04218 Cellular senescence 143 ## hsa05152 hsa05152 Tuberculosis 162 ## hsa05164 hsa05164 Influenza A 154 ## enrichmentScore NES pvalue p.adjust ## hsa04510 -0.4188582 -1.703642 0.001375516 0.02141102 ## hsa04151 -0.3482755 -1.496620 0.002614379 0.02141102 ## hsa04062 0.3747836 1.647782 0.003311258 0.02141102 ## hsa04218 0.4153718 1.785318 0.003378378 0.02141102 ## hsa05152 0.3745153 1.635718 0.003389831 0.02141102 ## hsa05164 0.3674333 1.595588 0.003412969 0.02141102 ## qvalues rank leading_edge ## hsa04510 0.01330107 2183 tags=27%, list=17%, signal=23% ## hsa04151 0.01330107 1997 tags=23%, list=16%, signal=20% ## hsa04062 0.01330107 1298 tags=20%, list=10%, signal=19% ## hsa04218 0.01330107 1155 tags=17%, list=9%, signal=16% ## hsa05152 0.01330107 2823 tags=34%, list=23%, signal=27% ## hsa05164 0.01330107 2823 tags=35%, list=23%, signal=27% ## core_enrichment ## hsa04510 5228/7424/1499/4636/83660/7059/5295/1288/23396/3910/3371/3082/1291/394/3791/7450/596/3685/1280/3675/595/2318/3912/1793/1278/1277/1293/10398/55742/2317/7058/25759/56034/3693/3480/5159/857/1292/3908/3909/63923/3913/1287/3679/7060/3479/10451/80310/1311/1101 ## hsa04151 2252/7059/92579/5563/5295/6794/1288/7010/3910/3371/3082/1291/4602/3791/1027/90993/3441/3643/1129/2322/1975/7450/596/3685/1942/2149/1280/4804/3675/595/2261/7248/2246/4803/3912/1902/1278/1277/2846/2057/1293/2247/55970/5618/7058/10161/56034/3693/4254/3480/4908/5159/1292/3908/2690/3909/8817/9223/4915/3551/2791/63923/3913/9863/3667/1287/3679/7060/3479/80310/1311/5105/2066/1101 ## hsa04062 3627/10563/6373/4283/6362/6355/2921/6364/3576/6352/10663/1230/6772/6347/6351/3055/1237/1236/4067/6354/114/3702/6361/1794/1234/6367/6375/6374/2919/409/4793/2792/6360/5880 ## hsa04218 2305/4605/9133/890/983/51806/1111/891/993/3576/1978/898/9134/4609/1869/1029/22808/3804/1871/5499/91860/292/1019/11200/1875 ## hsa05152 820/51806/6772/64581/3126/3112/8767/3654/1054/1051/3458/1520/11151/1594/50617/54205/91860/8877/3329/637/3689/7096/2207/3929/4360/5603/929/533/3452/6850/7124/1509/3569/7097/1378/8772/64170/3119/843/2213/8625/3920/2215/3587/5594/3593/9103/3592/6300/9114/10333/3109/3108/1432/3552 ## hsa05164 3627/3576/56649/6352/4599/6772/6347/3838/3126/3112/5645/91543/5646/4938/4940/3458/64135/54205/2224/3383/4939/23586/4793/5603/3452/5604/7124/29107/3569/3119/9021/834/356/3310/5605/5610/5594/8480/4792/10379/5578/9641/5371/3593/10625/2932/3592/6300/3267/3109/5606/3108/1432/3552 6.3 KEGG Module over-representation test KEGG Module is a collection of manually defined function units. In some situation, KEGG Modules have a more straightforward interpretation. mkk &lt;- enrichMKEGG(gene = gene, organism = &#39;hsa&#39;) 6.4 KEGG Module Gene Set Enrichment Analysis mkk2 &lt;- gseMKEGG(geneList = geneList, species = &#39;hsa&#39;) "],
["chapter7.html", "Chapter 7 MSigDb analysis", " Chapter 7 MSigDb analysis The MSigDB is a collection of annotated gene sets, it include 8 major collections: H: hallmark gene sets C1: positional gene sets C2: curated gene sets C3: motif gene sets C4: computational gene sets C5: GO gene sets C6: oncogenic signatures C7: immunologic signatures Users can use enricher and GSEA function to analyze gene set collections downloaded from Molecular Signatures Database (MSigDb). clusterProfiler provides a function, read.gmt, to parse the gmt file into a TERM2GENE data.frame that is ready for both enricher and GSEA functions. data(geneList, package=&quot;DOSE&quot;) gene &lt;- names(geneList)[abs(geneList) &gt; 2] gmtfile &lt;- system.file(&quot;extdata&quot;, &quot;c5.cc.v5.0.entrez.gmt&quot;, package=&quot;clusterProfiler&quot;) c5 &lt;- read.gmt(gmtfile) egmt &lt;- enricher(gene, TERM2GENE=c5) head(egmt) ## ID ## SPINDLE SPINDLE ## MICROTUBULE_CYTOSKELETON MICROTUBULE_CYTOSKELETON ## CYTOSKELETAL_PART CYTOSKELETAL_PART ## SPINDLE_MICROTUBULE SPINDLE_MICROTUBULE ## MICROTUBULE MICROTUBULE ## CYTOSKELETON CYTOSKELETON ## Description GeneRatio ## SPINDLE SPINDLE 11/82 ## MICROTUBULE_CYTOSKELETON MICROTUBULE_CYTOSKELETON 16/82 ## CYTOSKELETAL_PART CYTOSKELETAL_PART 15/82 ## SPINDLE_MICROTUBULE SPINDLE_MICROTUBULE 5/82 ## MICROTUBULE MICROTUBULE 6/82 ## CYTOSKELETON CYTOSKELETON 16/82 ## BgRatio pvalue p.adjust ## SPINDLE 39/5270 7.667674e-12 5.214018e-10 ## MICROTUBULE_CYTOSKELETON 152/5270 8.449298e-10 2.872761e-08 ## CYTOSKELETAL_PART 235/5270 2.414879e-06 5.237096e-05 ## SPINDLE_MICROTUBULE 16/5270 3.080645e-06 5.237096e-05 ## MICROTUBULE 32/5270 7.740446e-06 1.052701e-04 ## CYTOSKELETON 367/5270 1.308357e-04 1.482805e-03 ## qvalue ## SPINDLE 4.197043e-10 ## MICROTUBULE_CYTOSKELETON 2.312439e-08 ## CYTOSKELETAL_PART 4.215619e-05 ## SPINDLE_MICROTUBULE 4.215619e-05 ## MICROTUBULE 8.473751e-05 ## CYTOSKELETON 1.193589e-03 ## geneID ## SPINDLE 991/9493/9787/22974/983/332/3832/7272/9055/6790/24137 ## MICROTUBULE_CYTOSKELETON 991/9493/9133/7153/9787/22974/4751/983/332/3832/7272/9055/6790/24137/4137/7802 ## CYTOSKELETAL_PART 991/9493/7153/9787/22974/4751/983/332/3832/7272/9055/6790/24137/4137/7802 ## SPINDLE_MICROTUBULE 983/332/3832/9055/24137 ## MICROTUBULE 983/332/3832/9055/24137/4137 ## CYTOSKELETON 991/9493/9133/7153/9787/22974/4751/983/332/3832/7272/9055/6790/24137/4137/7802 ## Count ## SPINDLE 11 ## MICROTUBULE_CYTOSKELETON 16 ## CYTOSKELETAL_PART 15 ## SPINDLE_MICROTUBULE 5 ## MICROTUBULE 6 ## CYTOSKELETON 16 egmt2 &lt;- GSEA(geneList, TERM2GENE=c5, verbose=FALSE) head(egmt2) ## ID ## EXTRACELLULAR_REGION EXTRACELLULAR_REGION ## EXTRACELLULAR_REGION_PART EXTRACELLULAR_REGION_PART ## PROTEINACEOUS_EXTRACELLULAR_MATRIX PROTEINACEOUS_EXTRACELLULAR_MATRIX ## EXTRACELLULAR_MATRIX EXTRACELLULAR_MATRIX ## CELL_PROJECTION CELL_PROJECTION ## EXTRACELLULAR_MATRIX_PART EXTRACELLULAR_MATRIX_PART ## Description ## EXTRACELLULAR_REGION EXTRACELLULAR_REGION ## EXTRACELLULAR_REGION_PART EXTRACELLULAR_REGION_PART ## PROTEINACEOUS_EXTRACELLULAR_MATRIX PROTEINACEOUS_EXTRACELLULAR_MATRIX ## EXTRACELLULAR_MATRIX EXTRACELLULAR_MATRIX ## CELL_PROJECTION CELL_PROJECTION ## EXTRACELLULAR_MATRIX_PART EXTRACELLULAR_MATRIX_PART ## setSize enrichmentScore ## EXTRACELLULAR_REGION 401 -0.3860230 ## EXTRACELLULAR_REGION_PART 310 -0.4101043 ## PROTEINACEOUS_EXTRACELLULAR_MATRIX 93 -0.6355317 ## EXTRACELLULAR_MATRIX 95 -0.6229461 ## CELL_PROJECTION 87 -0.4729701 ## EXTRACELLULAR_MATRIX_PART 54 -0.5908035 ## NES pvalue ## EXTRACELLULAR_REGION -1.695804 0.001253133 ## EXTRACELLULAR_REGION_PART -1.759038 0.001302083 ## PROTEINACEOUS_EXTRACELLULAR_MATRIX -2.380502 0.001501502 ## EXTRACELLULAR_MATRIX -2.335046 0.001512859 ## CELL_PROJECTION -1.750931 0.001533742 ## EXTRACELLULAR_MATRIX_PART -2.009953 0.001592357 ## p.adjust qvalues ## EXTRACELLULAR_REGION 0.03079365 0.02389307 ## EXTRACELLULAR_REGION_PART 0.03079365 0.02389307 ## PROTEINACEOUS_EXTRACELLULAR_MATRIX 0.03079365 0.02389307 ## EXTRACELLULAR_MATRIX 0.03079365 0.02389307 ## CELL_PROJECTION 0.03079365 0.02389307 ## EXTRACELLULAR_MATRIX_PART 0.03079365 0.02389307 ## rank ## EXTRACELLULAR_REGION 1797 ## EXTRACELLULAR_REGION_PART 1897 ## PROTEINACEOUS_EXTRACELLULAR_MATRIX 1473 ## EXTRACELLULAR_MATRIX 1473 ## CELL_PROJECTION 2280 ## EXTRACELLULAR_MATRIX_PART 1794 ## leading_edge ## EXTRACELLULAR_REGION tags=29%, list=14%, signal=26% ## EXTRACELLULAR_REGION_PART tags=32%, list=15%, signal=28% ## PROTEINACEOUS_EXTRACELLULAR_MATRIX tags=49%, list=12%, signal=44% ## EXTRACELLULAR_MATRIX tags=48%, list=12%, signal=43% ## CELL_PROJECTION tags=28%, list=18%, signal=23% ## EXTRACELLULAR_MATRIX_PART tags=59%, list=14%, signal=51% ## core_enrichment ## EXTRACELLULAR_REGION 3910/51162/2878/2717/3373/4153/10406/1301/6750/7474/4925/7450/80781/1490/1306/3931/4314/6586/3964/10272/8425/8082/11005/4256/3483/7482/8910/23037/27122/7042/3912/4322/167/2817/9353/6037/1278/2934/5176/4060/283/30008/5549/5950/22795/727/10516/23452/1293/2247/1295/1012/6469/2192/1281/4023/54360/50509/11167/4319/1290/9365/3952/10879/11096/2202/4313/3625/2199/6444/6320/1294/3075/4653/5764/3991/3263/1462/1289/3908/4016/3909/4053/8817/7033/8292/5125/2162/5744/1842/5654/10631/2331/3730/2487/347/6863/5104/3913/27123/4982/1300/2200/9607/1287/7060/1489/9723/6424/1307/1311/4693/4148/1101/2922/10647 ## EXTRACELLULAR_REGION_PART 268/3567/57124/3910/2878/3373/4153/10406/1301/6750/7474/4925/80781/1490/1306/3931/4314/6586/3964/10272/8425/8082/4256/3483/7482/8910/27122/3912/4322/167/2817/1278/4060/283/30008/5549/5950/22795/727/10516/23452/1293/2247/1295/1012/6469/2192/1281/54360/50509/11167/4319/1290/9365/3952/10879/11096/2202/4313/2199/6444/1294/3075/4653/5764/3991/3263/1462/1289/3908/3909/4053/8817/8292/5125/5744/1842/5654/10631/2331/3730/347/6863/3913/27123/1300/2200/9607/1287/7060/9723/6424/1307/1311/4693/4148/1101/2922/10647 ## PROTEINACEOUS_EXTRACELLULAR_MATRIX 1490/1306/8425/8082/4256/8910/3912/1278/4060/283/30008/5549/22795/10516/1293/1295/2192/1281/50509/4319/1290/11096/2202/2199/6444/1294/1462/1289/3908/3909/4053/8292/1842/10631/2331/3730/3913/1300/2200/1287/7060/1307/1311/4148/1101 ## EXTRACELLULAR_MATRIX 1490/1306/8425/8082/4256/8910/3912/1278/4060/283/30008/5549/22795/10516/1293/1295/2192/1281/50509/4319/1290/11096/2202/2199/6444/1294/1462/1289/3908/3909/4053/8292/1842/10631/2331/3730/3913/1300/2200/1287/7060/1307/1311/4148/1101 ## CELL_PROJECTION 4763/57147/64064/80184/322/54997/7248/5311/7042/323/4747/4744/1012/11346/2191/4741/4646/9576/114327/51466/27124/4137/7802 ## EXTRACELLULAR_MATRIX_PART 3915/6443/55914/3910/1301/80781/1306/8082/8910/3912/1278/4060/283/30008/22795/1293/1295/1281/50509/1290/6444/1294/1289/3908/3909/8292/3913/1300/2200/1287/1307 "],
["chapter8.html", "Chapter 8 Reactome pathway analysis", " Chapter 8 Reactome pathway analysis ReactomePA(Yu and He 2016) uses Reactome as a source of pathway data. The function call of enrichPathway and gsePathway in ReactomePA is consistent with enrichKEGG and gseKEGG. References "],
["chapter9.html", "Chapter 9 MeSH Enrichment Analysis", " Chapter 9 MeSH Enrichment Analysis "],
["chapter10.html", "Chapter 10 Functional enrichment analysis of genomic coordinations", " Chapter 10 Functional enrichment analysis of genomic coordinations Functional analysis using NGS data (eg, RNA-Seq and ChIP-Seq) can be performed by linking coding and non-coding regions to coding genes via ChIPseeker(Yu, Wang, and He 2015) package, which can annotates genomic regions to their nearest genes, host genes, and flanking genes respectivly. In addtion, it provides a function, seq2gene, that simultaneously considering host genes, promoter region and flanking gene from intergenic region that may under control via cis-regulation. This function maps genomic regions to genes in a many-to-many manner and facilitate functional analysis. For more details, please refer to ChIPseeker(Yu, Wang, and He 2015). References "],
["chapter11.html", "Chapter 11 Biological theme comparison 11.1 Formula interface of compareCluster 11.2 Visualization of profile comparison", " Chapter 11 Biological theme comparison clusterProfiler was developed for biological theme comparison(Yu et al. 2012), and it provides a function, compareCluster, to automatically calculate enriched functional categories of each gene clusters. data(gcSample) lapply(gcSample, head) ## $X1 ## [1] &quot;4597&quot; &quot;7111&quot; &quot;5266&quot; &quot;2175&quot; &quot;755&quot; &quot;23046&quot; ## ## $X2 ## [1] &quot;23450&quot; &quot;5160&quot; &quot;7126&quot; &quot;26118&quot; &quot;8452&quot; &quot;3675&quot; ## ## $X3 ## [1] &quot;894&quot; &quot;7057&quot; &quot;22906&quot; &quot;3339&quot; &quot;10449&quot; &quot;6566&quot; ## ## $X4 ## [1] &quot;5573&quot; &quot;7453&quot; &quot;5245&quot; &quot;23450&quot; &quot;6500&quot; &quot;4926&quot; ## ## $X5 ## [1] &quot;5982&quot; &quot;7318&quot; &quot;6352&quot; &quot;2101&quot; &quot;8882&quot; &quot;7803&quot; ## ## $X6 ## [1] &quot;5337&quot; &quot;9295&quot; &quot;4035&quot; &quot;811&quot; &quot;23365&quot; &quot;4629&quot; ## ## $X7 ## [1] &quot;2621&quot; &quot;2665&quot; &quot;5690&quot; &quot;3608&quot; &quot;3550&quot; &quot;533&quot; ## ## $X8 ## [1] &quot;2665&quot; &quot;4735&quot; &quot;1327&quot; &quot;3192&quot; &quot;5573&quot; &quot;9528&quot; The input for geneCluster parameter should be a named list of gene IDs. To speed up the compilation of this document, we set use_internal_data = TRUE. ck &lt;- compareCluster(geneCluster = gcSample, fun = &quot;enrichKEGG&quot;) head(as.data.frame(ck)) ## Cluster ID Description ## 1 X2 hsa04110 Cell cycle ## 2 X2 hsa05169 Epstein-Barr virus infection ## 3 X2 hsa05340 Primary immunodeficiency ## 4 X2 hsa04064 NF-kappa B signaling pathway ## 5 X2 hsa05166 Human T-cell leukemia virus 1 infection ## 6 X3 hsa04512 ECM-receptor interaction ## GeneRatio BgRatio pvalue p.adjust qvalue ## 1 18/359 124/7466 2.345201e-05 0.006754179 0.006369072 ## 2 23/359 201/7466 8.983513e-05 0.012936259 0.012198665 ## 3 8/359 37/7466 2.989529e-04 0.028699477 0.027063103 ## 4 13/359 95/7466 5.731543e-04 0.041267113 0.038914163 ## 5 22/359 219/7466 8.032625e-04 0.046267918 0.043629835 ## 6 9/172 82/7466 1.025478e-04 0.025739489 0.023963794 ## geneID ## 1 991/1869/890/1871/701/990/10926/9088/8317/9700/9134/1029/2810/699/11200/23594/8555/4173 ## 2 4067/3383/7128/1869/890/1871/578/864/637/9641/6891/355/9134/5971/916/956/6850/7187/3551/919/4734/958/6772 ## 3 100/6891/3932/973/916/925/958/64421 ## 4 4067/3383/7128/3932/5971/4050/6850/7187/3551/10892/5588/330/958 ## 5 3383/991/1869/890/1871/113/701/9700/3932/9134/5971/916/4487/3600/1029/3551/8498/4488/11200/4776/4214/958 ## 6 7057/3339/1299/3695/1101/3679/3910/3696/3693 ## Count ## 1 18 ## 2 23 ## 3 8 ## 4 13 ## 5 22 ## 6 9 11.1 Formula interface of compareCluster compareCluster also supports passing a formula (the code to support formula has been contributed by Giovanni Dall’Olio) of type \\(Entrez \\sim group\\) or \\(Entrez \\sim group + othergroup\\). mydf &lt;- data.frame(Entrez=names(geneList), FC=geneList) mydf &lt;- mydf[abs(mydf$FC) &gt; 1,] mydf$group &lt;- &quot;upregulated&quot; mydf$group[mydf$FC &lt; 0] &lt;- &quot;downregulated&quot; mydf$othergroup &lt;- &quot;A&quot; mydf$othergroup[abs(mydf$FC) &gt; 2] &lt;- &quot;B&quot; formula_res &lt;- compareCluster(Entrez~group+othergroup, data=mydf, fun=&quot;enrichKEGG&quot;) head(as.data.frame(formula_res)) ## Cluster group othergroup ID ## 1 downregulated.A downregulated A hsa04974 ## 2 downregulated.A downregulated A hsa04510 ## 3 downregulated.A downregulated A hsa04151 ## 4 downregulated.A downregulated A hsa04512 ## 5 downregulated.A downregulated A hsa05414 ## 6 downregulated.A downregulated A hsa04010 ## Description GeneRatio BgRatio ## 1 Protein digestion and absorption 15/281 90/7466 ## 2 Focal adhesion 20/281 199/7466 ## 3 PI3K-Akt signaling pathway 28/281 354/7466 ## 4 ECM-receptor interaction 11/281 82/7466 ## 5 Dilated cardiomyopathy (DCM) 11/281 90/7466 ## 6 MAPK signaling pathway 23/281 295/7466 ## pvalue p.adjust qvalue ## 1 1.067307e-06 0.0002774999 0.0002561538 ## 2 5.468991e-05 0.0071096885 0.0065627894 ## 3 1.444670e-04 0.0125204777 0.0115573640 ## 4 2.288339e-04 0.0148742017 0.0137300323 ## 5 5.207710e-04 0.0270800916 0.0249970077 ## 6 7.012623e-04 0.0303880331 0.0280504921 ## geneID ## 1 1281/50509/1290/477/1294/1360/1289/1292/23428/1359/1300/1287/6505/2006/7373 ## 2 55742/2317/7058/25759/56034/3693/3480/5159/857/1292/3908/3909/63923/3913/1287/3679/7060/3479/10451/80310 ## 3 55970/5618/7058/10161/56034/3693/4254/3480/4908/5159/1292/3908/2690/3909/8817/9223/4915/3551/2791/63923/3913/9863/3667/1287/3679/7060/3479/80310 ## 4 7058/3693/3339/1292/3908/3909/63923/3913/1287/3679/7060 ## 5 55799/27092/6444/3693/775/3908/5350/7043/3679/3479/9254 ## 6 55799/3306/2317/4214/55970/56034/27092/4254/3480/4908/3305/5159/775/8817/4915/3551/7786/7043/57551/3479/9254/1846/80310 ## Count ## 1 15 ## 2 20 ## 3 28 ## 4 11 ## 5 11 ## 6 23 11.2 Visualization of profile comparison We can visualize the result using dotplot method. dotplot(ck) dotplot(formula_res) dotplot(formula_res, x=~group) + ggplot2::facet_grid(~othergroup) By default, only top 5 (most significant) categories of each cluster was plotted. User can changes the parameter showCategory to specify how many categories of each cluster to be plotted, and if showCategory was set to NULL, the whole result will be plotted. The plot function accepts a parameter by for setting the scale of dot sizes. The default parameter by is setting to “geneRatio”, which corresponding to the “GeneRatio” column of the output. If it was setting to count, the comparison will be based on gene counts, while if setting to rowPercentage, the dot sizes will be normalized by count/(sum of each row) To provide the full information, we also provide number of identified genes in each category (numbers in parentheses) when by is setting to rowPercentage and number of gene clusters in each cluster label (numbers in parentheses) when by is setting to geneRatio, as shown in Figure 3. If the dot sizes were based on count, the row numbers will not shown. The p-values indicate that which categories are more likely to have biological meanings. The dots in the plot are color-coded based on their corresponding p-values. Color gradient ranging from red to blue correspond to in order of increasing p-values. That is, red indicate low p-values (high enrichment), and blue indicate high p-values (low enrichment). P-values and adjusted p-values were filtered out by the threshold giving by parameter pvalueCutoff, and FDR can be estimated by qvalue. User can refer to the example in Yu (2012)(Yu et al. 2012); we analyzed the publicly available expression dataset of breast tumour tissues from 200 patients (GSE11121, Gene Expression Omnibus)(Schmidt et al. 2008). We identified 8 gene clusters from differentially expressed genes, and using compareCluster to compare these gene clusters by their enriched biological process. The comparison function was designed as a framework for comparing gene clusters of any kind of ontology associations, not only groupGO, enrichGO, enrichKEGG and enricher provided in this package, but also other biological and biomedical ontologies, for instance, enrichDO from DOSE(Yu et al. 2015), enrichMeSH from meshes and enrichPathway from ReactomePA work fine with compareCluster for comparing biological themes in disease and reactome pathway perspective. More details can be found in the vignettes of DOSE(Yu et al. 2015) and ReactomePA. References "],
["chapter12.html", "Chapter 12 Visualization of Functional Enrichment Result 12.1 Bar Plot 12.2 Dot plot 12.3 Gene-Concept Network 12.4 Heatmap-like functional classification 12.5 Enrichment Map 12.6 UpSet Plot 12.7 ridgeline plot for expression distribution of GSEA result 12.8 running score and preranked list of GSEA result 12.9 pubmed trend of enriched terms 12.10 goplot 12.11 browseKEGG 12.12 pathview from pathview package", " Chapter 12 Visualization of Functional Enrichment Result The enrichplot package implements several visualization methods to help interpreting enrichment results. It supports visualizing enrichment results obtained from DOSE (Yu et al. 2015), clusterProfiler (???), ReactomePA (Yu and He 2016) and meshes. Both over representation analysis (ORA) and gene set enrichment analysis (GSEA) are supported. 12.1 Bar Plot Bar plot is the most widely used method to visualize enriched terms. It depicts the enrichment scores (e.g. p values) and gene count or ratio as bar height and color. library(DOSE) data(geneList) de &lt;- names(geneList)[abs(geneList) &gt; 2] edo &lt;- enrichDGN(de) library(enrichplot) barplot(edo, showCategory=20) 12.2 Dot plot Dot plot is similar to bar plot with the capability to encode another score as dot size. edo2 &lt;- gseNCG(geneList, nPerm=10000) p1 &lt;- dotplot(edo, showCategory=30) + ggtitle(&quot;dotplot for ORA&quot;) p2 &lt;- dotplot(edo2, showCategory=30) + ggtitle(&quot;dotplot for GSEA&quot;) plot_grid(p1, p2, ncol=2) Users can specify variable of x-axis, or using formual to specify derived variable. N &lt;- as.numeric(sub(&quot;\\\\d+/&quot;, &quot;&quot;, edo[1, &quot;BgRatio&quot;])) N ## [1] 17381 dotplot(edo, showCategory=15, x = ~Count/N) + ggplot2::xlab(&quot;Rich Factor&quot;) 12.3 Gene-Concept Network Both the barplot and dotplot only displayed most significant enriched terms, while users may want to know which genes are involved in these significant terms. In order to consider the potentially biological complexities in which a gene may belong to multiple annotation categories and provide information of numeric changes if available, we developed cnetplot function to extract the complex association. The cnetplot depicts the linkages of genes and biological concepts (e.g. GO terms or KEGG pathways) as a network. GSEA result is also supported with only core enriched genes displayed. ## convert gene ID to Symbol edox &lt;- setReadable(edo, &#39;org.Hs.eg.db&#39;, &#39;ENTREZID&#39;) cnetplot(edox, foldChange=geneList) ## categorySize can be scaled by &#39;pvalue&#39; or &#39;geneNum&#39; cnetplot(edox, categorySize=&quot;pvalue&quot;, foldChange=geneList) cnetplot(edox, foldChange=geneList, circular = TRUE, colorEdge = TRUE) 12.4 Heatmap-like functional classification The heatplot is similar to cnetplot, while displaying the relationships as a heatmap. The gene-concept network may become too complicated if user want to show a large number significant terms. The heatplot can simplify the result and more easy to identify expression patterns. heatplot(edox) heatplot(edox, foldChange=geneList) 12.5 Enrichment Map Enrichment map organizes enriched terms into a network with edges connecting overlapping gene sets. In this way, mutually overlapping gene sets are tend to cluster together, making it easy to identify functional module. The emapplot function supports results obtained from hypergeometric test and gene set enrichment analysis. emapplot(edo) 12.6 UpSet Plot The upsetplot is an alternative to cnetplot for visualizing the complex association between genes and gene sets. It emphasizes the gene overlapping among different gene sets. upsetplot(edo) 12.7 ridgeline plot for expression distribution of GSEA result The ridgeplot will visualize expression distributions of core enriched genes for GSEA enriched categories. It helps users to interpret up/down-regulated pathways. ridgeplot(edo2) 12.8 running score and preranked list of GSEA result Running score and preranked list are traditional methods for visualizing GSEA result. The enrichplot package supports both of them to visualize the distribution of the gene set and the enrichment score. gseaplot(edo2, geneSetID = 1, by = &quot;runningScore&quot;, title = edo2$Description[1]) gseaplot(edo2, geneSetID = 1, by = &quot;preranked&quot;, title = edo2$Description[1]) gseaplot(edo2, geneSetID = 1, title = edo2$Description[1]) Another method to plot GSEA result is the gseaplot2 function: gseaplot2(edo2, geneSetID = 1, title = edo2$Description[1]) The gseaplot2 also supports multile gene sets to be displayed on the same figure: gseaplot2(edo2, geneSetID = 1:3) User can also displaying the pvalue table on the plot via pvalue_table parameter: gseaplot2(edo2, geneSetID = 1:3, pvalue_table = TRUE, color = c(&quot;#E495A5&quot;, &quot;#86B875&quot;, &quot;#7DB0DD&quot;), ES_geom = &quot;dot&quot;) User can specify subplots to only display a subset of plots: gseaplot2(edo2, geneSetID = 1:3, subplots = 1) gseaplot2(edo2, geneSetID = 1:3, subplots = 1:2) The gsearank function plot the ranked list of genes belong to the specific gene set. gsearank(edo2, 1, title = edo2[1, &quot;Description&quot;]) Multiple gene sets can be aligned using cowplot: library(ggplot2) library(cowplot) pp &lt;- lapply(1:3, function(i) { anno &lt;- edo2[i, c(&quot;NES&quot;, &quot;pvalue&quot;, &quot;p.adjust&quot;)] lab &lt;- paste0(names(anno), &quot;=&quot;, round(anno, 3), collapse=&quot;\\n&quot;) gsearank(edo2, i, edo2[i, 2]) + xlab(NULL) +ylab(NULL) + annotate(&quot;text&quot;, 0, edo2[i, &quot;enrichmentScore&quot;] * .9, label = lab, hjust=0, vjust=0) }) plot_grid(plotlist=pp, ncol=1) 12.9 pubmed trend of enriched terms One of the problem of enrichment analysis is to find pathways for further investigation. Here, we provide pmcplot function to plot the number/proportion of publications trend based on the query result from PubMed Central. Of course, users can use pmcplot in other scenarios. All text that can be queried on PMC is valid as input of pmcplot. terms &lt;- edo$Description[1:3] p &lt;- pmcplot(terms, 2010:2017) p2 &lt;- pmcplot(terms, 2010:2017, proportion=FALSE) plot_grid(p, p2, ncol=2) 12.10 goplot goplot can accept output of enrichGO and visualized the enriched GO induced graph. goplot(ego) 12.11 browseKEGG To view the KEGG pathway, user can use browseKEGG function, which will open web browser and highlight enriched genes. browseKEGG(kk, &#39;hsa04110&#39;) 12.12 pathview from pathview package clusterProfiler users can also use pathview from the pathview(Luo and Brouwer 2013) to visualize KEGG pathway. The following example illustrate how to visualize “hsa04110” pathway, which was enriched in our previous analysis. library(&quot;pathview&quot;) hsa04110 &lt;- pathview(gene.data = geneList, pathway.id = &quot;hsa04110&quot;, species = &quot;hsa&quot;, limit = list(gene=max(abs(geneList)), cpd=1)) For further information, please refer to the vignette of pathview(Luo and Brouwer 2013). References "],
["chapter13.html", "Chapter 13 Useful utilities 13.1 bitr: Biological Id TranslatoR 13.2 setReadable: translating gene IDs to human readable symbols", " Chapter 13 Useful utilities 13.1 bitr: Biological Id TranslatoR clusterProfiler provides bitr and bitr_kegg for converting ID types. Both bitr and bitr_kegg support many species including model and many non-model organisms. x &lt;- c(&quot;GPX3&quot;, &quot;GLRX&quot;, &quot;LBP&quot;, &quot;CRYAB&quot;, &quot;DEFB1&quot;, &quot;HCLS1&quot;, &quot;SOD2&quot;, &quot;HSPA2&quot;, &quot;ORM1&quot;, &quot;IGFBP1&quot;, &quot;PTHLH&quot;, &quot;GPC3&quot;, &quot;IGFBP3&quot;,&quot;TOB1&quot;, &quot;MITF&quot;, &quot;NDRG1&quot;, &quot;NR1H4&quot;, &quot;FGFR3&quot;, &quot;PVR&quot;, &quot;IL6&quot;, &quot;PTPRM&quot;, &quot;ERBB2&quot;, &quot;NID2&quot;, &quot;LAMB1&quot;, &quot;COMP&quot;, &quot;PLS3&quot;, &quot;MCAM&quot;, &quot;SPP1&quot;, &quot;LAMC1&quot;, &quot;COL4A2&quot;, &quot;COL4A1&quot;, &quot;MYOC&quot;, &quot;ANXA4&quot;, &quot;TFPI2&quot;, &quot;CST6&quot;, &quot;SLPI&quot;, &quot;TIMP2&quot;, &quot;CPM&quot;, &quot;GGT1&quot;, &quot;NNMT&quot;, &quot;MAL&quot;, &quot;EEF1A2&quot;, &quot;HGD&quot;, &quot;TCN2&quot;, &quot;CDA&quot;, &quot;PCCA&quot;, &quot;CRYM&quot;, &quot;PDXK&quot;, &quot;STC1&quot;, &quot;WARS&quot;, &quot;HMOX1&quot;, &quot;FXYD2&quot;, &quot;RBP4&quot;, &quot;SLC6A12&quot;, &quot;KDELR3&quot;, &quot;ITM2B&quot;) eg = bitr(x, fromType=&quot;SYMBOL&quot;, toType=&quot;ENTREZID&quot;, OrgDb=&quot;org.Hs.eg.db&quot;) head(eg) ## SYMBOL ENTREZID ## 1 GPX3 2878 ## 2 GLRX 2745 ## 3 LBP 3929 ## 4 CRYAB 1410 ## 5 DEFB1 1672 ## 6 HCLS1 3059 User should provides an annotation package, both fromType and toType can accept any types that supported. User can use keytypes to list all supporting types. library(org.Hs.eg.db) keytypes(org.Hs.eg.db) ## [1] &quot;ACCNUM&quot; &quot;ALIAS&quot; &quot;ENSEMBL&quot; ## [4] &quot;ENSEMBLPROT&quot; &quot;ENSEMBLTRANS&quot; &quot;ENTREZID&quot; ## [7] &quot;ENZYME&quot; &quot;EVIDENCE&quot; &quot;EVIDENCEALL&quot; ## [10] &quot;GENENAME&quot; &quot;GO&quot; &quot;GOALL&quot; ## [13] &quot;IPI&quot; &quot;MAP&quot; &quot;OMIM&quot; ## [16] &quot;ONTOLOGY&quot; &quot;ONTOLOGYALL&quot; &quot;PATH&quot; ## [19] &quot;PFAM&quot; &quot;PMID&quot; &quot;PROSITE&quot; ## [22] &quot;REFSEQ&quot; &quot;SYMBOL&quot; &quot;UCSCKG&quot; ## [25] &quot;UNIGENE&quot; &quot;UNIPROT&quot; We can translate from one type to other types. ids &lt;- bitr(x, fromType=&quot;SYMBOL&quot;, toType=c(&quot;UNIPROT&quot;, &quot;ENSEMBL&quot;), OrgDb=&quot;org.Hs.eg.db&quot;) head(ids) ## SYMBOL UNIPROT ENSEMBL ## 1 GPX3 P22352 ENSG00000211445 ## 2 GLRX A0A024RAM2 ENSG00000173221 ## 3 GLRX P35754 ENSG00000173221 ## 4 LBP P18428 ENSG00000129988 ## 5 LBP Q8TCF0 ENSG00000129988 ## 6 CRYAB P02511 ENSG00000109846 For GO analysis, user don’t need to convert ID, all ID type provided by OrgDb can be used in groupGO, enrichGO and gseGO by specifying keyType parameter. 13.1.1 bitr_kegg: converting biological IDs using KEGG API data(gcSample) hg &lt;- gcSample[[1]] head(hg) ## [1] &quot;4597&quot; &quot;7111&quot; &quot;5266&quot; &quot;2175&quot; &quot;755&quot; &quot;23046&quot; eg2np &lt;- bitr_kegg(hg, fromType=&#39;kegg&#39;, toType=&#39;ncbi-proteinid&#39;, organism=&#39;hsa&#39;) head(eg2np) ## kegg ncbi-proteinid ## 1 10001 NP_005457 ## 2 10209 NP_005792 ## 3 10232 NP_037536 ## 4 10324 NP_006054 ## 5 10411 NP_001092002 ## 6 10614 NP_006451 The ID type (both fromType &amp; toType) should be one of ‘kegg’, ‘ncbi-geneid’, ‘ncbi-proteinid’ or ‘uniprot’. The ‘kegg’ is the primary ID used in KEGG database. The data source of KEGG was from NCBI. A rule of thumb for the ‘kegg’ ID is entrezgene ID for eukaryote species and Locus ID for prokaryotes. Many prokaryote species don’t have entrezgene ID available. For example we can check the gene information of ece:Z5100 in http://www.genome.jp/dbget-bin/www_bget?ece:Z5100, which have NCBI-ProteinID and UnitProt links in the Other DBs Entry, but not NCBI-GeneID. If we try to convert Z5100 to ncbi-geneid, bitr_kegg will throw error of ncbi-geneid is not supported. bitr_kegg(&quot;Z5100&quot;, fromType=&quot;kegg&quot;, toType=&#39;ncbi-geneid&#39;, organism=&#39;ece&#39;) ## Error in KEGG_convert(fromType, toType, organism) : ## ncbi-geneid is not supported for ece ... We can of course convert it to ncbi-proteinid and uniprot: bitr_kegg(&quot;Z5100&quot;, fromType=&quot;kegg&quot;, toType=&#39;ncbi-proteinid&#39;, organism=&#39;ece&#39;) ## kegg ncbi-proteinid ## 1 Z5100 AAG58814 bitr_kegg(&quot;Z5100&quot;, fromType=&quot;kegg&quot;, toType=&#39;uniprot&#39;, organism=&#39;ece&#39;) ## kegg uniprot ## 1 Z5100 A0A384KFP7 13.2 setReadable: translating gene IDs to human readable symbols Some of the functions, especially those internally supported for DO, GO, and Reactome Pathway, support a parameter, readable. If readable = TRUE, all the gene IDs will be translated to gene symbols. The readable parameter is not available for enrichment analysis of KEGG or using user’s own annotation. KEGG analysis using enrichKEGG and gseKEGG, internally query annotation information from KEEGG database and thus support all species if it is available in the KEGG database. However, KEGG database doesn’t provide gene ID to symbol mapping information. For analysis using user’s own annotation data, we even don’t know what species is in analyzed. Translating gene IDs to gene symbols is partly supported using the setReadable function if and only if there is an OrgDb available. library(org.Hs.eg.db) library(clusterProfiler) data(geneList, package=&quot;DOSE&quot;) de &lt;- names(geneList)[1:100] x &lt;- enrichKEGG(de) ## The geneID column is ENTREZID head(x, 3) ## ID Description GeneRatio BgRatio ## hsa04110 hsa04110 Cell cycle 8/47 124/7466 ## hsa04218 hsa04218 Cellular senescence 7/47 160/7466 ## hsa04114 hsa04114 Oocyte meiosis 6/47 125/7466 ## pvalue p.adjust qvalue ## hsa04110 8.437729e-07 9.450256e-05 0.0000888182 ## hsa04218 5.568944e-05 3.118608e-03 0.0029310229 ## hsa04114 1.195585e-04 4.463517e-03 0.0041950345 ## geneID Count ## hsa04110 8318/991/9133/890/983/4085/7272/1111 8 ## hsa04218 2305/4605/9133/890/983/51806/1111 7 ## hsa04114 991/9133/983/4085/51806/6790 6 y &lt;- setReadable(x, OrgDb = org.Hs.eg.db, keyType=&quot;ENTREZID&quot;) ## The geneID column is translated to symbol head(y, 3) ## ID Description GeneRatio BgRatio ## hsa04110 hsa04110 Cell cycle 8/47 124/7466 ## hsa04218 hsa04218 Cellular senescence 7/47 160/7466 ## hsa04114 hsa04114 Oocyte meiosis 6/47 125/7466 ## pvalue p.adjust qvalue ## hsa04110 8.437729e-07 9.450256e-05 0.0000888182 ## hsa04218 5.568944e-05 3.118608e-03 0.0029310229 ## hsa04114 1.195585e-04 4.463517e-03 0.0041950345 ## geneID ## hsa04110 CDC45/CDC20/CCNB2/CCNA2/CDK1/MAD2L1/TTK/CHEK1 ## hsa04218 FOXM1/MYBL2/CCNB2/CCNA2/CDK1/CALML5/CHEK1 ## hsa04114 CDC20/CCNB2/CDK1/MAD2L1/CALML5/AURKA ## Count ## hsa04110 8 ## hsa04218 7 ## hsa04114 6 For those functions that internally support readable parameter, user can also use setReadable for translating gene IDs. "],
["references.html", "References", " References "]
]
